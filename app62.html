<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sistema de Gest√£o de Conselho Consultivo</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js" 
          integrity="sha512-qZvrmS2ekKPF2mSznTQsxqPgnpkI4DNTlrdUmTzrDgektczlKNRRhy5X5AAOnx5S09ydFYWWNSfcEqDTTHgtNA==" 
          crossorigin="anonymous" 
          referrerpolicy="no-referrer"></script>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { 
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
      background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%); 
      padding: 15px; 
      transition: background 0.5s;
      font-size: 14px;
    }
    
    .tela { display: none; } 
    .tela.active { display: block; }

    /* CONTADOR DE SETORES E CADEIRAS */
    .grupo-contador {
      text-align: center;
      font-size: 0.95em;
      color: #495057;
      background: rgba(255,255,255,0.7);
      padding: 8px 15px;
      border-radius: 8px;
      margin: 10px 0 15px 0;
      border: 2px dashed #dee2e6;
      font-weight: 600;
    }
    .grupo-contador span {
      margin: 0 12px;
    }  

    /* MENU */
    .menu-btn { 
      position: fixed; top: 15px; left: 15px; z-index: 1000; 
      background: white; border: none; padding: 10px 18px; 
      border-radius: 8px; cursor: pointer; font-size: 1.1em; 
      font-weight: bold; box-shadow: 0 3px 10px rgba(0,0,0,0.3); 
      transition: all 0.3s; 
    }
    .menu-btn:hover { transform: translateY(-2px); }
    
    .menu-dropdown { 
      position: fixed; top: 60px; left: 15px; z-index: 999; 
      background: white; border-radius: 8px; 
      box-shadow: 0 6px 20px rgba(0,0,0,0.3); 
      padding: 8px; display: none; min-width: 200px; 
    }
    .menu-dropdown.active { display: block; }
    .menu-item { 
      padding: 10px 14px; cursor: pointer; border-radius: 6px; 
      transition: all 0.2s; display: flex; align-items: center; 
      gap: 10px; font-size: 0.95em;
    }
    .menu-item:hover { background: #f0f0f0; }
    #menuCancelarEdicao { background: #ff6b6b !important; color: white !important; display: none; }
    #menuCancelarEdicao:hover { background: #fa5252 !important; }
    
    /* INDICADORES */
    .edit-indicator { 
      position: fixed; top: 15px; right: 15px; 
      background: #51cf66; color: white; 
      padding: 8px 16px; border-radius: 8px; 
      font-weight: bold; font-size: 0.9em;
      box-shadow: 0 3px 10px rgba(0,0,0,0.3); 
      display: none; z-index: 1000; 
    }
    .edit-indicator.active { display: block; animation: pulse 2s infinite; }
    
    .btn-cancelar-edicao { 
      position: fixed; top: 60px; right: 15px; 
      background: #ff6b6b; color: white; 
      padding: 10px 20px; border-radius: 8px; 
      font-weight: bold; font-size: 0.9em;
      box-shadow: 0 3px 10px rgba(0,0,0,0.3); 
      display: none; z-index: 1000; cursor: pointer; 
      border: none; transition: all 0.3s; 
    }
    .btn-cancelar-edicao:hover { transform: translateY(-2px); background: #fa5252; }
    .btn-cancelar-edicao.active { display: block; }
    
    .reuniao-indicator { 
      position: fixed; top: 60px; right: 15px; 
      background: #51cf66; color: white; 
      padding: 8px 16px; border-radius: 8px; 
      font-weight: bold; font-size: 0.9em;
      box-shadow: 0 3px 10px rgba(0,0,0,0.3); 
      display: none; z-index: 1000; 
    }
    .reuniao-indicator.active { display: block; }
    @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.7; } }
    
    /* BOT√ïES REUNI√ÉO */
    .btn-concluir-reuniao, .btn-abortar-reuniao { 
      position: fixed; bottom: 25px; 
      background: #51cf66; color: white; 
      padding: 12px 30px; border-radius: 10px; 
      font-weight: bold; font-size: 1em;
      box-shadow: 0 4px 15px rgba(0,0,0,0.4); 
      display: none; z-index: 1000; cursor: pointer; 
      border: none; transition: all 0.3s; 
    }
    .btn-concluir-reuniao { left: 50%; transform: translateX(-50%); }
    .btn-abortar-reuniao { 
      left: 50%; transform: translateX(calc(-50% - 170px)); 
      background: #ff6b6b; 
    }
    .btn-concluir-reuniao:hover, .btn-abortar-reuniao:hover { 
      transform: translateX(-50%) translateY(-3px); 
    }
    .btn-abortar-reuniao:hover { 
      transform: translateX(calc(-50% - 170px)) translateY(-3px); 
    }
    .btn-concluir-reuniao.active, .btn-abortar-reuniao.active { 
      display: block; animation: pulse 2s infinite; 
    }
    
    /* MODO EDI√á√ÉO */
    .edit-mode .editable { 
      border: 2px dashed #667eea !important; 
      cursor: text; min-height: 15px; 
      padding: 2px 4px;
    }
    .edit-mode .editable:hover { background: rgba(102, 126, 234, 0.1); }
    .edit-mode .btn-add-setor, 
    .edit-mode .btn-add-cadeira, 
    .edit-mode .btn-remove, 
    .edit-mode .btn-add-gt, 
    .edit-mode .btn-add-atividade, 
    .edit-mode .btn-edit-atividade, 
    .edit-mode .btn-edit-gt,
    .edit-mode .btn-remover-camara,
    .edit-mode .btn-editar-nome-camara,
    .edit-mode .btn-add-membro { 
      display: inline-block !important; 
    }
    
    .btn-add-setor, .btn-add-cadeira, .btn-remove, 
    .btn-add-gt, .btn-add-atividade, 
    .btn-edit-atividade, .btn-edit-gt, .btn-add-membro { 
      display: none; padding: 5px 10px; 
      background: #667eea; color: white; 
      border: none; border-radius: 5px; 
      cursor: pointer; font-size: 0.8em; 
      margin: 4px; transition: all 0.2s; 
    }
    .btn-remove { background: #ff6b6b; }
    .btn-add-gt, .btn-add-atividade, .btn-add-membro { background: #51cf66; }
    .btn-edit-atividade, .btn-edit-gt { background: #ffa726; }
    /* BOT√ïES C√ÇMARA */
.emoji-option-simples {
  font-size: 2em;
  cursor: pointer;
  text-align: center;
  padding: 10px;
  border-radius: 8px;
  transition: all 0.2s;
  border: 2px solid transparent;
  background: white;
}

.emoji-option-simples:hover {
  background: #e3f2fd;
  transform: scale(1.1);
  border-color: #667eea;
}

.emoji-option-simples.selecionado {
  background: #667eea;
  color: white;
  border-color: #5568d3;
  transform: scale(1.05);
}
    .btn-criar-camara {
      display: none;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white; border: none;
      padding: 12px 24px; border-radius: 8px;
      font-size: 1em; font-weight: bold;
      cursor: pointer; margin: 15px auto;
      box-shadow: 0 3px 12px rgba(102, 126, 234, 0.4);
      transition: all 0.3s;
    }
    .btn-criar-camara:hover { transform: translateY(-2px); }
    .edit-mode .btn-criar-camara { display: block; }
    
    .btn-remover-camara, .btn-editar-nome-camara {
      display: none;
      background: #ff6b6b; color: white;
      border: none; padding: 6px 12px;
      border-radius: 5px; font-size: 0.8em;
      font-weight: bold; cursor: pointer;
      margin-left: 8px; transition: all 0.2s;
    }
    .btn-editar-nome-camara { background: #ffa726; }
    .btn-remover-camara:hover { background: #fa5252; transform: scale(1.05); }
    .btn-editar-nome-camara:hover { background: #ff9800; transform: scale(1.05); }
    
    /* MODAIS */
    .modal { 
      display: none; position: fixed; z-index: 2000; 
      left: 0; top: 0; width: 100%; height: 100%; 
      background-color: rgba(0,0,0,0.7); 
    }
    .modal.active { 
      display: flex; align-items: center; 
      justify-content: center; 
    }
    .modal-content { 
      background: white; padding: 25px; 
      border-radius: 12px; max-width: 650px; 
      width: 90%; max-height: 85vh; overflow-y: auto; 
    }
    .modal-header { 
      font-size: 1.4em; font-weight: bold; 
      margin-bottom: 18px; color: #2c3e50; 
    }
    .modal-input, .modal-select, .modal-textarea { 
      width: 100%; padding: 10px; margin-bottom: 12px; 
      border: 2px solid #ddd; border-radius: 8px; 
      font-size: 0.95em; 
    }
    .modal-textarea { min-height: 80px; resize: vertical; }
    .modal-btn { 
      padding: 10px 20px; border: none; 
      border-radius: 8px; cursor: pointer; 
      font-size: 0.95em; font-weight: bold; 
      margin-right: 8px; transition: all 0.3s; 
    }
    .modal-btn-primary { background: #667eea; color: white; }
    .modal-btn-primary:hover { background: #5568d3; }
    .modal-btn-secondary { background: #e0e0e0; color: #333; }
    .modal-btn-secondary:hover { background: #d0d0d0; }
    .modal-label { 
      font-weight: bold; margin-bottom: 4px; 
      display: block; color: #495057; font-size: 0.9em;
    }
    
    /* PALETA DE CORES */
    .color-picker-grid { 
      display: grid; grid-template-columns: repeat(4, 1fr); 
      gap: 8px; margin: 15px 0; 
    }
    .color-option { 
      width: 55px; height: 55px; border-radius: 8px; 
      cursor: pointer; border: 3px solid transparent; 
      transition: all 0.2s; 
    }
    .color-option:hover { transform: scale(1.1); border-color: #2c3e50; }
    
    /* GALERIA DE EMOJIS */
    .emoji-grid { 
      display: grid; grid-template-columns: repeat(8, 1fr); 
      gap: 8px; margin: 15px 0; max-height: 250px; 
      overflow-y: auto; 
    }
    .emoji-option { 
      font-size: 2.2em; cursor: pointer; 
      text-align: center; padding: 6px; 
      border-radius: 8px; transition: all 0.2s; 
    }
    .emoji-option:hover { background: #f0f0f0; transform: scale(1.2); }
    
    /* HEADER COMPACTO */
    .header { text-align: center; color: white; margin: 35px 0 15px; }
    .header h1 { 
      font-size: 2em; text-shadow: 2px 2px 4px rgba(0,0,0,0.3); 
      margin-bottom: 8px; 
    }
    .header p { font-size: 1em; margin-bottom: 4px; }
    .reuniao-info { 
      font-size: 0.95em; color: #fff; 
      background: rgba(255,255,255,0.2); 
      padding: 8px 16px; border-radius: 8px; 
      display: inline-block; margin-top: 8px; 
    }
    .reuniao-info span { font-weight: bold; }
    .edit-mode .reuniao-info .editable-inline { 
      border-bottom: 2px dashed #fff; 
      cursor: text; padding: 2px 5px; 
    }
    
    .main-content { max-width: 1600px; margin: 0 auto; }
    .container { display: flex; gap: 15px; margin-bottom: 15px; }
    
    /* SISTEMA DE COLLAPSE/ACORDE√ÉO */
    .presidencia-container {
      max-width: 700px; 
      margin: 0 auto 20px;
    }
    
    .presidencia-header {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      border-radius: 12px;
      padding: 15px 20px;
      box-shadow: 0 6px 20px rgba(102, 126, 234, 0.35);
      border: 3px solid #ffffff;
      cursor: pointer;
      transition: all 0.3s;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    
    .presidencia-header:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(102, 126, 234, 0.5);
    }
    
    .presidencia-titulo {
      color: white;
      font-size: 1.3em;
      font-weight: bold;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .presidencia-seta {
      color: white;
      font-size: 1.5em;
      transition: transform 0.3s;
    }
    
    .presidencia-header.active .presidencia-seta {
      transform: rotate(180deg);
    }
    
    .presidencia-conteudo {
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.4s ease-out;
      background: white;
      border-radius: 0 0 12px 12px;
      margin-top: -10px;
      padding-top: 10px;
    }
    
    .presidencia-conteudo.active {
      max-height: 500px;
      padding: 15px;
      border: 3px solid #667eea;
      border-top: none;
    }
    
    /* Grupos colaps√°veis */
    .grupo { 
      flex: 1; background: white; 
      border-radius: 10px; padding: 18px; 
      box-shadow: 0 6px 20px rgba(0,0,0,0.2); 
      max-height: none;
    }
    
    .grupo-header {
      cursor: pointer;
      transition: all 0.3s;
      user-select: none;
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 12px;
      border-radius: 8px;
      margin-bottom: 10px;
    }
    
    .grupo-header:hover {
      background: rgba(102, 126, 234, 0.1);
    }
    
    .titulo-grupo { 
      font-size: 1.6em; font-weight: bold; 
      padding: 12px; border-radius: 8px; 
      color: white; text-shadow: 1px 1px 2px rgba(0,0,0,0.3); 
      flex: 1;
    }
    
    .grupo:first-child .titulo-grupo { 
      background: linear-gradient(135deg, #2193b0 0%, #6dd5ed 100%); 
    }
    .grupo:last-child .titulo-grupo { 
      background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); 
    }
    
    .grupo-seta {
      font-size: 1.5em;
      transition: transform 0.3s;
      color: #667eea;
      margin-right: 10px;
    }
    
    .grupo-header.active .grupo-seta {
      transform: rotate(180deg);
    }
    
    .grupo-conteudo {
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.5s ease-out;
    }
    
    .grupo-conteudo.active {
      max-height: 10000px;
    }
    
    /* Setores colaps√°veis */
    .setor { 
      margin-bottom: 25px;
      border-left: 3px solid #667eea; 
      padding-left: 12px; 
      position: relative; 
    }
    
    .setor-header-wrapper {
      display: flex;
      align-items: center;
      gap: 10px;
      cursor: pointer;
      transition: all 0.3s;
      padding: 8px;
      border-radius: 8px;
      margin-bottom: 8px;
    }
    
    .setor-header-wrapper:hover {
      background: rgba(102, 126, 234, 0.1);
    }
    
    .setor-seta {
      font-size: 1.2em;
      transition: transform 0.3s;
      color: #667eea;
      min-width: 20px;
    }
    
    .setor-header-wrapper.active .setor-seta {
      transform: rotate(180deg);
    }
    
    .titulo-setor { 
      font-size: 1em; font-weight: bold; 
      color: #2c3e50; 
      display: flex; align-items: center; 
      gap: 10px; flex-wrap: wrap; 
      flex: 1;
    }
    
    .contador-cadeiras { 
      background: #667eea; color: white; 
      padding: 3px 10px; border-radius: 15px; 
      font-size: 0.7em; 
    }
    
    .setor-conteudo {
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.5s ease-out;
    }
    
    .setor-conteudo.active {
      max-height: 5000px;
      margin-top: 10px;
    }
    
    /* Anima√ß√µes suaves */
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    
    .presidencia-conteudo.active,
    .grupo-conteudo.active,
    .setor-conteudo.active {
      animation: fadeIn 0.3s;
    }
    
    /* CADEIRAS COMPACTAS */
    .cadeira { 
      background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%); 
      border-radius: 10px; padding: 12px; 
      margin-bottom: 12px; box-shadow: 0 2px 6px rgba(0,0,0,0.1); 
      border: 2px solid #dee2e6; 
      transition: all 0.2s;
    }
    
    /* Estilos para drag & drop de cadeiras */
    .edit-mode .cadeira {
      cursor: move;
    }
    
    .cadeira.dragging {
      opacity: 0.5;
      transform: scale(0.98);
    }
    /* LAYOUT LADO A LADO - TITULAR E SUPLENTE */
    .cadeira-membros-container {
      display: flex;
      gap: 12px;
      flex-wrap: wrap;
    }

    .cadeira-membros-container .membro-linha {
      flex: 1;
      min-width: 280px;
    }

    @media (max-width: 768px) {
      .cadeira-membros-container {
        flex-direction: column;
      }
      .cadeira-membros-container .membro-linha {
        min-width: 100%;
      }
    }
    
    .cadeira.presidencia { 
      border: 3px solid #667eea; 
      background: linear-gradient(135deg, #e8eaf6 0%, #c5cae9 100%); 
    }
    .cadeira-header { 
      display: flex; align-items: center; 
      gap: 10px; margin-bottom: 12px; 
      padding-bottom: 10px; border-bottom: 2px dashed #dee2e6; 
    }
    .icone-cadeira { font-size: 2em; }
    .numero-cadeira { font-size: 1em; font-weight: bold; color: #495057; }
    
    /* MEMBROS COMPACTOS */
    .membro-linha { 
      display: flex; flex-direction: column; 
      gap: 6px; padding: 10px; margin-bottom: 6px; 
      border-radius: 8px; transition: all 0.2s; 
    }
    
    /* Cursor move apenas no modo edi√ß√£o */
    .edit-mode .cadeira .membro-linha:not(.vazio) {
      cursor: move;
    }
    
    .membro-linha.titular { border-left: 3px solid #1976d2; }
    .membro-linha.suplente { border-left: 3px solid #f57c00; }
    
    /* CORES DOS ESTADOS - TODOS OS ESTADOS DO BRASIL */
    .membro-linha[data-estado="AC"] { background: linear-gradient(135deg, #FFE0E0 0%, #FFCDD2 100%); }
    .membro-linha[data-estado="AL"] { background: linear-gradient(135deg, #FFF9C4 0%, #FFF59D 100%); }
    .membro-linha[data-estado="AP"] { background: linear-gradient(135deg, #E3F2FD 0%, #BBDEFB 100%); }
    .membro-linha[data-estado="AM"] { background: linear-gradient(135deg, #E8F5E8 0%, #C8E6C9 100%); }
    .membro-linha[data-estado="BA"] { background: linear-gradient(135deg, #F3E5F5 0%, #E1BEE7 100%); }
    .membro-linha[data-estado="CE"] { background: linear-gradient(135deg, #FFEBEE 0%, #FFCDD2 100%); }
    .membro-linha[data-estado="DF"] { background: linear-gradient(135deg, #FFF3E0 0%, #FFE0B2 100%); }
    .membro-linha[data-estado="ES"] { background: linear-gradient(135deg, #E8EAF6 0%, #C5CAE9 100%); }
    .membro-linha[data-estado="GO"] { background: linear-gradient(135deg, #FCE4EC 0%, #F8BBD0 100%); }
    .membro-linha[data-estado="MA"] { background: linear-gradient(135deg, #FFFDE7 0%, #FFF9C4 100%); }
    .membro-linha[data-estado="MT"] { background: linear-gradient(135deg, #FFF8E1 0%, #FFECB3 100%); }
    .membro-linha[data-estado="MS"] { background: linear-gradient(135deg, #E8F5E9 0%, #C8E6C9 100%); }
    .membro-linha[data-estado="MG"] { background: linear-gradient(135deg, #F1F8E9 0%, #DCEDC8 100%); }
    .membro-linha[data-estado="PA"] { background: linear-gradient(135deg, #FFFDE7 0%, #FFF9C4 100%); }
    .membro-linha[data-estado="PB"] { background: linear-gradient(135deg, #E1F5FE 0%, #B3E5FC 100%); }
    .membro-linha[data-estado="PR"] { background: linear-gradient(135deg, #F9FBE7 0%, #F0F4C3 100%); }
    .membro-linha[data-estado="PE"] { background: linear-gradient(135deg, #EDE7F6 0%, #D1C4E9 100%); }
    .membro-linha[data-estado="PI"] { background: linear-gradient(135deg, #E0F2F1 0%, #B2DFDB 100%); }
    .membro-linha[data-estado="RJ"] { background: linear-gradient(135deg, #FFEBEE 0%, #FFCDD2 100%); }
    .membro-linha[data-estado="RN"] { background: linear-gradient(135deg, #E3F2FD 0%, #BBDEFB 100%); }
    .membro-linha[data-estado="RS"] { background: linear-gradient(135deg, #F3E5F5 0%, #E1BEE7 100%); }
    .membro-linha[data-estado="RO"] { background: linear-gradient(135deg, #FFF3E0 0%, #FFE0B2 100%); }
    .membro-linha[data-estado="RR"] { background: linear-gradient(135deg, #E8F5E8 0%, #C8E6C9 100%); }
    .membro-linha[data-estado="SC"] { background: linear-gradient(135deg, #FFF9C4 0%, #FFF59D 100%); }
    .membro-linha[data-estado="SP"] { background: linear-gradient(135deg, #E3F2FD 0%, #BBDEFB 100%); }
    .membro-linha[data-estado="SE"] { background: linear-gradient(135deg, #FCE4EC 0%, #F8BBD0 100%); }
    .membro-linha[data-estado="TO"] { background: linear-gradient(135deg, #E8EAF6 0%, #C5CAE9 100%); }
    
    .membro-linha.vazio { 
      background: #f5f5f5; border-left: 3px solid #ccc; 
      opacity: 0.6; 
    }
    .membro-linha.dragging { opacity: 0.5; }
    .membro-linha-top { display: flex; align-items: center; gap: 10px; }
    
    /* AVATAR COMPACTO */
    .avatar-container { display: flex; align-items: center; gap: 6px; }
    .bonequinho, .logo-instituicao { 
      font-size: 2.5em; min-width: 42px; 
      width: 42px; height: 42px; text-align: center; 
      cursor: pointer; position: relative; 
      overflow: hidden; border-radius: 50%; 
      display: flex; align-items: center; 
      justify-content: center; border: 2px solid #dee2e6; 
      transition: all 0.2s; background: white; 
    }
    .bonequinho:hover, .logo-instituicao:hover { 
      transform: scale(1.1); border-color: #667eea; 
    }
    .bonequinho img, .logo-instituicao img { 
      width: 100%; height: 100%; 
      object-fit: cover; border-radius: 50%; 
    }
    
    .etiqueta-cargo { 
      background: #495057; color: white; 
      padding: 3px 8px; border-radius: 5px; 
      font-size: 0.7em; font-weight: bold; 
      text-transform: uppercase; min-width: 70px; 
      text-align: center; 
    }
    .etiqueta-cargo.titular { background: #1976d2; }
    .etiqueta-cargo.suplente { background: #f57c00; }
    
    .info-membro { flex: 1; }
    .nome-membro { 
      font-weight: bold; font-size: 0.95em; 
      color: #212529; margin-bottom: 3px; 
    }
    .entidade-membro { 
      font-size: 0.8em; color: #6c757d; 
      font-style: italic; margin-bottom: 2px; 
    }
    .municipio-membro { font-size: 0.75em; color: #868e96; }
    
    .btn-ver-curriculo { 
      background: #667eea; color: white; 
      border: none; padding: 3px 8px; 
      border-radius: 4px; cursor: pointer; 
      font-size: 0.7em; margin-top: 4px; 
      display: inline-block; 
    }
    .btn-ver-curriculo::after { content: 'üìÑ Ver Curr√≠culo'; }
    .edit-mode .btn-ver-curriculo::after { content: 'üìÑ Ver/Editar'; }
    
    /* PRESEN√áAS COMPACTAS */
    .presenca-container { 
      display: flex; gap: 5px; margin-top: 6px; 
      align-items: center; flex-wrap: wrap; 
    }
    .presenca-label { 
      font-size: 0.7em; color: #6c757d; 
      font-weight: bold; margin-right: 4px; 
    }
    .bolinha-presenca { 
      width: 18px; height: 18px; border-radius: 50%; 
      border: 2px solid #dee2e6; background: white; 
      cursor: pointer; transition: all 0.2s; 
      position: relative; 
    }
    .edit-mode .bolinha-presenca:hover { 
      transform: scale(1.3); border-color: #667eea; 
    }
    .bolinha-presenca.verde { background: #51cf66; border-color: #37b24d; }
    .bolinha-presenca.amarelo { background: #ffd43b; border-color: #fab005; }
    .bolinha-presenca.vermelho { background: #ff6b6b; border-color: #fa5252; }
    
    /* C√ÇMARAS COMPACTAS */
    .camaras-container { 
      background: white; border-radius: 10px; 
      padding: 20px; box-shadow: 0 6px 20px rgba(0,0,0,0.2); 
    }
    .camaras-titulo { 
      font-size: 1.6em; font-weight: bold; 
      text-align: center; margin-bottom: 18px; 
      color: #2c3e50; padding: 10px; 
      background: linear-gradient(135deg, #ffeaa7 0%, #fdcb6e 100%); 
      border-radius: 8px; 
    }
    .camaras-grid { 
      display: grid; 
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); 
      gap: 12px; 
    }
    .camara { 
      background: linear-gradient(135deg, #a29bfe 0%, #6c5ce7 100%); 
      border-radius: 10px; padding: 16px; 
      min-height: 180px; transition: all 0.3s; 
    }
    .camara.drag-over { 
      background: linear-gradient(135deg, #55efc4 0%, #00b894 100%); 
      transform: scale(1.02); 
      box-shadow: 0 0 25px rgba(0, 184, 148, 0.6); 
    }
    .camara-header { 
      display: flex; justify-content: space-between; 
      align-items: center; margin-bottom: 12px; 
      padding-bottom: 10px; 
      border-bottom: 2px solid rgba(255,255,255,0.3); 
    }
    .camara-nome { 
      font-size: 1.15em; font-weight: bold; 
      color: white; flex: 1;
    }
    .camara-contador { 
      background: rgba(255,255,255,0.9); 
      color: #6c5ce7; font-weight: bold; 
      padding: 5px 10px; border-radius: 15px; 
      font-size: 0.75em;
    }
    .camara-membros { min-height: 50px; margin-bottom: 12px; }
    .camara-membro { 
      background: rgba(255,255,255,0.95); 
      border-radius: 8px; padding: 8px 10px; 
      margin-bottom: 6px; display: flex; 
      align-items: center; gap: 8px; 
      box-shadow: 0 2px 4px rgba(0,0,0,0.1); 
    }
    .camara-membro .bonequinho { font-size: 2em; }
    .camara-membro .nome-membro { 
      flex: 1; font-size: 0.85em; 
      font-weight: bold; color: #2c3e50; 
    }
    
    /* ATIVIDADES COMPACTAS - AZUL CLARO PARA C√ÇMARAS */
    .camara-atividades { margin-bottom: 12px; }
    .atividade-card { 
      background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%); 
      border-radius: 8px; padding: 10px; 
      margin-bottom: 8px; border-left: 3px solid #2196f3; 
      box-shadow: 0 2px 5px rgba(0,0,0,0.1); 
    }
    .atividade-card[data-concluida="true"] { 
      opacity: 0.8; border-left-color: #1976d2; 
    }
    .atividade-card[data-concluida="false"] { 
      border-left-color: #ffd43b; 
    }
    .atividade-titulo { 
      font-weight: bold; color: #2c3e50; 
      margin-bottom: 4px; font-size: 0.85em; 
    }
    .atividade-info { 
      font-size: 0.75em; color: #495057; 
      margin-bottom: 4px; 
    }
    .atividade-resultado { 
      background: white; padding: 6px; 
      border-radius: 4px; font-size: 0.75em; 
      color: #2c3e50; margin-top: 6px; 
      border-left: 3px solid #667eea; 
    }
    .atividade-status { 
      margin-top: 6px; padding: 4px 8px; 
      border-radius: 5px; font-size: 0.7em; 
      font-weight: bold; display: inline-block; 
    }
    .atividade-status.concluida { background: #2ecc71; color: white; }
    .atividade-status.nao-concluida { background: #ffd43b; color: #333; }
    
    /* GTs COMPACTOS - VERDE PARA ATIVIDADES DE GT */
    .camara-gts { margin-top: 12px; }
    .gt-card { 
      background: rgba(255,255,255,0.95); 
      border-radius: 8px; padding: 10px; 
      margin-bottom: 8px; border-left: 3px solid #667eea; 
    }
    .gt-titulo { 
      font-weight: bold; color: #2c3e50; 
      margin-bottom: 4px; font-size: 0.9em;
    }
    .gt-responsavel { 
      font-size: 0.8em; color: #6c757d; 
      margin-bottom: 4px; 
    }
    .gt-objetivo { 
      font-size: 0.75em; color: #495057; 
      font-style: italic; margin-bottom: 6px; 
    }
    .gt-componentes { 
      font-size: 0.75em; color: #6c757d; 
      margin-bottom: 8px; display: none; 
    }
    .gt-componentes.show { display: block; }
    .btn-ver-componentes { 
      background: #e9ecef; color: #495057; 
      border: none; padding: 3px 8px; 
      border-radius: 4px; cursor: pointer; 
      font-size: 0.75em; margin-bottom: 6px; 
    }
    .gt-resultado { 
      font-size: 0.75em; color: #495057; 
      margin-top: 6px; padding: 6px; 
      background: #f8f9fa; border-radius: 4px; 
      border-left: 3px solid #51cf66; 
    }
    .gt-atividades-internas { 
      margin-top: 8px; padding-top: 8px; 
      border-top: 1px dashed #dee2e6; 
    }
    
    /* Atividades de GT - VERDE */
    .gt-atividades-internas .atividade-card { 
      background: linear-gradient(135deg, #d3f9d8 0%, #b2f2bb 100%); 
      border-left: 3px solid #51cf66; 
    }
    
    /* TELA DE PRESEN√áA */
    .tela-presenca {
      background: white;
      border-radius: 10px;
      padding: 20px;
      max-width: 900px;
      margin: 20px auto;
      box-shadow: 0 6px 20px rgba(0,0,0,0.2);
    }
    
    .lista-presenca {
      max-height: 70vh;
      overflow-y: auto;
      margin: 20px 0;
    }
    
    .item-lista-presenca {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 12px 15px;
      border-bottom: 1px solid #e9ecef;
      transition: background 0.2s;
    }
    
    .item-lista-presenca:hover {
      background: #f8f9fa;
    }
    
    .info-membro-presenca {
      display: flex;
      align-items: center;
      gap: 15px;
      flex: 1;
    }
    
    .bolinha-grande {
      width: 35px;
      height: 35px;
      border-radius: 50%;
      border: 3px solid #dee2e6;
      cursor: pointer;
      transition: all 0.3s;
    }
    
    .bolinha-grande:hover {
      transform: scale(1.2);
    }
    
    .bolinha-grande.verde { background: #51cf66; border-color: #37b24d; }
    .bolinha-grande.amarelo { background: #ffd43b; border-color: #fab005; }
    .bolinha-grande.vermelho { background: #ff6b6b; border-color: #fa5252; }
    
    .botoes-reuniao-fixo {
      position: fixed;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 15px;
      z-index: 1000;
    }
    
    .btn-reuniao-fixo {
      padding: 15px 30px;
      border: none;
      border-radius: 10px;
      font-weight: bold;
      font-size: 1em;
      cursor: pointer;
      transition: all 0.3s;
      box-shadow: 0 4px 15px rgba(0,0,0,0.3);
    }
    
    .btn-finalizar-reuniao {
      background: #51cf66;
      color: white;
    }
    
    .btn-abortar-reuniao-fixo {
      background: #ff6b6b;
      color: white;
    }
    
    .btn-reuniao-fixo:hover {
      transform: translateY(-3px);
    }
    
    /* CONFIRMA√á√ïES DE PRESEN√áA */
    .confirmacoes-estatisticas {
      display: flex;
      gap: 15px;
      margin: 20px 0;
      flex-wrap: wrap;
      justify-content: center;
    }
    
    .stat-card {
      background: white;
      border-radius: 10px;
      padding: 15px 20px;
      text-align: center;
      box-shadow: 0 3px 10px rgba(0,0,0,0.1);
      min-width: 120px;
      transition: all 0.3s;
    }
    
    .stat-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(0,0,0,0.2);
    }
    
    .stat-confirmado { border-left: 4px solid #51cf66; }
    .stat-justificado { border-left: 4px solid #ffd43b; }
    .stat-nao-vai { border-left: 4px solid #ff6b6b; }
    .stat-pendente { border-left: 4px solid #dee2e6; }
    
    .stat-emoji {
      font-size: 2em;
      margin-bottom: 8px;
    }
    
    .stat-valor {
      font-size: 1.8em;
      font-weight: bold;
      color: #2c3e50;
    }
    
    .stat-label {
      font-size: 0.85em;
      color: #6c757d;
      margin-top: 5px;
    }
    
    .confirmacoes-resumo {
      text-align: center;
      font-size: 1.1em;
      color: #2c3e50;
      font-weight: bold;
      margin: 15px 0;
      padding: 12px;
      background: rgba(255,255,255,0.7);
      border-radius: 8px;
    }
    
    .confirmacoes-filtros {
      display: flex;
      gap: 10px;
      margin: 20px 0;
      flex-wrap: wrap;
      justify-content: center;
    }
    
    .filtro-btn {
      padding: 10px 20px;
      border: 2px solid #dee2e6;
      background: white;
      border-radius: 8px;
      cursor: pointer;
      font-size: 0.9em;
      font-weight: bold;
      color: #495057;
      transition: all 0.3s;
    }
    
    .filtro-btn:hover {
      background: #f8f9fa;
      border-color: #adb5bd;
    }
    
    .filtro-btn.active {
      background: #667eea;
      color: white;
      border-color: #667eea;
    }
    
    .confirmacao-item {
      padding: 15px;
      border-bottom: 1px solid #e9ecef;
      background: white;
      margin-bottom: 10px;
      border-radius: 8px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.05);
    }
    
    .confirmacao-item:hover {
      background: #f8f9fa;
    }
    
    .confirmacao-header {
      display: flex;
      align-items: center;
      gap: 15px;
      margin-bottom: 10px;
    }
    
    .confirmacao-status-bolinhas {
      display: flex;
      gap: 8px;
      align-items: center;
    }
    
    .confirmacao-info {
      flex: 1;
    }
    
    .confirmacao-nome {
      font-size: 1.1em;
      font-weight: bold;
      color: #2c3e50;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .confirmacao-entidade {
      font-size: 0.9em;
      color: #6c757d;
      margin-top: 3px;
    }
    
    .confirmacao-contatos {
      display: flex;
      flex-direction: column;
      gap: 5px;
      margin-top: 8px;
      font-size: 0.85em;
      color: #495057;
    }
    
    .confirmacao-contato-item {
      display: flex;
      align-items: center;
      gap: 5px;
    }
    
    .confirmacao-observacoes {
      margin-top: 12px;
    }
    
    .confirmacao-obs-label {
      font-size: 0.85em;
      color: #495057;
      font-weight: bold;
      margin-bottom: 5px;
    }
    
    .confirmacao-obs-textarea {
      width: 100%;
      min-height: 70px;
      padding: 8px;
      border: 1px solid #dee2e6;
      border-radius: 6px;
      background: #f8f9fa;
      font-family: inherit;
      font-size: 0.85em;
      resize: vertical;
      transition: all 0.3s;
    }
    
    .confirmacao-obs-textarea:focus {
      outline: none;
      border-color: #667eea;
      background: white;
    }
    
    .confirmacao-obs-textarea::placeholder {
      color: #adb5bd;
    }
    
    /* AN√ÅLISES */
    .analises-container { 
      background: white; border-radius: 10px; 
      padding: 25px; max-width: 1400px; 
      margin: 70px auto 20px; 
      box-shadow: 0 6px 20px rgba(0,0,0,0.2); 
    }
    .analises-menu { 
      display: flex; gap: 12px; 
      margin-bottom: 25px; flex-wrap: wrap; 
    }
    .analise-btn { 
      padding: 10px 20px; background: #667eea; 
      color: white; border: none; 
      border-radius: 8px; cursor: pointer; 
      font-size: 0.95em; font-weight: bold; 
      transition: all 0.3s; 
    }
    .analise-btn:hover { background: #5568d3; }
    .analise-btn.active { background: #2c3e50; }
    .analise-content { display: none; }
    .analise-content.active { display: block; }
    
    /* COMPOSI√á√ÉO */
    .composicao-container { 
      display: flex; flex-direction: column; 
      gap: 25px; 
    }
    .composicao-grupo { 
      background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%); 
      border-radius: 10px; padding: 18px; 
      box-shadow: 0 3px 10px rgba(0,0,0,0.1); 
    }
    .composicao-grupo-titulo { 
      font-size: 1.6em; font-weight: bold; 
      color: #2c3e50; margin-bottom: 18px; 
      padding-bottom: 8px; border-bottom: 3px solid #667eea; 
    }
    .composicao-setor { margin-bottom: 25px; }
    .composicao-setor-titulo { 
      font-size: 1.2em; font-weight: bold; 
      color: #495057; margin-bottom: 12px; 
      display: flex; align-items: center; gap: 10px; 
    }
    .composicao-cadeiras-info { 
      background: #667eea; color: white; 
      padding: 4px 12px; border-radius: 15px; 
      font-size: 0.75em; 
    }
    .composicao-cadeiras-container { 
      display: flex; flex-wrap: wrap; gap: 20px; 
    }
    .composicao-cadeira-bloco { 
      display: flex; align-items: center; 
      gap: 12px; padding: 15px; 
      background: #f8f9fa; border-radius: 10px; 
      border: 2px solid #dee2e6; 
    }
    .composicao-icone-cadeira { 
      font-size: 3em; min-width: 60px; 
      text-align: center; 
    }
    .composicao-membros-cadeira { 
      display: flex; gap: 12px; 
    }
    .composicao-card { 
      background: white; 
      border-radius: 8px; 
      padding: 12px; 
      text-align: center; 
      border: 2px solid #dee2e6; 
      transition: all 0.3s; 
      box-shadow: 0 2px 6px rgba(0,0,0,0.08);
      min-width: 140px;
      max-width: 140px;
    }
    
    /* CORES DOS ESTADOS PARA COMPOSI√á√ÉO */
    .composicao-card[data-estado="AC"] { border-color: #FFCDD2; background: linear-gradient(135deg, #FFE0E0 0%, #FFCDD2 100%); }
    .composicao-card[data-estado="AL"] { border-color: #FFF59D; background: linear-gradient(135deg, #FFF9C4 0%, #FFF59D 100%); }
    .composicao-card[data-estado="AP"] { border-color: #BBDEFB; background: linear-gradient(135deg, #E3F2FD 0%, #BBDEFB 100%); }
    .composicao-card[data-estado="AM"] { border-color: #C8E6C9; background: linear-gradient(135deg, #E8F5E8 0%, #C8E6C9 100%); }
    .composicao-card[data-estado="BA"] { border-color: #E1BEE7; background: linear-gradient(135deg, #F3E5F5 0%, #E1BEE7 100%); }
    .composicao-card[data-estado="CE"] { border-color: #FFCDD2; background: linear-gradient(135deg, #FFEBEE 0%, #FFCDD2 100%); }
    .composicao-card[data-estado="DF"] { border-color: #FFE0B2; background: linear-gradient(135deg, #FFF3E0 0%, #FFE0B2 100%); }
    .composicao-card[data-estado="ES"] { border-color: #C5CAE9; background: linear-gradient(135deg, #E8EAF6 0%, #C5CAE9 100%); }
    .composicao-card[data-estado="GO"] { border-color: #F8BBD0; background: linear-gradient(135deg, #FCE4EC 0%, #F8BBD0 100%); }
    .composicao-card[data-estado="MA"] { border-color: #FFF9C4; background: linear-gradient(135deg, #FFFDE7 0%, #FFF9C4 100%); }
    .composicao-card[data-estado="MT"] { border-color: #FFECB3; background: linear-gradient(135deg, #FFF8E1 0%, #FFECB3 100%); }
    .composicao-card[data-estado="MS"] { border-color: #C8E6C9; background: linear-gradient(135deg, #E8F5E9 0%, #C8E6C9 100%); }
    .composicao-card[data-estado="MG"] { border-color: #DCEDC8; background: linear-gradient(135deg, #F1F8E9 0%, #DCEDC8 100%); }
    .composicao-card[data-estado="PA"] { border-color: #FFF9C4; background: linear-gradient(135deg, #FFFDE7 0%, #FFF9C4 100%); }
    .composicao-card[data-estado="PB"] { border-color: #B3E5FC; background: linear-gradient(135deg, #E1F5FE 0%, #B3E5FC 100%); }
    .composicao-card[data-estado="PR"] { border-color: #F0F4C3; background: linear-gradient(135deg, #F9FBE7 0%, #F0F4C3 100%); }
    .composicao-card[data-estado="PE"] { border-color: #D1C4E9; background: linear-gradient(135deg, #EDE7F6 0%, #D1C4E9 100%); }
    .composicao-card[data-estado="PI"] { border-color: #B2DFDB; background: linear-gradient(135deg, #E0F2F1 0%, #B2DFDB 100%); }
    .composicao-card[data-estado="RJ"] { border-color: #FFCDD2; background: linear-gradient(135deg, #FFEBEE 0%, #FFCDD2 100%); }
    .composicao-card[data-estado="RN"] { border-color: #BBDEFB; background: linear-gradient(135deg, #E3F2FD 0%, #BBDEFB 100%); }
    .composicao-card[data-estado="RS"] { border-color: #E1BEE7; background: linear-gradient(135deg, #F3E5F5 0%, #E1BEE7 100%); }
    .composicao-card[data-estado="RO"] { border-color: #FFE0B2; background: linear-gradient(135deg, #FFF3E0 0%, #FFE0B2 100%); }
    .composicao-card[data-estado="RR"] { border-color: #C8E6C9; background: linear-gradient(135deg, #E8F5E8 0%, #C8E6C9 100%); }
    .composicao-card[data-estado="SC"] { border-color: #FFF59D; background: linear-gradient(135deg, #FFF9C4 0%, #FFF59D 100%); }
    .composicao-card[data-estado="SP"] { border-color: #BBDEFB; background: linear-gradient(135deg, #E3F2FD 0%, #BBDEFB 100%); }
    .composicao-card[data-estado="SE"] { border-color: #F8BBD0; background: linear-gradient(135deg, #FCE4EC 0%, #F8BBD0 100%); }
    .composicao-card[data-estado="TO"] { border-color: #C5CAE9; background: linear-gradient(135deg, #E8EAF6 0%, #C5CAE9 100%); }
    
    /* Cores por Estado (UF) para itens de ranking */
    .ranking-item[data-estado="AC"] { background: linear-gradient(135deg, #FFE0E0 0%, #FFCDD2 100%) !important; }
    .ranking-item[data-estado="AL"] { background: linear-gradient(135deg, #FFF9C4 0%, #FFF59D 100%) !important; }
    .ranking-item[data-estado="AP"] { background: linear-gradient(135deg, #E3F2FD 0%, #BBDEFB 100%) !important; }
    .ranking-item[data-estado="AM"] { background: linear-gradient(135deg, #E8F5E8 0%, #C8E6C9 100%) !important; }
    .ranking-item[data-estado="BA"] { background: linear-gradient(135deg, #F3E5F5 0%, #E1BEE7 100%) !important; }
    .ranking-item[data-estado="CE"] { background: linear-gradient(135deg, #FFEBEE 0%, #FFCDD2 100%) !important; }
    .ranking-item[data-estado="DF"] { background: linear-gradient(135deg, #FFF3E0 0%, #FFE0B2 100%) !important; }
    .ranking-item[data-estado="ES"] { background: linear-gradient(135deg, #E8EAF6 0%, #C5CAE9 100%) !important; }
    .ranking-item[data-estado="GO"] { background: linear-gradient(135deg, #FCE4EC 0%, #F8BBD0 100%) !important; }
    .ranking-item[data-estado="MA"] { background: linear-gradient(135deg, #FFFDE7 0%, #FFF9C4 100%) !important; }
    .ranking-item[data-estado="MT"] { background: linear-gradient(135deg, #FFF8E1 0%, #FFECB3 100%) !important; }
    .ranking-item[data-estado="MS"] { background: linear-gradient(135deg, #E8F5E9 0%, #C8E6C9 100%) !important; }
    .ranking-item[data-estado="MG"] { background: linear-gradient(135deg, #F1F8E9 0%, #DCEDC8 100%) !important; }
    .ranking-item[data-estado="PA"] { background: linear-gradient(135deg, #FFFDE7 0%, #FFF9C4 100%) !important; }
    .ranking-item[data-estado="PB"] { background: linear-gradient(135deg, #E1F5FE 0%, #B3E5FC 100%) !important; }
    .ranking-item[data-estado="PR"] { background: linear-gradient(135deg, #F9FBE7 0%, #F0F4C3 100%) !important; }
    .ranking-item[data-estado="PE"] { background: linear-gradient(135deg, #EDE7F6 0%, #D1C4E9 100%) !important; }
    .ranking-item[data-estado="PI"] { background: linear-gradient(135deg, #E0F2F1 0%, #B2DFDB 100%) !important; }
    .ranking-item[data-estado="RJ"] { background: linear-gradient(135deg, #FFEBEE 0%, #FFCDD2 100%) !important; }
    .ranking-item[data-estado="RN"] { background: linear-gradient(135deg, #E3F2FD 0%, #BBDEFB 100%) !important; }
    .ranking-item[data-estado="RS"] { background: linear-gradient(135deg, #F3E5F5 0%, #E1BEE7 100%) !important; }
    .ranking-item[data-estado="RO"] { background: linear-gradient(135deg, #FFF3E0 0%, #FFE0B2 100%) !important; }
    .ranking-item[data-estado="RR"] { background: linear-gradient(135deg, #E8F5E8 0%, #C8E6C9 100%) !important; }
    .ranking-item[data-estado="SC"] { background: linear-gradient(135deg, #FFF9C4 0%, #FFF59D 100%) !important; }
    .ranking-item[data-estado="SP"] { background: linear-gradient(135deg, #E3F2FD 0%, #BBDEFB 100%) !important; }
    .ranking-item[data-estado="SE"] { background: linear-gradient(135deg, #FCE4EC 0%, #F8BBD0 100%) !important; }
    .ranking-item[data-estado="TO"] { background: linear-gradient(135deg, #E8EAF6 0%, #C5CAE9 100%) !important; }
    
    .composicao-card:hover { 
      transform: translateY(-3px); 
      box-shadow: 0 4px 10px rgba(0,0,0,0.15); 
    }
    .composicao-boneco { font-size: 2.5em; margin-bottom: 6px; }
    .composicao-entidade { 
      font-weight: bold; font-size: 0.75em; 
      color: #2c3e50; margin-bottom: 3px; 
      line-height: 1.3; 
    }
    .composicao-cargo { 
      font-size: 0.65em; color: white; 
      padding: 2px 6px; border-radius: 8px; 
      margin-top: 4px; display: inline-block; 
    }
    .composicao-cargo.titular { background: #1976d2; }
    .composicao-cargo.suplente { background: #f57c00; }
    
    .mensagem-vazio {
      text-align: center; padding: 18px; 
      color: #6c757d; font-style: italic; 
      background: #f8f9fa; border-radius: 8px; 
    }
    
    @media (max-width: 1200px) { 
      .container { flex-direction: column; } 
      .grupo { max-height: none; } 
    }
    
    /* ========================================== */
    /* EASTER EGG - PALAVRA SECRETA */
    /* ========================================== */
    #palavraSecreta {
      cursor: default;
      transition: all 0.2s;
    }
    
    .edit-mode #palavraSecreta {
      cursor: pointer;
    }
    
    .edit-mode #palavraSecreta:hover {
      text-decoration: underline;
      color: #ff6b6b;
    }
    
    /* ========================================== */
    /* LAYOUT MELHORADO DE DOCUMENTOS */
    /* ========================================== */
    .documentos-container {
      max-width: 1200px;
      margin: 70px auto 20px;
      background: white;
      padding: 30px;
      border-radius: 12px;
      box-shadow: 0 6px 25px rgba(0,0,0,0.25);
    }
    
    .documentos-titulo {
      font-size: 2em;
      text-align: center;
      background: linear-gradient(135deg, #ffeaa7 0%, #fdcb6e 100%);
      padding: 15px;
      border-radius: 10px;
      margin-bottom: 25px;
      font-weight: bold;
      color: #2c3e50;
    }
    
    .documentos-botoes {
      text-align: center;
      margin-bottom: 25px;
    }
    
    .documentos-botoes button {
      padding: 12px 30px;
      font-size: 1em;
      border-radius: 10px;
      margin: 10px;
      border: none;
      cursor: pointer;
      font-weight: bold;
      box-shadow: 0 3px 10px rgba(0,0,0,0.2);
      transition: all 0.3s;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
    }
    
    .documentos-botoes button:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(0,0,0,0.3);
    }
    
    .btn-criar-pasta-raiz,
    .btn-adicionar-doc-raiz {
      display: none;
    }
    
    .edit-mode .btn-criar-pasta-raiz,
    .edit-mode .btn-adicionar-doc-raiz {
      display: inline-block !important;
    }
    
    .pasta-item {
      margin-bottom: 12px;
    }
    
    .pasta-header {
      background: linear-gradient(135deg, #fff3e0, #ffe0b2);
      border: 2px solid #ffb74d;
      border-radius: 10px;
      padding: 15px 20px;
      display: flex;
      align-items: center;
      gap: 15px;
      box-shadow: 0 3px 10px rgba(0,0,0,0.1);
      cursor: pointer;
      transition: all 0.3s;
    }
    
    .pasta-header:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(0,0,0,0.15);
      background: linear-gradient(135deg, #fff8e1, #ffe8b3);
    }
    
    .pasta-seta {
      font-size: 1.5em;
      min-width: 30px;
      transition: transform 0.3s;
      color: #f57c00;
    }
    
    .pasta-header.active .pasta-seta {
      transform: rotate(90deg);
    }
    
    .pasta-nome {
      font-size: 2.5em;
      min-width: 50px;
    }
    
    .pasta-nome + span {
      font-size: 1.2em;
      font-weight: bold;
      color: #e65100;
      flex: 1;
    }
    
    .pasta-acoes {
      display: none;
      gap: 8px;
    }
    
    .edit-mode .pasta-acoes,
    .edit-mode .documento-acoes {
      display: flex !important;
    }
    
    .btn-doc-action {
      padding: 8px 12px;
      border-radius: 6px;
      font-size: 0.9em;
      border: none;
      cursor: pointer;
      font-weight: bold;
      transition: all 0.2s;
    }
    
    .btn-doc-action:hover {
      transform: scale(1.1);
    }
    
    .btn-add-item {
      background: #51cf66;
      color: white;
    }
    
    .btn-editar-doc {
      background: #ffa726;
      color: white;
    }
    
    .btn-remover-doc {
      background: #ff6b6b;
      color: white;
    }
    
    .pasta-conteudo {
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.4s ease-out;
      margin-left: 40px;
    }
    
    .pasta-conteudo.active {
      max-height: 5000px;
      margin-top: 10px;
    }
    
    .documento-item {
      background: linear-gradient(135deg, #e3f2fd, #bbdefb);
      border-left: 4px solid #2196f3;
      border-radius: 8px;
      padding: 12px 18px;
      margin: 8px 0;
      display: flex;
      align-items: center;
      gap: 12px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.08);
      cursor: pointer;
      transition: all 0.2s;
    }
    
    .documento-item:hover {
      transform: translateX(5px);
      background: linear-gradient(135deg, #e8f4fd, #c5e0f8);
      border-left-width: 5px;
    }
    
    .documento-icone {
      font-size: 2em;
      color: #1976d2;
    }
    
    .documento-nome {
      font-size: 1em;
      font-weight: 600;
      color: #0d47a1;
      flex: 1;
    }
    
    .documento-acoes {
      display: none;
      gap: 8px;
    }
    
    .mensagem-vazio-docs {
      text-align: center;
      padding: 40px;
      color: #6c757d;
      font-style: italic;
      font-size: 1.1em;
      background: #f8f9fa;
      border-radius: 8px;
    }
    
    /* Drag & Drop */
    .edit-mode .pasta-item,
    .edit-mode .documento-item {
      cursor: grab;
    }
    
    .pasta-item.dragging,
    .documento-item.dragging {
      opacity: 0.5;
      transform: scale(0.95);
      cursor: grabbing;
    }
    
    .drop-indicator {
      height: 3px;
      background: #2196f3;
      border-radius: 2px;
      margin: 5px 0;
      opacity: 0.7;
    }
    
    .pasta-header.drag-over-pasta {
      background: linear-gradient(135deg, #c8e6c9, #a5d6a7) !important;
      box-shadow: 0 0 15px rgba(76, 175, 80, 0.5);
      transform: scale(1.02);
    }
  </style>
</head>
<body>

  <!-- MENU -->
  <button class="menu-btn" onclick="toggleMenu()">‚ò∞ MENU</button>
  <div class="menu-dropdown" id="menuDropdown">
    <div class="menu-item" onclick="irParaTela('principal')"><span>üè†</span><span>Principal</span></div>
    <div class="menu-item" onclick="solicitarSenha()"><span>üîí</span><span>Editar</span></div>
    <div class="menu-item" id="menuCancelarEdicao" onclick="finalizarEdicao()"><span>üíæ</span><span>Finalizar Edi√ß√£o</span></div>
    <div class="menu-item" onclick="abrirPaletaCores()"><span>üé®</span><span>Paleta de Cores</span></div>
    <div class="menu-item" onclick="ativarModoReuniao()"><span>üìã</span><span>Modo Reuni√£o</span></div>
    <div class="menu-item" onclick="irParaTela('analises')"><span>üìä</span><span>An√°lises</span></div>
    <div class="menu-item" onclick="irParaTela('documentos')"><span>üìÅ</span><span>Documentos</span></div>
    <div class="menu-item" onclick="salvarJSON()"><span>üíæ</span><span>Salvar JSON</span></div>
    <div class="menu-item" onclick="salvarHTML()"><span>üåê</span><span>Salvar HTML</span></div>
    <div class="menu-item" onclick="document.getElementById('inputCarregarJSON').click()"><span>üìÇ</span><span>Abrir JSON</span></div>
    <div class="menu-item" onclick="carregarJSONExemplo()"><span>üì•</span><span>Carregar Dados Exemplo</span></div>
    <div class="menu-item" onclick="limparConselho()"><span>üßπ</span><span>Limpar Conselho</span></div>
  </div>
  
  <input type="file" id="inputCarregarJSON" accept=".json" style="display:none;" onchange="carregarJSON(this)">
  
  <!-- INDICADORES -->
  <div class="edit-indicator" id="editIndicator">üîì MODO EDI√á√ÉO ATIVO</div>
  <button class="btn-cancelar-edicao" id="btnCancelarEdicao" onclick="cancelarEdicaoRapido()">‚ùå CANCELAR EDI√á√ÉO</button>
  <div class="reuniao-indicator" id="reuniaoIndicator">üìã MODO REUNI√ÉO</div>

  <!-- MODAIS -->
  
  <!-- Modal Senha -->
  <div class="modal" id="modalSenha">
    <div class="modal-content">
      <div class="modal-header">üîí Autentica√ß√£o Necess√°ria</div>
      <label class="modal-label">Digite a senha de administrador:</label>
      <input type="password" class="modal-input" id="inputSenha">
      <div>
        <button class="modal-btn modal-btn-primary" onclick="verificarSenha()">Entrar</button>
        <button class="modal-btn modal-btn-secondary" onclick="fecharModal('modalSenha')">Cancelar</button>
      </div>
    </div>
  </div>
  
  <!-- Modal Finalizar Edi√ß√£o -->
  <div class="modal" id="modalFinalizarEdicao">
    <div class="modal-content">
      <div class="modal-header">üíæ Finalizar Edi√ß√£o</div>
      <p style="margin-bottom:18px;">Deseja salvar as altera√ß√µes antes de finalizar a edi√ß√£o?</p>
      <button class="modal-btn modal-btn-primary" onclick="salvarEFinalizarEdicao()">‚úÖ SALVAR E FINALIZAR</button>
      <button class="modal-btn modal-btn-secondary" onclick="finalizarSemSalvar()">‚ùå FINALIZAR SEM SALVAR</button>
      <button class="modal-btn modal-btn-secondary" onclick="fecharModal('modalFinalizarEdicao')">‚Ü©Ô∏è CONTINUAR EDITANDO</button>
    </div>
  </div>
  
  <!-- Modal Reuni√£o -->
  <div class="modal" id="modalReuniao">
    <div class="modal-content">
      <div class="modal-header">üìã Cadastrar Reuni√£o</div>
      <label class="modal-label">Data da Reuni√£o:</label>
      <div style="display: flex; gap: 10px; align-items: center;">
        <input type="date" class="modal-input" id="inputDataReuniao" style="flex: 1;">
        <button class="modal-btn modal-btn-secondary" onclick="document.getElementById('inputDataReuniao').showPicker()">üìÖ</button>
      </div>
      <label class="modal-label">Local da Reuni√£o:</label>
      <input type="text" class="modal-input" id="inputLocalReuniao" placeholder="Parna√≠ba/PI">
      <p style="margin-top:12px;color:#6c757d;font-size:0.85em;">
        üü¢ Verde = Presente | üü° Amarelo = Justificou | üî¥ Vermelho = Faltou
      </p>
      <button class="modal-btn modal-btn-primary" onclick="iniciarReuniao()">‚úÖ Iniciar Lista de Presen√ßa</button>
      <button class="modal-btn modal-btn-secondary" onclick="fecharModal('modalReuniao')">‚ùå Cancelar</button>
    </div>
  </div>
  
  <!-- Modal Editar Bolinha -->
  <div class="modal" id="modalEditarBolinha">
    <div class="modal-content">
      <div class="modal-header">‚úèÔ∏è Editar Presen√ßa</div>
      <label class="modal-label">Data da Reuni√£o:</label>
      <input type="date" class="modal-input" id="inputEditarDataReuniao">
      <label class="modal-label">Local da Reuni√£o:</label>
      <input type="text" class="modal-input" id="inputEditarLocalReuniao" placeholder="Parna√≠ba/PI">
      <label class="modal-label">Status:</label>
      <div style="display: flex; gap: 10px; margin-bottom: 15px;">
        <div class="bolinha-grande verde" onclick="selecionarStatusBolinha('verde')" id="btnStatusVerde"></div>
        <div class="bolinha-grande amarelo" onclick="selecionarStatusBolinha('amarelo')" id="btnStatusAmarelo"></div>
        <div class="bolinha-grande vermelho" onclick="selecionarStatusBolinha('vermelho')" id="btnStatusVermelho"></div>
      </div>
      <button class="modal-btn modal-btn-primary" onclick="salvarEdicaoBolinha()">üíæ SALVAR</button>
      <button class="modal-btn" style="background: #ff6b6b; color: white;" onclick="excluirBolinha()">üóëÔ∏è EXCLUIR</button>
      <button class="modal-btn modal-btn-secondary" onclick="fecharModal('modalEditarBolinha')">CANCELAR</button>
    </div>
  </div>
  
  <!-- Modal Reset Sistema -->
  <div class="modal" id="modalResetSistema">
    <div class="modal-content">
      <div class="modal-header">‚ö†Ô∏è RESETAR SISTEMA</div>
      <p style="margin-bottom: 15px; font-size: 0.95em; line-height: 1.6;">
        <strong style="color: #ff6b6b;">ATEN√á√ÉO:</strong> Esta a√ß√£o ir√° apagar <strong>PERMANENTEMENTE</strong> todos os dados do sistema:
      </p>
      <ul style="margin-bottom: 15px; padding-left: 25px; line-height: 1.8;">
        <li>Todos os conselheiros e cadeiras</li>
        <li>Todas as c√¢maras tem√°ticas</li>
        <li>Todos os documentos e pastas</li>
        <li>Todas as atividades e GTs</li>
        <li>Todo o hist√≥rico de reuni√µes</li>
      </ul>
      <p style="margin-bottom: 18px; font-weight: bold; color: #ff6b6b;">
        Esta a√ß√£o N√ÉO pode ser desfeita!
      </p>
      <p style="margin-bottom: 18px;">
        Tem certeza que deseja continuar?
      </p>
      <div>
        <button class="modal-btn modal-btn-secondary" onclick="fecharModal('modalResetSistema')">‚ùå Cancelar</button>
        <button class="modal-btn" style="background: #ff6b6b; color: white;" onclick="confirmarResetSistema()">üóëÔ∏è Sim, Resetar Tudo</button>
      </div>
    </div>
  </div>
  
  <!-- Modal Paleta de Cores -->
  <div class="modal" id="modalPaletaCores">
    <div class="modal-content">
      <div class="modal-header">üé® Escolha a Cor de Fundo</div>
      <div class="color-picker-grid">
        <div class="color-option" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);" onclick="mudarCorFundo('linear-gradient(135deg, #667eea 0%, #764ba2 100%)')"></div>
        <div class="color-option" style="background: linear-gradient(135deg, #2193b0 0%, #6dd5ed 100%);" onclick="mudarCorFundo('linear-gradient(135deg, #2193b0 0%, #6dd5ed 100%)')"></div>
        <div class="color-option" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);" onclick="mudarCorFundo('linear-gradient(135deg, #f093fb 0%, #f5576c 100%)')"></div>
        <div class="color-option" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);" onclick="mudarCorFundo('linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)')"></div>
        <div class="color-option" style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);" onclick="mudarCorFundo('linear-gradient(135deg, #43e97b 0%, #38f9d7 100%)')"></div>
        <div class="color-option" style="background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);" onclick="mudarCorFundo('linear-gradient(135deg, #fa709a 0%, #fee140 100%)')"></div>
        <div class="color-option" style="background: linear-gradient(135deg, #30cfd0 0%, #330867 100%);" onclick="mudarCorFundo('linear-gradient(135deg, #30cfd0 0%, #330867 100%)')"></div>
        <div class="color-option" style="background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);" onclick="mudarCorFundo('linear-gradient(135deg, #a8edea 0%, #fed6e3 100%)')"></div>
      </div>
      <button class="modal-btn modal-btn-primary" onclick="fecharModal('modalPaletaCores')">‚úÖ OK</button>
    </div>
  </div>
  
  <!-- Modal Escolher Emoji -->
  <div class="modal" id="modalEscolherEmoji">
    <div class="modal-content">
      <div class="modal-header">üé≠ Escolher <span id="tipoEmojiTitulo">Pessoa</span></div>
      
      <!-- Se√ß√£o de Emojis para C√¢maras -->
      <div style="margin: 15px 0; padding: 10px; background: #f8f9fa; border-radius: 8px;">
        <div style="font-weight: bold; color: #495057; margin-bottom: 8px; text-align: center;">üèõÔ∏è Emojis para C√¢maras</div>
        <div class="emoji-grid">
          <div class="emoji-option" onclick="selecionarEmoji('üèõÔ∏è')">üèõÔ∏è</div>
          <div class="emoji-option" onclick="selecionarEmoji('üåø')">üåø</div>
          <div class="emoji-option" onclick="selecionarEmoji('üåä')">üåä</div>
          <div class="emoji-option" onclick="selecionarEmoji('üê†')">üê†</div>
          <div class="emoji-option" onclick="selecionarEmoji('üåé')">üåé</div>
          <div class="emoji-option" onclick="selecionarEmoji('üìö')">üìö</div>
          <div class="emoji-option" onclick="selecionarEmoji('üî¨')">üî¨</div>
          <div class="emoji-option" onclick="selecionarEmoji('üíº')">üíº</div>
          <div class="emoji-option" onclick="selecionarEmoji('‚öñÔ∏è')">‚öñÔ∏è</div>
          <div class="emoji-option" onclick="selecionarEmoji('üè≠')">üè≠</div>
          <div class="emoji-option" onclick="selecionarEmoji('üåæ')">üåæ</div>
          <div class="emoji-option" onclick="selecionarEmoji('üé£')">üé£</div>
          <div class="emoji-option" onclick="selecionarEmoji('üö§')">üö§</div>
          <div class="emoji-option" onclick="selecionarEmoji('üèñÔ∏è')">üèñÔ∏è</div>
          <div class="emoji-option" onclick="selecionarEmoji('üó∫Ô∏è')">üó∫Ô∏è</div>
          <div class="emoji-option" onclick="selecionarEmoji('üìä')">üìä</div>
          <div class="emoji-option" onclick="selecionarEmoji('üîç')">üîç</div>
          <div class="emoji-option" onclick="selecionarEmoji('üí°')">üí°</div>
          <div class="emoji-option" onclick="selecionarEmoji('ü§ù')">ü§ù</div>
          <div class="emoji-option" onclick="selecionarEmoji('üåü')">üåü</div>
<div class="emoji-option" onclick="selecionarEmoji('üê∂')">üê∂</div>
<div class="emoji-option" onclick="selecionarEmoji('üê∫')">üê∫</div>
<div class="emoji-option" onclick="selecionarEmoji('ü¶ù')">ü¶ù</div>
<div class="emoji-option" onclick="selecionarEmoji('üê±')">üê±</div>
<div class="emoji-option" onclick="selecionarEmoji('üêà')">üêà</div>
<div class="emoji-option" onclick="selecionarEmoji('ü¶Å')">ü¶Å</div>
<div class="emoji-option" onclick="selecionarEmoji('üêØ')">üêØ</div>
<div class="emoji-option" onclick="selecionarEmoji('üêÖ')">üêÖ</div>
<div class="emoji-option" onclick="selecionarEmoji('üêÜ')">üêÜ</div>
<div class="emoji-option" onclick="selecionarEmoji('üê¥')">üê¥</div>
<div class="emoji-option" onclick="selecionarEmoji('üêé')">üêé</div>
<div class="emoji-option" onclick="selecionarEmoji('ü¶ì')">ü¶ì</div>
<div class="emoji-option" onclick="selecionarEmoji('ü¶å')">ü¶å</div>
<div class="emoji-option" onclick="selecionarEmoji('ü¶¨')">ü¶¨</div>
<div class="emoji-option" onclick="selecionarEmoji('üêÆ')">üêÆ</div>
<div class="emoji-option" onclick="selecionarEmoji('üêÇ')">üêÇ</div>
<div class="emoji-option" onclick="selecionarEmoji('üêÉ')">üêÉ</div>
<div class="emoji-option" onclick="selecionarEmoji('üêÑ')">üêÑ</div>
<div class="emoji-option" onclick="selecionarEmoji('üê∑')">üê∑</div>
<div class="emoji-option" onclick="selecionarEmoji('üêñ')">üêñ</div>
<div class="emoji-option" onclick="selecionarEmoji('üêó')">üêó</div>
<div class="emoji-option" onclick="selecionarEmoji('üêΩ')">üêΩ</div>
<div class="emoji-option" onclick="selecionarEmoji('üêè')">üêè</div>
<div class="emoji-option" onclick="selecionarEmoji('ü¶ô')">ü¶ô</div>
<div class="emoji-option" onclick="selecionarEmoji('ü¶í')">ü¶í</div>
<div class="emoji-option" onclick="selecionarEmoji('üêò')">üêò</div>
<div class="emoji-option" onclick="selecionarEmoji('ü¶£')">ü¶£</div>
<div class="emoji-option" onclick="selecionarEmoji('ü¶è')">ü¶è</div>
<div class="emoji-option" onclick="selecionarEmoji('ü¶õ')">ü¶õ</div>
<div class="emoji-option" onclick="selecionarEmoji('üê≠')">üê≠</div>
<div class="emoji-option" onclick="selecionarEmoji('üêÅ')">üêÅ</div>
<div class="emoji-option" onclick="selecionarEmoji('üêÄ')">üêÄ</div>
<div class="emoji-option" onclick="selecionarEmoji('ü¶î')">ü¶î</div>
<div class="emoji-option" onclick="selecionarEmoji('ü¶á')">ü¶á</div>
<div class="emoji-option" onclick="selecionarEmoji('üêª')">üêª</div>
<div class="emoji-option" onclick="selecionarEmoji('üêª‚Äç‚ùÑÔ∏è')">üêª‚Äç‚ùÑÔ∏è</div>
<div class="emoji-option" onclick="selecionarEmoji('üê®')">üê®</div>
<div class="emoji-option" onclick="selecionarEmoji('ü¶®')">ü¶®</div>
<div class="emoji-option" onclick="selecionarEmoji('ü¶°')">ü¶°</div>
<div class="emoji-option" onclick="selecionarEmoji('ü¶É')">ü¶É</div>
<div class="emoji-option" onclick="selecionarEmoji('üêî')">üêî</div>
<div class="emoji-option" onclick="selecionarEmoji('üêì')">üêì</div>
<div class="emoji-option" onclick="selecionarEmoji('üê£')">üê£</div>
<div class="emoji-option" onclick="selecionarEmoji('ü¶Ö')">ü¶Ö</div>
<div class="emoji-option" onclick="selecionarEmoji('ü¶Ü')">ü¶Ü</div>
<div class="emoji-option" onclick="selecionarEmoji('ü¶¢')">ü¶¢</div>
<div class="emoji-option" onclick="selecionarEmoji('ü¶â')">ü¶â</div>
<div class="emoji-option" onclick="selecionarEmoji('ü¶§')">ü¶§</div>
<div class="emoji-option" onclick="selecionarEmoji('ü™∂')">ü™∂</div>
<div class="emoji-option" onclick="selecionarEmoji('ü¶©')">ü¶©</div>
<div class="emoji-option" onclick="selecionarEmoji('ü¶ö')">ü¶ö</div>
<div class="emoji-option" onclick="selecionarEmoji('ü¶ú')">ü¶ú</div>
<div class="emoji-option" onclick="selecionarEmoji('üê¶‚Äç‚¨õ')">üê¶‚Äç‚¨õ</div>
<div class="emoji-option" onclick="selecionarEmoji('üê∏')">üê∏</div>
<div class="emoji-option" onclick="selecionarEmoji('üêä')">üêä</div>
<div class="emoji-option" onclick="selecionarEmoji('üê¢')">üê¢</div>
<div class="emoji-option" onclick="selecionarEmoji('üêç')">üêç</div>
        </div>
      </div>

      <!-- Emojis de Pessoas (existente) -->
      <div class="emoji-grid">
        <div class="emoji-option" onclick="selecionarEmoji('üë®üèª')">üë®üèª</div>
        <div class="emoji-option" onclick="selecionarEmoji('üë®üèº')">üë®üèº</div>
        <div class="emoji-option" onclick="selecionarEmoji('üë®üèΩ')">üë®üèΩ</div>
        <div class="emoji-option" onclick="selecionarEmoji('üë®üèæ')">üë®üèæ</div>
        <div class="emoji-option" onclick="selecionarEmoji('üë®üèø')">üë®üèø</div>
        <div class="emoji-option" onclick="selecionarEmoji('üë©')">üë©</div>
        <div class="emoji-option" onclick="selecionarEmoji('üë©üèª')">üë©üèª</div>
        <div class="emoji-option" onclick="selecionarEmoji('üë©üèΩ')">üë©üèΩ</div>
        <div class="emoji-option" onclick="selecionarEmoji('üë©üèæ')">üë©üèæ</div>
        <div class="emoji-option" onclick="selecionarEmoji('üë©üèø')">üë©üèø</div>
        <div class="emoji-option" onclick="selecionarEmoji('üë®‚Äçü¶∞')">üë®‚Äçü¶∞</div>
        <div class="emoji-option" onclick="selecionarEmoji('üë®üèª‚Äçü¶∞')">üë®üèª‚Äçü¶∞</div>
        <div class="emoji-option" onclick="selecionarEmoji('üë®üèΩ‚Äçü¶∞')">üë®üèΩ‚Äçü¶∞</div>
        <div class="emoji-option" onclick="selecionarEmoji('üë©‚Äçü¶∞')">üë©‚Äçü¶∞</div>
        <div class="emoji-option" onclick="selecionarEmoji('üë©üèª‚Äçü¶∞')">üë©üèª‚Äçü¶∞</div>
        <div class="emoji-option" onclick="selecionarEmoji('üë©üèæ‚Äçü¶∞')">üë©üèæ‚Äçü¶∞</div>
        <div class="emoji-option" onclick="selecionarEmoji('üë®‚Äçü¶±')">üë®‚Äçü¶±</div>
        <div class="emoji-option" onclick="selecionarEmoji('üë®üèº‚Äçü¶±')">üë®üèº‚Äçü¶±</div>
        <div class="emoji-option" onclick="selecionarEmoji('üë®üèø‚Äçü¶±')">üë®üèø‚Äçü¶±</div>
        <div class="emoji-option" onclick="selecionarEmoji('üë©‚Äçü¶±')">üë©‚Äçü¶±</div>
        <div class="emoji-option" onclick="selecionarEmoji('üë©üèº‚Äçü¶±')">üë©üèº‚Äçü¶±</div>
        <div class="emoji-option" onclick="selecionarEmoji('üë©üèΩ‚Äçü¶±')">üë©üèΩ‚Äçü¶±</div>
        <div class="emoji-option" onclick="selecionarEmoji('üë®‚Äçü¶≥')">üë®‚Äçü¶≥</div>
        <div class="emoji-option" onclick="selecionarEmoji('üë®üèº‚Äçü¶≥')">üë®üèº‚Äçü¶≥</div>
        <div class="emoji-option" onclick="selecionarEmoji('üë®üèæ‚Äçü¶≥')">üë®üèæ‚Äçü¶≥</div>
        <div class="emoji-option" onclick="selecionarEmoji('üë©‚Äçü¶≥')">üë©‚Äçü¶≥</div>
        <div class="emoji-option" onclick="selecionarEmoji('üë©üèª‚Äçü¶≥')">üë©üèª‚Äçü¶≥</div>
        <div class="emoji-option" onclick="selecionarEmoji('üë©üèø‚Äçü¶≥')">üë©üèø‚Äçü¶≥</div>
        <div class="emoji-option" onclick="selecionarEmoji('üë®‚Äçü¶≤')">üë®‚Äçü¶≤</div>
        <div class="emoji-option" onclick="selecionarEmoji('üë®üèΩ‚Äçü¶≤')">üë®üèΩ‚Äçü¶≤</div>
        <div class="emoji-option" onclick="selecionarEmoji('üë©‚Äçü¶≤')">üë©‚Äçü¶≤</div>
        <div class="emoji-option" onclick="selecionarEmoji('üë©üèæ‚Äçü¶≤')">üë©üèæ‚Äçü¶≤</div>
        <div class="emoji-option" onclick="selecionarEmoji('üßë')">üßë</div>
        <div class="emoji-option" onclick="selecionarEmoji('üßëüèª')">üßëüèª</div>
        <div class="emoji-option" onclick="selecionarEmoji('üßëüèΩ')">üßëüèΩ</div>
        <div class="emoji-option" onclick="selecionarEmoji('üßëüèø')">üßëüèø</div>
        <div class="emoji-option" onclick="selecionarEmoji('üè¢')">üè¢</div>
        <div class="emoji-option" onclick="selecionarEmoji('üè´')">üè´</div>
        <div class="emoji-option" onclick="selecionarEmoji('üå≥')">üå≥</div>
        <div class="emoji-option" onclick="selecionarEmoji('üêü')">üêü</div>
        <div class="emoji-option" onclick="selecionarEmoji('‚ùì')">‚ùì</div>
      </div>
      
      <hr style="margin: 15px 0;">
      <label class="modal-label">üì∑ Ou envie uma foto/logo:</label>
      <input type="file" id="inputFotoEmoji" accept="image/*" style="margin-bottom: 12px;">
      <button class="modal-btn modal-btn-primary" onclick="uploadFotoEmoji()">üì∑ Usar Foto</button>
      <button class="modal-btn modal-btn-secondary" onclick="fecharModal('modalEscolherEmoji')">Cancelar</button>
    </div>
  </div>
  
  <!-- Modal Ver/Editar Curr√≠culo -->
  <div class="modal" id="modalVerEditarCurriculo">
    <div class="modal-content">
      <div class="modal-header" id="tituloModalCurriculo">üìÑ Curr√≠culo</div>
      <textarea class="modal-textarea" id="curriculoConteudo" style="min-height:130px;" readonly></textarea>
      <button class="modal-btn modal-btn-primary" id="btnSalvarCurriculo" onclick="salvarCurriculo()" style="display: none;">üíæ Salvar</button>
      <button class="modal-btn modal-btn-secondary" onclick="fecharModal('modalVerEditarCurriculo')">Fechar</button>
    </div>
  </div>
  
  <!-- Modal Adicionar Membro -->
  <div class="modal" id="modalAdicionarMembro">
    <div class="modal-content">
      <div class="modal-header">üë§ Adicionar Membro</div>
      <label class="modal-label">Nome Completo:</label>
      <input type="text" class="modal-input" id="inputNomeMembro" placeholder="Ex: Jo√£o da Silva">
      <label class="modal-label">Entidade/Institui√ß√£o:</label>
      <input type="text" class="modal-input" id="inputEntidadeMembro" placeholder="Ex: Secretaria de Meio Ambiente">
      <label class="modal-label">Munic√≠pio/UF:</label>
      <input type="text" class="modal-input" id="inputMunicipioMembro" placeholder="Ex: Parna√≠ba/PI">
      <label class="modal-label">Estado:</label>
      <select class="modal-select" id="inputEstadoMembro">
        <option value="">Selecione...</option>
        <option value="AC">Acre (AC)</option>
        <option value="AL">Alagoas (AL)</option>
        <option value="AP">Amap√° (AP)</option>
        <option value="AM">Amazonas (AM)</option>
        <option value="BA">Bahia (BA)</option>
        <option value="CE">Cear√° (CE)</option>
        <option value="DF">Distrito Federal (DF)</option>
        <option value="ES">Esp√≠rito Santo (ES)</option>
        <option value="GO">Goi√°s (GO)</option>
        <option value="MA">Maranh√£o (MA)</option>
        <option value="MT">Mato Grosso (MT)</option>
        <option value="MS">Mato Grosso do Sul (MS)</option>
        <option value="MG">Minas Gerais (MG)</option>
        <option value="PA">Par√° (PA)</option>
        <option value="PB">Para√≠ba (PB)</option>
        <option value="PR">Paran√° (PR)</option>
        <option value="PE">Pernambuco (PE)</option>
        <option value="PI">Piau√≠ (PI)</option>
        <option value="RJ">Rio de Janeiro (RJ)</option>
        <option value="RN">Rio Grande do Norte (RN)</option>
        <option value="RS">Rio Grande do Sul (RS)</option>
        <option value="RO">Rond√¥nia (RO)</option>
        <option value="RR">Roraima (RR)</option>
        <option value="SC">Santa Catarina (SC)</option>
        <option value="SP">S√£o Paulo (SP)</option>
        <option value="SE">Sergipe (SE)</option>
        <option value="TO">Tocantins (TO)</option>
      </select>
      <label class="modal-label">Telefone:</label>
      <input type="text" class="modal-input" id="inputTelefoneMembro" placeholder="00 - 00000-0000">
      <label class="modal-label">E-mail:</label>
      <input type="email" class="modal-input" id="inputEmailMembro" placeholder="exemplo@email.com">
      <label class="modal-label">Mini Curr√≠culo:</label>
      <textarea class="modal-textarea" id="inputCurriculoMembro" placeholder="Forma√ß√£o, experi√™ncias, atua√ß√£o..."></textarea>
      <label class="modal-label">üìÖ Data da Posse:</label>
      <input type="date" class="modal-input" id="inputDataPosseMembro">
      <label class="modal-label">‚è≥ Data do T√©rmino do Mandato:</label>
      <input type="date" class="modal-input" id="inputDataMandatoMembro">
      <label class="modal-label">Tipo:</label>
      <select class="modal-select" id="inputTipoMembro">
        <option value="titular">Titular</option>
        <option value="suplente">Suplente</option>
      </select>
      <button class="modal-btn modal-btn-primary" onclick="confirmarAdicionarMembro()">‚úÖ Adicionar</button>
      <button class="modal-btn modal-btn-secondary" onclick="fecharModal('modalAdicionarMembro')">Cancelar</button>
    </div>
  </div>
  
  <!-- Modal Adicionar Atividade -->
  <div class="modal" id="modalAdicionarAtividade">
    <div class="modal-content">
      <div class="modal-header" id="headerAtividade">‚úèÔ∏è Adicionar Atividade</div>
      <label class="modal-label">Objetivo:</label>
      <textarea class="modal-textarea" id="inputObjetivoAtiv"></textarea>
      <label class="modal-label">Respons√°vel:</label>
      <input type="text" class="modal-input" id="inputResponsavelAtiv">
      <label class="modal-label">Prazo:</label>
      <input type="date" class="modal-input" id="inputPrazoAtiv">
      <label class="modal-label">Resultado:</label>
      <textarea class="modal-textarea" id="inputResultadoAtiv"></textarea>
      <button class="modal-btn modal-btn-primary" onclick="confirmarAdicionarAtividade()">‚úÖ Salvar</button>
      <button class="modal-btn modal-btn-secondary" onclick="fecharModal('modalAdicionarAtividade')">Cancelar</button>
    </div>
  </div>
  
  <!-- Modal Status Atividade -->
  <div class="modal" id="modalStatusAtividade">
    <div class="modal-content">
      <div class="modal-header">üìã Status da Atividade</div>
      <p style="margin-bottom:18px;font-size:1em;">Voc√™ preencheu o campo "Resultado". Qual o status desta atividade?</p>
      <button class="modal-btn modal-btn-primary" onclick="marcarStatusAtividade(true)" style="background:#2ecc71;">‚úÖ Tarefa Conclu√≠da</button>
      <button class="modal-btn modal-btn-secondary" onclick="marcarStatusAtividade(false)" style="background:#ffd43b;color:#333;">‚ùå Tarefa N√£o Conclu√≠da</button>
    </div>
  </div>
  
  <!-- Modal Criar GT -->
  <div class="modal" id="modalCriarGT">
    <div class="modal-content">
      <div class="modal-header">üìã Criar/Editar Grupo de Trabalho</div>
      <label class="modal-label">T√≠tulo:</label>
      <input type="text" class="modal-input" id="inputTituloGT">
      <label class="modal-label">Objetivo:</label>
      <textarea class="modal-textarea" id="inputObjetivoGT"></textarea>
      <label class="modal-label">Respons√°vel:</label>
      <input type="text" class="modal-input" id="inputResponsavelGT">
      
      <div style="margin: 15px 0; padding: 15px; background: #f8f9fa; border-radius: 8px; border: 2px dashed #dee2e6;">
        <label class="modal-label" style="display: flex; align-items: center; gap: 8px;">
          üë• Componentes do GT
        </label>
        <div id="componentesGTContainer"></div>
        <button type="button" class="modal-btn" style="background: #51cf66; color: white; margin-top: 10px;" onclick="adicionarComponenteGT()">‚ûï Adicionar Componente</button>
      </div>
      
      <label class="modal-label">Resultado:</label>
      <textarea class="modal-textarea" id="inputResultadoGT"></textarea>
      <button class="modal-btn modal-btn-primary" onclick="confirmarCriarGT()">‚úÖ Salvar GT</button>
      <button class="modal-btn modal-btn-secondary" onclick="fecharModalGT()">Cancelar</button>
    </div>
  </div>

  <!-- Modal Criar C√¢mara Tem√°tica -->
  <!-- Modal Criar C√¢mara Tem√°tica - VERS√ÉO SIMPLIFICADA -->
<div class="modal" id="modalCriarCamara">
  <div class="modal-content">
    <div class="modal-header">üèõÔ∏è Criar C√¢mara Tem√°tica</div>
    
    <label class="modal-label">Nome da C√¢mara:</label>
    <input type="text" class="modal-input" id="inputNomeCamara" placeholder="Ex: Educa√ß√£o Ambiental">
    
    <label class="modal-label">Escolha um Emoji:</label>
    <div class="emoji-grid-simples" style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 10px; margin: 15px 0;">
      <div class="emoji-option-simples" onclick="selecionarEmojiCamara('üî¨')" title="Pesquisa">üî¨</div>
      <div class="emoji-option-simples" onclick="selecionarEmojiCamara('üõ°Ô∏è')" title="Prote√ß√£o">üõ°Ô∏è</div>
      <div class="emoji-option-simples" onclick="selecionarEmojiCamara('üë•')" title="Uso P√∫blico">üë•</div>
      <div class="emoji-option-simples" onclick="selecionarEmojiCamara('üåø')" title="Gest√£o Socioambiental">üåø</div>
      <div class="emoji-option-simples" onclick="selecionarEmojiCamara('‚ö†Ô∏è')" title="Impactos Ambientais">‚ö†Ô∏è</div>
      <div class="emoji-option-simples" onclick="selecionarEmojiCamara('üè†')" title="Comunidades">üè†</div>
      <div class="emoji-option-simples" onclick="selecionarEmojiCamara('üé£')" title="Pesca">üé£</div>
      <div class="emoji-option-simples" onclick="selecionarEmojiCamara('üíß')" title="Recursos H√≠dricos">üíß</div>
      <div class="emoji-option-simples" onclick="selecionarEmojiCamara('üê†')" title="Biodiversidade">üê†</div>
      <div class="emoji-option-simples" onclick="selecionarEmojiCamara('üìä')" title="Monitoramento">üìä</div>
    </div>
    
    <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 15px; padding: 10px; background: #f8f9fa; border-radius: 8px;">
      <span>Emoji selecionado:</span>
      <span id="emojiSelecionadoPreview" style="font-size: 1.5em;">üî¨</span>
      <input type="hidden" id="inputEmojiCamara" value="üî¨">
    </div>
    
    <p style="margin-top:8px;color:#6c757d;font-size:0.8em;">
      üí° O identificador (slug) ser√° gerado automaticamente a partir do nome
    </p>
    
    <div style="display: flex; gap: 10px; margin-top: 20px;">
      <button class="modal-btn modal-btn-primary" onclick="confirmarCriarCamara()" style="flex: 1;">‚úÖ Criar C√¢mara</button>
      <button class="modal-btn modal-btn-secondary" onclick="fecharModal('modalCriarCamara')" style="flex: 1;">‚ùå Cancelar</button>
    </div>
  </div>
</div>

  <!-- Modal Editar Nome C√¢mara -->
  <div class="modal" id="modalEditarNomeCamara">
    <div class="modal-content">
      <div class="modal-header">‚úèÔ∏è Editar Nome da C√¢mara</div>
      <label class="modal-label">Novo Nome:</label>
      <input type="text" class="modal-input" id="inputNovoNomeCamara" placeholder="Ex: üî¨ Pesquisa e Monitoramento">
      <p style="margin-top:8px;color:#6c757d;font-size:0.8em;">üí° Voc√™ pode incluir emoji no nome</p>
      <button class="modal-btn modal-btn-primary" onclick="confirmarEditarNomeCamara()">‚úÖ Salvar</button>
      <button class="modal-btn modal-btn-secondary" onclick="fecharModal('modalEditarNomeCamara')">Cancelar</button>
    </div>
  </div>

  
  <!-- Modal Criar/Editar Pasta -->
  <div class="modal" id="modalCriarPasta">
    <div class="modal-content">
      <div class="modal-header" id="tituloCriarPasta">üìÇ Nova Pasta</div>
      <input type="text" class="modal-input" id="inputNomePasta" placeholder="Nome da pasta">
      <button class="modal-btn modal-btn-primary" onclick="confirmarCriarPasta()">‚úÖ Salvar</button>
      <button class="modal-btn modal-btn-secondary" onclick="fecharModal('modalCriarPasta')">Cancelar</button>
    </div>
  </div>

  <!-- Modal Adicionar Documento -->
  <div class="modal" id="modalAdicionarDocumento">
    <div class="modal-content">
      <div class="modal-header" id="tituloAdicionarDoc">üìÑ Novo Documento</div>
      <input type="text" class="modal-input" id="inputNomeDocumento" placeholder="Nome do documento">
      <input type="text" class="modal-input" id="inputLinkDocumento" placeholder="https://exemplo.com/documento.pdf">
      <p style="margin-top:8px;color:#6c757d;font-size:0.8em;">üí° Cole a URL completa do documento</p>
      <button class="modal-btn modal-btn-primary" onclick="confirmarAdicionarDocumento()">‚úÖ Salvar</button>
      <button class="modal-btn modal-btn-secondary" onclick="fecharModal('modalAdicionarDocumento')">Cancelar</button>
    </div>
  </div>

  <!-- Modal Escolher Tipo de Item -->
  <div class="modal" id="modalEscolherTipoItem">
    <div class="modal-content">
      <div class="modal-header">‚ûï Adicionar Item</div>
      <p style="margin-bottom:18px;">Escolha o que deseja adicionar:</p>
      <button class="modal-btn modal-btn-primary" onclick="escolherTipoItem('pasta')" style="width:100%;margin-bottom:10px;">   Nova Subpasta</button>
      <button class="modal-btn modal-btn-primary" onclick="escolherTipoItem('documento')" style="width:100%;margin-bottom:10px;">üìÑ Novo Documento</button>
      <button class="modal-btn modal-btn-secondary" onclick="fecharModal('modalEscolherTipoItem')">Cancelar</button>
    </div>
  </div>


  <!-- TELA PRINCIPAL -->
  <div class="tela active" id="telaPrincipal"> 
    <div class="main-content">
      <div class="header">
        <h1 class="editable" contenteditable="false">Sistema de Gest√£o de Conselho Consultivo</h1>
        <p>Gest√£o <span id="palavraSecreta">Completa</span> de Membros e Atividades</p>
        <div class="reuniao-info">
          <span>Pr√≥xima Reuni√£o:</span> 
          <span class="editable-inline" id="dataProximaReuniao" contenteditable="false">--/--/----</span> | 
          <span>Local:</span> 
          <span class="editable-inline" id="localProximaReuniao" contenteditable="false">---</span>
        </div>
      </div>
      
      <!-- PRESID√äNCIA -->
      <div class="presidencia-container">
        <div class="presidencia-header" onclick="togglePresidencia()">
          <div class="presidencia-titulo">
            <span>üèõÔ∏è</span>
            <span>PRESID√äNCIA DO CONSELHO</span>
          </div>
          <div class="presidencia-seta">‚ñº</div>
        </div>
        
        <div class="presidencia-conteudo">
          <div class="cadeira presidencia" style="background: white; border-radius: 8px;">
            <div class="cadeira-header">
              <span class="icone-cadeira">ü™ë</span>
              <span class="numero-cadeira">Presidente</span>
            </div>
            <div class="cadeira-membros-container" id="presidenciaContainer">
              <!-- Presidente ser√° adicionado via JSON -->
            </div>
            <button class="btn-add-membro" onclick="abrirModalAdicionarMembroPresidencia()">‚ûï Adicionar Presidente</button>
          </div>
        </div>
      </div>

      <div class="container">
        
        <!-- PODER P√öBLICO -->
        <div class="grupo" id="poder-publico">
          <div class="grupo-header" onclick="toggleGrupo(this)">
            <div class="titulo-grupo">‚öñÔ∏è PODER P√öBLICO</div>
            <div class="grupo-seta">‚ñº</div>
          </div>
          
          <div class="grupo-conteudo">
            <div class="grupo-contador">
              <span>üìÇ Setores: <strong class="contador-setores">0</strong></span>
              <span>ü™ë Cadeiras: <strong class="contador-cadeiras-total">0</strong></span>
            </div>
            <button class="btn-add-setor" onclick="adicionarSetor('poder-publico')">‚ûï Setor</button>
          </div>
        </div>

        <!-- SOCIEDADE CIVIL -->
        <div class="grupo" id="sociedade-civil">
          <div class="grupo-header" onclick="toggleGrupo(this)">
            <div class="titulo-grupo">ü§ù SOCIEDADE CIVIL</div>
            <div class="grupo-seta">‚ñº</div>
          </div>
          
          <div class="grupo-conteudo">
            <div class="grupo-contador">
              <span>üìÇ Setores: <strong class="contador-setores">0</strong></span>
              <span>ü™ë Cadeiras: <strong class="contador-cadeiras-total">0</strong></span>
            </div>
            <button class="btn-add-setor" onclick="adicionarSetor('sociedade-civil')">‚ûï Setor</button>
          </div>
        </div>
        
      </div>
      
      <!-- C√ÇMARAS TEM√ÅTICAS -->
      <div class="camaras-container">
        <div class="camaras-titulo">üèõÔ∏è C√ÇMARAS TEM√ÅTICAS</div>
        <button class="btn-criar-camara" onclick="abrirModalCriarCamara()">‚ûï Criar Nova C√¢mara Tem√°tica</button>
        <div class="camaras-grid" id="camarasGrid">
          <!-- C√¢maras ser√£o adicionadas via JSON ou manualmente -->
        </div>
      </div>
    </div>
  </div>

  <!-- TELA PRESEN√áA -->
  <div class="tela" id="telaPresenca">
    <div class="tela-presenca">
      <div class="header">
        <h1>üìã Lista de Presen√ßa</h1>
        <div class="reuniao-info">
          <span>Reuni√£o:</span> 
          <span id="dataReuniaoAtual">--/--/----</span> | 
          <span>Local:</span> 
          <span id="localReuniaoAtual">---</span>
        </div>
      </div>
      
      <div class="lista-presenca" id="listaPresenca">
        <!-- Lista de membros ser√° preenchida via JavaScript -->
      </div>
      
      <div class="botoes-reuniao-fixo">
        <button class="btn-reuniao-fixo" style="background: #f59e0b;" onclick="abrirPresencasConfirmadas()">üìã Presen√ßas Confirmadas</button>
        <button class="btn-reuniao-fixo btn-finalizar-reuniao" onclick="finalizarReuniao()">‚úÖ Finalizar Reuni√£o</button>
        <button class="btn-reuniao-fixo btn-abortar-reuniao-fixo" onclick="abortarReuniao()">‚ùå Abortar Reuni√£o</button>
        <button class="btn-reuniao-fixo" style="background: #667eea;" onclick="imprimirListaPresenca()">üñ®Ô∏è Imprimir Lista</button>
      </div>
    </div>
  </div>

  <!-- TELA PRESEN√áAS CONFIRMADAS -->
  <div class="tela" id="telaConfirmacoes">
    <div class="tela-presenca">
      <div class="header">
        <h1>üìã Presen√ßas Confirmadas</h1>
        <div class="reuniao-info">
          <span>Reuni√£o:</span> 
          <span id="dataReuniaoConfirmacoes">--/--/----</span> | 
          <span>Local:</span> 
          <span id="localReuniaoConfirmacoes">---</span>
        </div>
      </div>
      
      <!-- Estat√≠sticas -->
      <div class="confirmacoes-estatisticas">
        <div class="stat-card stat-confirmado">
          <div class="stat-emoji">‚úÖ</div>
          <div class="stat-valor" id="statConfirmados">0</div>
          <div class="stat-label">Confirmados</div>
        </div>
        <div class="stat-card stat-justificado">
          <div class="stat-emoji">‚ö†Ô∏è</div>
          <div class="stat-valor" id="statJustificados">0</div>
          <div class="stat-label">Justificaram</div>
        </div>
        <div class="stat-card stat-nao-vai">
          <div class="stat-emoji">‚ùå</div>
          <div class="stat-valor" id="statNaoVao">0</div>
          <div class="stat-label">N√£o v√£o</div>
        </div>
        <div class="stat-card stat-pendente">
          <div class="stat-emoji">‚è≥</div>
          <div class="stat-valor" id="statPendentes">0</div>
          <div class="stat-label">Pendentes</div>
        </div>
      </div>
      
      <div class="confirmacoes-resumo" id="confirmacoes-resumo">
        Total: <span id="totalConfirmacoes">0 de 0 confirmados (0%)</span>
      </div>
      
      <!-- Filtros -->
      <div class="confirmacoes-filtros">
        <button class="filtro-btn active" data-filtro="todos" onclick="filtrarConfirmacoes('todos')">Todos</button>
        <button class="filtro-btn" data-filtro="confirmado" onclick="filtrarConfirmacoes('confirmado')">Confirmados</button>
        <button class="filtro-btn" data-filtro="justificado" onclick="filtrarConfirmacoes('justificado')">Justificaram</button>
        <button class="filtro-btn" data-filtro="nao_vai" onclick="filtrarConfirmacoes('nao_vai')">N√£o v√£o</button>
        <button class="filtro-btn" data-filtro="pendente" onclick="filtrarConfirmacoes('pendente')">Pendentes</button>
      </div>
      
      <div class="lista-presenca" id="listaConfirmacoes">
        <!-- Lista de membros ser√° preenchida via JavaScript -->
      </div>
      
      <div class="botoes-reuniao-fixo">
        <button class="btn-reuniao-fixo" style="background: #667eea;" onclick="gerarPDFConfirmacoes()">üìÑ Gerar PDF</button>
        <button class="btn-reuniao-fixo" style="background: #6c757d;" onclick="voltarParaPresenca()">‚Ü©Ô∏è Voltar</button>
        <button class="btn-reuniao-fixo btn-abortar-reuniao-fixo" onclick="abortarReuniao()">‚ùå Abortar Reuni√£o</button>
      </div>
    </div>
  </div>

  <!-- TELA AN√ÅLISES -->
  <div class="tela" id="telaAnalises">
    <div class="analises-container">
      <h1 style="text-align:center;color:#2c3e50;margin-bottom:25px;font-size:1.8em;">üìä An√°lises do Conselho</h1>
      <div class="analises-menu">
        <button class="analise-btn" onclick="mostrarAnalise('presenca')">üìà Presen√ßa</button>
        <button class="analise-btn active" onclick="mostrarAnalise('composicao')">üë• Composi√ß√£o</button>
        <button class="analise-btn" onclick="mostrarAnalise('estados')">üó∫Ô∏è Estados</button>
        <button class="analise-btn" onclick="mostrarAnalise('atividades')">‚úÖ Atividades</button>
        <button class="analise-btn" style="background: #2ecc71;" onclick="gerarRelatorioAnalises()">üìÑ Gerar Relat√≥rio</button>
      </div>
      
      <div class="analise-content" id="analisePresenca">
        <h2 style="margin-bottom:18px;font-size:1.4em;">Ranking de Assiduidade</h2>
        <div id="rankingContainer">
          <p class="mensagem-vazio">Nenhum registro de presen√ßa encontrado</p>
        </div>
      </div>
      
      <div class="analise-content active" id="analiseComposicao">
        <div id="composicaoContainer">
          <p class="mensagem-vazio">Nenhum conselheiro cadastrado</p>
        </div>
      </div>
      
      <div class="analise-content" id="analiseEstados">
        <div id="estadosContainer">
          <p class="mensagem-vazio">Nenhum conselheiro cadastrado</p>
        </div>
      </div>
      
      <div class="analise-content" id="analiseAtividades">
        <div id="atividadesContainer">
          <p class="mensagem-vazio">Nenhuma atividade cadastrada</p>
        </div>
      </div>
    </div>
  </div>

  <div class="tela" id="telaDocumentos">
    <div class="documentos-container">
      <div class="documentos-titulo">üìÅ DOCUMENTOS E LEGISLA√á√ÉO</div>
      
      <div class="documentos-botoes">
        <button class="btn-criar-pasta-raiz" onclick="abrirModalCriarPasta()">‚ûï Nova Pasta</button>
        <button class="btn-adicionar-doc-raiz" onclick="abrirModalAdicionarDocumento(null)">‚ûï Novo Documento</button>
      </div>

      <div class="documentos-lista" id="documentosLista">
        <div class="mensagem-vazio-docs">
          üì≠ Nenhum documento cadastrado
        </div>
      </div>
    </div>
  </div>

  <script>
    // ============================================
    // VARI√ÅVEIS GLOBAIS
    // ============================================
    let modoEdicao = false;
    let modoReuniao = false;
    let elementoEmojiAtual = null;
    let tipoEmojiAtual = '';
    let elementoAtividadeAtual = null;
    let isAtividadeGT = false;
    let elementoGTAtual = null;
    let atividadeEmEdicao = null;
    let camaraEdicaoNomeAtual = null;
    let cadeiraAtualAdicionarMembro = null;
    let membroAtualEditando = null;
    let reuniaoAtual = null;
    let bolinhaEditando = null;
    let emojiContext = null;
    let confirmacoesData = {}; // Dados de confirma√ß√µes de presen√ßa
    let filtroAtualConfirmacoes = 'todos'; // Filtro ativo
    let debounceTimers = {}; // Timers para debounce de observa√ß√µes

    // ============================================
    // FUN√á√ïES AUXILIARES PARA MANIPULA√á√ÉO DE DATAS SEM TIMEZONE
    // ============================================
    // CORRE√á√ÉO CR√çTICA: Estas fun√ß√µes evitam problemas de fuso hor√°rio
    // onde uma data selecionada aparece com um dia a menos devido √†
    // convers√£o UTC -> Local (ex: 2025-12-03 vira 2025-12-02 √†s 21:00)
    
    /**
     * Formata uma string de data (YYYY-MM-DD) para formato brasileiro (DD/MM/YYYY)
     * SEM fazer convers√£o de timezone
     */
    function formatarDataSemTimezone(dataString) {
      if (!dataString) return '';
      const [ano, mes, dia] = dataString.split('-');
      return `${dia}/${mes}/${ano}`;
    }
    
    /**
     * Cria um objeto Date for√ßando interpreta√ß√£o local ao meio-dia
     * Isso evita problemas com mudan√ßa de dia devido a UTC
     */
    function criarDataLocal(dataString) {
      if (!dataString) return new Date();
      const [ano, mes, dia] = dataString.split('-');
      return new Date(parseInt(ano), parseInt(mes) - 1, parseInt(dia), 12, 0, 0);
    }

    // ============================================
    // SISTEMA DE COLLAPSE/ACORDE√ÉO
    // ============================================
    
        // Document Management Globals
    let documentosData = { estrutura: [] };
    let pastaParenteAtual = null;
    let itemEditandoAtual = null;
    let tipoItemEditando = null;
    let pastaAtualEdicao = null;
    let itemAtualEdicao = null;

function togglePresidencia() {
      const header = document.querySelector('.presidencia-header');
      const conteudo = document.querySelector('.presidencia-conteudo');
      
      header.classList.toggle('active');
      conteudo.classList.toggle('active');
    }
    
    function toggleGrupo(elemento) {
      const header = elemento;
      const grupo = header.closest('.grupo');
      const conteudo = grupo.querySelector('.grupo-conteudo');
      
      header.classList.toggle('active');
      conteudo.classList.toggle('active');
    }
    
    function toggleSetor(elemento) {
      const wrapper = elemento.closest('.setor-header-wrapper');
      const setor = wrapper.closest('.setor');
      const conteudo = setor.querySelector('.setor-conteudo');
      
      wrapper.classList.toggle('active');
      conteudo.classList.toggle('active');
    }
    
    function expandirTudo() {
      document.querySelectorAll('.presidencia-header, .grupo-header, .setor-header-wrapper').forEach(el => {
        el.classList.add('active');
      });
      document.querySelectorAll('.presidencia-conteudo, .grupo-conteudo, .setor-conteudo').forEach(el => {
        el.classList.add('active');
      });
    }
    
    function colapsarTudo() {
      document.querySelectorAll('.presidencia-header, .grupo-header, .setor-header-wrapper').forEach(el => {
        el.classList.remove('active');
      });
      document.querySelectorAll('.presidencia-conteudo, .grupo-conteudo, .setor-conteudo').forEach(el => {
        el.classList.remove('active');
      });
    }

    // ============================================
    // GERAR SLUG AUTOM√ÅTICO PARA C√ÇMARAS
    // ============================================
    function gerarSlug(nome) {
        return nome
            .toLowerCase()
            .normalize('NFD').replace(/[\u0300-\u036f]/g, '')
            .replace(/[^a-z0-9\s-]/g, '')
            .replace(/\s+/g, '-')
            .replace(/-+/g, '-')
            .trim();
    }

    function gerarSlugUnico(nomeBase) {
        let slug = gerarSlug(nomeBase);
        let slugOriginal = slug;
        let contador = 1;
        
        while (document.querySelector(`.camara[data-camara="${slug}"]`)) {
            slug = `${slugOriginal}-${contador}`;
            contador++;
        }
        
        return slug;
    }

    // ============================================
    // SELETOR DE EMOJI PARA C√ÇMARAS
    // ============================================
    // ============================================
// SELETOR DE EMOJI SIMPLIFICADO PARA C√ÇMARAS
// ============================================
function selecionarEmojiCamara(emoji) {
    document.getElementById('inputEmojiCamara').value = emoji;
    document.getElementById('emojiSelecionadoPreview').textContent = emoji;
    
    // Remover sele√ß√£o anterior
    document.querySelectorAll('.emoji-option-simples').forEach(el => {
        el.classList.remove('selecionado');
    });
    
    // Adicionar sele√ß√£o atual
    event.target.classList.add('selecionado');
}

function abrirModalCriarCamara() {
    if(!modoEdicao) {
        alert('‚ö†Ô∏è Ative o modo de edi√ß√£o primeiro!');
        return;
    }
    
    // Resetar o modal
    document.getElementById('inputNomeCamara').value = '';
    document.getElementById('inputEmojiCamara').value = 'üî¨';
    document.getElementById('emojiSelecionadoPreview').textContent = 'üî¨';
    
    // Resetar sele√ß√£o de emojis
    document.querySelectorAll('.emoji-option-simples').forEach(el => {
        el.classList.remove('selecionado');
    });
    
    // Selecionar o primeiro emoji por padr√£o
    document.querySelector('.emoji-option-simples').classList.add('selecionado');
    
    document.getElementById('modalCriarCamara').classList.add('active');
}

function confirmarCriarCamara() {
    const nome = document.getElementById('inputNomeCamara').value;
    const emoji = document.getElementById('inputEmojiCamara').value || 'üî¨';
    
    if(!nome) {
        alert('‚ö†Ô∏è Preencha o nome da c√¢mara!');
        return;
    }
    
    const slug = gerarSlugUnico(nome);
    
    const grid = document.getElementById('camarasGrid');
    const novaCamara = document.createElement('div');
    novaCamara.className = 'camara';
    novaCamara.dataset.camara = slug;
    novaCamara.innerHTML = `
        <div class="camara-header">
            <div class="camara-nome">${emoji} ${nome}</div>
            <div class="camara-contador">0 membros</div>
            <button class="btn-editar-nome-camara" onclick="editarNomeCamara(this)">‚úèÔ∏è</button>
            <button class="btn-remover-camara" onclick="removerCamara(this)">üóëÔ∏è</button>
        </div>
        <div class="camara-membros"></div>
        <div class="camara-atividades"></div>
        <div class="camara-gts"></div>
        <button class="btn-add-atividade" onclick="abrirModalAdicionarAtividade(this, false)">‚úÖ Atividade</button>
        <button class="btn-add-gt" onclick="abrirModalCriarGT(this)">üìã GT</button>
    `;
    
    grid.appendChild(novaCamara);
    configurarDragAndDrop();
    
    fecharModal('modalCriarCamara');
    alert(`‚úÖ C√¢mara "${nome}" criada!\n\nüîó Slug gerado: ${slug}`);
    
    // Limpar campos
    document.getElementById('inputNomeCamara').value = '';

    }

    // ============================================
    // ATUALIZAR CONTADORES
    // ============================================
    function atualizarContadoresGrupo(grupoId) {
      const grupo = document.getElementById(grupoId);
      if(!grupo) return;
      
      const numSetores = grupo.querySelectorAll('.setor').length;
      let numCadeiras = grupo.querySelectorAll('.cadeira').length;
      
      // Se for poder p√∫blico, adicionar 1 para incluir o Presidente (Cadeira 1)
      if (grupoId === 'poder-publico') {
        numCadeiras += 1; // Presidente conta como Cadeira 1
      }
      
      const contadorSetores = grupo.querySelector('.contador-setores');
      const contadorCadeiras = grupo.querySelector('.contador-cadeiras-total');
      
      if(contadorSetores) contadorSetores.textContent = numSetores;
      if(contadorCadeiras) contadorCadeiras.textContent = numCadeiras;
    }

    function atualizarContadorCadeiras(setor) {
      const numCadeiras = setor.querySelectorAll('.cadeira').length;
      const contador = setor.querySelector('.contador-cadeiras');
      if(contador) {
        contador.textContent = `${numCadeiras} cadeira${numCadeiras !== 1 ? 's' : ''}`;
      }
      
      const grupoId = setor.closest('.grupo')?.id;
      if(grupoId) {
        atualizarContadoresGrupo(grupoId);
      }
    }

    function atualizarContadorCamara(camara) {
      const numMembros = camara.querySelectorAll('.camara-membro').length;
      const contador = camara.querySelector('.camara-contador');
      if(contador) {
        contador.textContent = `${numMembros} membro${numMembros !== 1 ? 's' : ''}`;
      }
    }

    // ============================================
    // MENU
    // ============================================
    function toggleMenu() {
      document.getElementById('menuDropdown').classList.toggle('active');
    }

    function irParaTela(tela) {
      document.querySelectorAll('.tela').forEach(t => t.classList.remove('active'));
      if(tela === 'principal') {
        document.getElementById('telaPrincipal').classList.add('active');
      } else if(tela === 'presenca') {
        document.getElementById('telaPresenca').classList.add('active');
      } else if(tela === 'analises') {
        document.getElementById('telaAnalises').classList.add('active');
        gerarAnalises();
      } else if(tela === 'documentos') {
        document.getElementById('telaDocumentos').classList.add('active');
        renderizarDocumentos();
      
      }
      toggleMenu();
    }

    // ============================================
    // MODO EDI√á√ÉO
    // ============================================
    function solicitarSenha() {
      toggleMenu();
      document.getElementById('modalSenha').classList.add('active');
      document.getElementById('inputSenha').value = '';
      document.getElementById('inputSenha').focus();
    }

    function verificarSenha() {
      const senha = document.getElementById('inputSenha').value;
      if(senha === '123') {
        fecharModal('modalSenha');
        ativarModoEdicao();
      } else {
        alert('‚ùå Senha incorreta!');
      }
    }

    function ativarModoEdicao() {
      modoEdicao = true;
      document.body.classList.add('edit-mode');
      document.getElementById('editIndicator').classList.add('active');
      document.getElementById('btnCancelarEdicao').classList.add('active');
      document.getElementById('menuCancelarEdicao').style.display = 'block';
      
      document.querySelectorAll('.editable').forEach(el => {
        el.contentEditable = 'true';
      });
      document.querySelectorAll('.editable-inline').forEach(el => {
        el.contentEditable = 'true';
      });

      document.querySelectorAll('.bolinha-presenca').forEach(bolinha => {
        bolinha.onclick = function() { editarBolinhaPresenca(this); };
      });

      colapsarTudo();
      
      // Configurar drag & drop para documentos
      configurarDragDropDocumentos();
      
      // Configurar drag & drop para cadeiras e membros
      configurarDragDropCadeiras();
      configurarDragDropMembros();

      alert('üîì Modo de edi√ß√£o ativado!\n\nAgora voc√™ pode:\n‚Ä¢ Editar textos\n‚Ä¢ Adicionar/remover setores e cadeiras\n‚Ä¢ Criar c√¢maras tem√°ticas\n‚Ä¢ Arrastar membros entre c√¢maras\n‚Ä¢ Arrastar cadeiras para reordenar dentro de setores\n‚Ä¢ Arrastar membros para reordenar dentro de cadeiras\n‚Ä¢ Editar curr√≠culos\n‚Ä¢ Editar presen√ßas (clique nas bolinhas)\n‚Ä¢ Arrastar pastas e documentos para reordenar');
    }

    function finalizarEdicao() {
      toggleMenu();
      document.getElementById('modalFinalizarEdicao').classList.add('active');
    }

    function salvarEFinalizarEdicao() {
      salvarJSON();
      finalizarModoEdicao();
    }

    function finalizarSemSalvar() {
      if(confirm('‚ö†Ô∏è Finalizar sem salvar?\n\nTodas as altera√ß√µes ser√£o perdidas!')) {
        finalizarModoEdicao();
      }
    }

    function finalizarModoEdicao() {
      modoEdicao = false;
      document.body.classList.remove('edit-mode');
      document.getElementById('editIndicator').classList.remove('active');
      document.getElementById('btnCancelarEdicao').classList.remove('active');
      document.getElementById('menuCancelarEdicao').style.display = 'none';
      
      document.querySelectorAll('.editable').forEach(el => {
        el.contentEditable = 'false';
      });
      document.querySelectorAll('.editable-inline').forEach(el => {
        el.contentEditable = 'false';
      });

      document.querySelectorAll('.bolinha-presenca').forEach(bolinha => {
        bolinha.onclick = null;
      });
      
      // Desabilitar drag & drop para cadeiras e membros
      document.querySelectorAll('.cadeira').forEach(cadeira => {
        cadeira.draggable = false;
        cadeira.style.cursor = '';
      });
      
      document.querySelectorAll('.cadeira .membro-linha').forEach(membro => {
        membro.draggable = false;
        membro.style.cursor = '';
      });

      fecharModal('modalFinalizarEdicao');
      alert('‚úÖ Modo de edi√ß√£o finalizado!');
    }

    function cancelarEdicaoRapido() {
      if(confirm('‚ùì Cancelar edi√ß√£o?\n\nTodas as altera√ß√µes ser√£o perdidas!')) {
        location.reload();
      }
    }

    // ============================================
    // MODO REUNI√ÉO
    // ============================================

    function ativarModoReuniao() {
      toggleMenu();
      const hoje = new Date().toISOString().split('T')[0];
      document.getElementById('inputDataReuniao').value = hoje;
      document.getElementById('modalReuniao').classList.add('active');
    }

    function iniciarReuniao() {
    const data = document.getElementById('inputDataReuniao').value;
    const local = document.getElementById('inputLocalReuniao').value;
    
    if(!data || !local) {
        alert('‚ö†Ô∏è Preencha data e local da reuni√£o!');
        return;
    }
    
    // CORRE√á√ÉO DE TIMEZONE: Usar formata√ß√£o sem convers√£o UTC
    // Salvar a string pura da data (YYYY-MM-DD) e formatar sem timezone
    const dataFormatada = formatarDataSemTimezone(data);
    
    reuniaoAtual = {
        data: data, // Mant√©m string pura YYYY-MM-DD
        dataFormatada: dataFormatada, // DD/MM/YYYY formatado sem timezone
        local: local,
        timestamp: new Date().getTime()
    };
    
    document.querySelectorAll('.tela').forEach(t => t.classList.remove('active'));
    document.getElementById('telaPresenca').classList.add('active');
    
    document.getElementById('dataReuniaoAtual').textContent = dataFormatada;
    document.getElementById('localReuniaoAtual').textContent = local;
    
    carregarListaPresenca();
    
    fecharModal('modalReuniao');
    
    // ADICIONAR ESTA LINHA NO FINAL DA FUN√á√ÉO:
    atualizarContadorQuorum();
    localStorage.removeItem('presencasReuniao'); // Limpar presen√ßas anteriores
    atualizarContadorQuorum();
}

    // SUBSTITUIR ESTA FUN√á√ÉO COMPLETAMENTE:
function carregarListaPresenca() {
    const container = document.getElementById('listaPresenca');
    container.innerHTML = '';
    
    const cadeiras = new Map(); // Usar Map para agrupar por cadeira
    
    function coletarCadeiras(seletor, grupo) {
        document.querySelectorAll(seletor).forEach(cadeira => {
            const numeroCadeira = cadeira.querySelector('.numero-cadeira')?.textContent || '';
            const setorEl = cadeira.closest('.setor');
            const nomeSetor = setorEl?.querySelector('.titulo-setor .editable')?.textContent || '';
            
            // ID √∫nico para cada cadeira
            const cadeiraId = `cadeira-${grupo}-${nomeSetor.replace(/\s+/g, '-')}-${numeroCadeira.replace(/\s+/g, '-')}`;
            
            // Coletar todos os membros desta cadeira (titular e suplente)
            const membrosCadeira = [];
            cadeira.querySelectorAll('.membro-linha:not(.vazio)').forEach(membro => {
                const nome = membro.querySelector('.nome-membro')?.textContent || '';
                const entidade = membro.querySelector('.entidade-membro')?.textContent || '';
                const telefone = membro.dataset.telefone || '';
                const boneco = membro.querySelector('.bonequinho')?.textContent || 'üë§';
                const tipo = membro.classList.contains('titular') ? 'Titular' : 'Suplente';
                
                if(nome && nome.trim() !== '' && nome !== 'VAGA' && nome !== '-') {
                    membrosCadeira.push({
                        nome, entidade, telefone, boneco, tipo,
                        elemento: membro,
                        setorNome: nomeSetor
                    });
                }
            });
            
            if (membrosCadeira.length > 0) {
                cadeiras.set(cadeiraId, {
                    id: cadeiraId,
                    grupo: grupo,
                    nomeSetor: nomeSetor,
                    numeroCadeira: numeroCadeira,
                    membros: membrosCadeira
                });
            }
        });
    }
    
    // Coletar da presid√™ncia (tratar como uma cadeira especial)
    const presidenciaContainer = document.getElementById('presidenciaContainer');
    if (presidenciaContainer) {
        const membrosPresidencia = [];
        presidenciaContainer.querySelectorAll('.membro-linha:not(.vazio)').forEach(membro => {
            const nome = membro.querySelector('.nome-membro')?.textContent || '';
            const entidade = membro.querySelector('.entidade-membro')?.textContent || '';
            const telefone = membro.dataset.telefone || '';
            const boneco = membro.querySelector('.bonequinho')?.textContent || 'üë§';
            const tipo = 'Presidente';
            
            if(nome && nome.trim() !== '' && nome !== 'VAGA' && nome !== '-') {
                membrosPresidencia.push({
                    nome, entidade, telefone, boneco, tipo,
                    elemento: membro
                });
            }
        });
        
        if (membrosPresidencia.length > 0) {
            cadeiras.set('presidencia', {
                id: 'presidencia',
                grupo: 'PRESID√äNCIA',
                nomeSetor: 'PRESID√äNCIA',
                numeroCadeira: 'PRESID√äNCIA',
                membros: membrosPresidencia
            });
        }
    }
    
    // Coletar do poder p√∫blico e sociedade civil
    coletarCadeiras('#poder-publico .cadeira', 'PODER-PUBLICO');
    coletarCadeiras('#sociedade-civil .cadeira', 'SOCIEDADE-CIVIL');
    
    let ultimoGrupo = '';
    let ultimoSetor = '';
    
    // Ordenar as cadeiras: Presid√™ncia -> Poder P√∫blico -> Sociedade Civil
    const cadeirasOrdenadas = Array.from(cadeiras.values()).sort((a, b) => {
        const ordemGrupos = { 'PRESID√äNCIA': 0, 'PODER-PUBLICO': 1, 'SOCIEDADE-CIVIL': 2 };
        return ordemGrupos[a.grupo] - ordemGrupos[b.grupo];
    });
    
    cadeirasOrdenadas.forEach(cadeira => {
        // Cabe√ßalho do grupo se mudou
        if (cadeira.grupo !== ultimoGrupo) {
            const headerGrupo = document.createElement('div');
            headerGrupo.className = 'grupo-header-lista';
            headerGrupo.style.cssText = `
                background: #667eea; 
                color: white; 
                padding: 12px 15px; 
                margin: 10px 0 5px 0; 
                border-radius: 8px; 
                font-weight: bold; 
                font-size: 1.1em;
            `;
            
            let nomeGrupo = '';
            switch(cadeira.grupo) {
                case 'PRESID√äNCIA': nomeGrupo = 'PRESID√äNCIA'; break;
                case 'PODER-PUBLICO': nomeGrupo = 'PODER P√öBLICO'; break;
                case 'SOCIEDADE-CIVIL': nomeGrupo = 'SOCIEDADE CIVIL'; break;
                default: nomeGrupo = cadeira.grupo;
            }
            
            headerGrupo.textContent = nomeGrupo;
            container.appendChild(headerGrupo);
            ultimoGrupo = cadeira.grupo;
            ultimoSetor = ''; // Resetar setor ao mudar de grupo
        }
        
        // Cabe√ßalho do setor se mudou (exceto para Presid√™ncia)
        if (cadeira.grupo !== 'PRESID√äNCIA' && cadeira.nomeSetor !== ultimoSetor) {
            const headerSetor = document.createElement('div');
            headerSetor.className = 'setor-header-lista';
            headerSetor.style.cssText = `
                background: #51cf66; 
                color: white; 
                padding: 8px 15px; 
                margin: 8px 0 5px 0; 
                border-radius: 6px; 
                font-weight: bold; 
                font-size: 0.95em;
                border-left: 4px solid #37b24d;
            `;
            
            headerSetor.textContent = `üìÇ ${cadeira.nomeSetor}`;
            container.appendChild(headerSetor);
            ultimoSetor = cadeira.nomeSetor;
        }
        
        // Para cada membro na cadeira (pode ter titular e suplente)
        cadeira.membros.forEach(membro => {
            const item = document.createElement('div');
            item.className = 'item-lista-presenca';
            
            let descricaoCadeira = '';
            if (cadeira.grupo === 'PRESID√äNCIA') {
                descricaoCadeira = 'PRESID√äNCIA';
            } else {
                descricaoCadeira = `${cadeira.nomeSetor} - ${cadeira.numeroCadeira}`;
            }
            
            item.innerHTML = `
                <div class="info-membro-presenca">
                    <div style="font-size: 2em;">${membro.boneco}</div>
                    <div style="flex: 1;">
                        <div style="font-weight: bold; font-size: 1em;">${membro.nome}</div>
                        <div style="font-size: 0.85em; color: #6c757d;">${membro.entidade}</div>
                        <div style="font-size: 0.8em; color: #495057; margin-top: 3px;">
                            <strong>Cadeira:</strong> ${descricaoCadeira}
                        </div>
                        <div style="font-size: 0.75em; color: #868e96; background: ${membro.tipo === 'Titular' ? '#1976d2' : membro.tipo === 'Suplente' ? '#f57c00' : '#667eea'}; color: white; padding: 2px 6px; border-radius: 10px; display: inline-block; margin-top: 3px;">${membro.tipo}</div>
                    </div>
                </div>
                <div class="bolinha-grande" onclick="marcarPresenca(this, '${cadeira.id}')" data-membro="${membro.nome}" data-cadeira="${cadeira.id}"></div>
            `;
            container.appendChild(item);
        });
    });
          
    // INICIALIZAR CONTADOR DE QU√ìRUM
    atualizarContadorQuorum();
}
// Nova fun√ß√£o para marcar presen√ßa com controle de qu√≥rum
// SUBSTITUIR ESTA FUN√á√ÉO COMPLETAMENTE:
function marcarPresenca(bolinha, cadeiraId) {
    // Alternar entre os estados da bolinha
    if(!bolinha.classList.contains('verde') && !bolinha.classList.contains('amarelo') && !bolinha.classList.contains('vermelho')) {
        bolinha.classList.add('verde');
    } else if(bolinha.classList.contains('verde')) {
        bolinha.classList.remove('verde');
        bolinha.classList.add('amarelo');
    } else if(bolinha.classList.contains('amarelo')) {
        bolinha.classList.remove('amarelo');
        bolinha.classList.add('vermelho');
    } else {
        bolinha.classList.remove('vermelho');
    }
    
    // Atualizar localStorage com controle por cadeira
    atualizarPresencaCadeiraLocalStorage(cadeiraId, bolinha);
    
    // Atualizar contador de qu√≥rum
    atualizarContadorQuorum();
}

// FUN√á√ÉO CORRIGIDA para atualizarPresencaCadeiraLocalStorage
function atualizarPresencaCadeiraLocalStorage(cadeiraId, bolinha) {
    let presencas = JSON.parse(localStorage.getItem('presencasReuniao') || '{}');
    
    // Encontrar todos os membros desta mesma cadeira
    const membrosDaCadeira = document.querySelectorAll(`.bolinha-grande[data-cadeira="${cadeiraId}"]`);
    
    // Verificar se pelo menos um membro da cadeira est√° presente (VERDE)
    let cadeiraPresente = false;
    membrosDaCadeira.forEach(membroBolinha => {
        if(membroBolinha.classList.contains('verde')) { // S√ì CONTA VERDE COMO PRESEN√áA
            cadeiraPresente = true;
        }
    });
    
    if (cadeiraPresente) {
        presencas[cadeiraId] = true;
    } else {
        delete presencas[cadeiraId];
    }
    
    localStorage.setItem('presencasReuniao', JSON.stringify(presencas));
}

// FUN√á√ÉO CORRIGIDA para marcarPresenca
function marcarPresenca(bolinha, cadeiraId) {
    // Alternar entre os estados da bolinha
    if(!bolinha.classList.contains('verde') && !bolinha.classList.contains('amarelo') && !bolinha.classList.contains('vermelho')) {
        bolinha.classList.add('verde');
    } else if(bolinha.classList.contains('verde')) {
        bolinha.classList.remove('verde');
        bolinha.classList.add('amarelo');
    } else if(bolinha.classList.contains('amarelo')) {
        bolinha.classList.remove('amarelo');
        bolinha.classList.add('vermelho');
    } else {
        bolinha.classList.remove('vermelho');
    }
    
    // Atualizar localStorage com controle por cadeira
    atualizarPresencaCadeiraLocalStorage(cadeiraId, bolinha);
    
    // Atualizar contador de qu√≥rum
    atualizarContadorQuorum();
}
// Fun√ß√£o para atualizar o contador de qu√≥rum
function atualizarContadorQuorum() {
    const presencas = JSON.parse(localStorage.getItem('presencasReuniao') || '{}');
    const cadeirasPresentes = Object.keys(presencas).length;
    const totalCadeiras = calcularTotalCadeiras();
    const quorum = cadeirasPresentes >= Math.ceil(totalCadeiras / 2);
    
    console.log(`DEBUG - Presentes: ${cadeirasPresentes}, Total: ${totalCadeiras}, Qu√≥rum: ${quorum}`);
    
    // Atualizar indicador na tela
    let indicadorQuorum = document.getElementById('indicadorQuorum');
    if (!indicadorQuorum) {
        indicadorQuorum = criarIndicadorQuorum();
    }
    
    indicadorQuorum.innerHTML = `
        <strong>QU√ìRUM:</strong> ${cadeirasPresentes} de ${totalCadeiras} cadeiras presentes | 
        <span style="color: ${quorum ? '#51cf66' : '#ff6b6b'}; font-weight: bold;">
            ${quorum ? '‚úÖ QU√ìRUM ATINGIDO' : '‚ùå QU√ìRUM N√ÉO ATINGIDO'}
        </span>
        <button onclick="limparPresencas()" style="margin-left: 10px; padding: 2px 8px; background: #ff6b6b; color: white; border: none; border-radius: 4px; font-size: 0.8em;">Limpar</button>
    `;
}
function limparPresencas() {
    if (confirm('Limpar todas as presen√ßas marcadas?')) {
        localStorage.removeItem('presencasReuniao');
        
        // Limpar visualmente todas as bolinhas
        document.querySelectorAll('#listaPresenca .bolinha-grande').forEach(bolinha => {
            bolinha.classList.remove('verde', 'amarelo', 'vermelho');
        });
        
        atualizarContadorQuorum();
        alert('Presen√ßas limpas!');
    }
}

// Criar indicador de qu√≥rum
function criarIndicadorQuorum() {
  const indicador = document.createElement('div');
  indicador.id = 'indicadorQuorum';
  indicador.style.cssText = `
    position: fixed;
    top: 15px;
    left: 50%;
    transform: translateX(-50%);
    background: white;
    padding: 10px 20px;
    border-radius: 8px;
    box-shadow: 0 3px 10px rgba(0,0,0,0.3);
    z-index: 1000;
    font-weight: bold;
    border: 2px solid #667eea;
  `;
  document.getElementById('telaPresenca').appendChild(indicador);
  return indicador;
}

    function finalizarReuniao() {
    if(confirm('‚úÖ Finalizar lista de presen√ßa?\n\nAs presen√ßas ser√£o salvas permanentemente.')) {
        const presencas = JSON.parse(localStorage.getItem('presencasReuniao') || '{}');
        const cadeirasPresentes = Object.keys(presencas).length;
        const totalCadeiras = calcularTotalCadeiras();
        const quorum = cadeirasPresentes >= Math.ceil(totalCadeiras / 2);
        
        // Coletar todas as presen√ßas marcadas na tela
        const presencasDetalhadas = [];
        
        document.querySelectorAll('#listaPresenca .bolinha-grande').forEach(bolinha => {
            const nomeMembro = bolinha.dataset.membro;
            const cadeiraId = bolinha.dataset.cadeira;
            let status = '';
            
            if(bolinha.classList.contains('verde')) status = 'presente';
            else if(bolinha.classList.contains('amarelo')) status = 'justificado';
            else if(bolinha.classList.contains('vermelho')) status = 'faltou';
            
            if(status && nomeMembro) {
                presencasDetalhadas.push({
                    nome: nomeMembro,
                    status: status,
                    cadeiraId: cadeiraId,
                    data: reuniaoAtual.data,
                    dataFormatada: reuniaoAtual.dataFormatada,
                    local: reuniaoAtual.local,
                    timestamp: reuniaoAtual.timestamp
                });
            }
        });
        
        // Salvar presen√ßas nos membros correspondentes
        presencasDetalhadas.forEach(presenca => {
            const membro = encontrarMembroPorNome(presenca.nome);
            if(membro) {
                adicionarBolinhaPresenca(membro, presenca);
            }
        });
        
        // Exibir resumo da reuni√£o
        let mensagemResumo = `üìä RESUMO DA REUNI√ÉO:\n\n`;
        mensagemResumo += `üìç ${reuniaoAtual.dataFormatada} - ${reuniaoAtual.local}\n`;
        mensagemResumo += `üë• ${cadeirasPresentes} de ${totalCadeiras} cadeiras presentes\n`;
        mensagemResumo += `üìã ${presencasDetalhadas.length} registros de presen√ßa\n`;
        mensagemResumo += `‚öñÔ∏è QU√ìRUM: ${quorum ? '‚úÖ ATINGIDO' : '‚ùå N√ÉO ATINGIDO'}\n\n`;
        
        // Contar por status
        const presentes = presencasDetalhadas.filter(p => p.status === 'presente').length;
        const justificados = presencasDetalhadas.filter(p => p.status === 'justificado').length;
        const faltas = presencasDetalhadas.filter(p => p.status === 'faltou').length;
        
        mensagemResumo += `üü¢ Presentes: ${presentes}\n`;
        mensagemResumo += `üü° Justificados: ${justificados}\n`;
        mensagemResumo += `üî¥ Faltas: ${faltas}`;
        
        // LIMPAR PRESEN√áAS TEMPOR√ÅRIAS
        localStorage.removeItem('presencasReuniao');
        
        // Voltar para tela principal
        document.querySelectorAll('.tela').forEach(t => t.classList.remove('active'));
        document.getElementById('telaPrincipal').classList.add('active');
        
        reuniaoAtual = null;
        
        // Mostrar resumo
        alert(mensagemResumo);
        
        // Atualizar an√°lises se estiver na tela de an√°lises
        if(document.getElementById('telaAnalises').classList.contains('active')) {
            gerarAnalises();
        }
    }
}

// Fun√ß√£o auxiliar para encontrar membro pelo nome (j√° existe, mas vou incluir para garantir)
function encontrarMembroPorNome(nome) {
    let membroEncontrado = null;
    
    // Buscar na presid√™ncia
    document.querySelectorAll('#presidenciaContainer .membro-linha:not(.vazio)').forEach(membro => {
        const nomeMembro = membro.querySelector('.nome-membro')?.textContent || '';
        if(nomeMembro === nome) {
            membroEncontrado = membro;
        }
    });
    
    // Buscar no poder p√∫blico
    if (!membroEncontrado) {
        document.querySelectorAll('#poder-publico .membro-linha:not(.vazio)').forEach(membro => {
            const nomeMembro = membro.querySelector('.nome-membro')?.textContent || '';
            if(nomeMembro === nome) {
                membroEncontrado = membro;
            }
        });
    }
    
    // Buscar na sociedade civil
    if (!membroEncontrado) {
        document.querySelectorAll('#sociedade-civil .membro-linha:not(.vazio)').forEach(membro => {
            const nomeMembro = membro.querySelector('.nome-membro')?.textContent || '';
            if(nomeMembro === nome) {
                membroEncontrado = membro;
            }
        });
    }
    
    return membroEncontrado;
}

// Fun√ß√£o para adicionar bolinha de presen√ßa (j√° existe, mas vou incluir para garantir)
function adicionarBolinhaPresenca(membro, presenca) {
    const container = membro.querySelector('.presenca-container');
    if (!container) return;
    
    // Verificar se j√° existe uma bolinha para esta data
    const bolinhasExistentes = container.querySelectorAll('.bolinha-presenca');
    let bolinhaExistente = null;
    
    bolinhasExistentes.forEach(bolinha => {
        if (bolinha.dataset.data === presenca.data) {
            bolinhaExistente = bolinha;
        }
    });
    
    if (bolinhaExistente) {
        // Atualizar bolinha existente
        bolinhaExistente.className = `bolinha-presenca ${presenca.status === 'presente' ? 'verde' : presenca.status === 'justificado' ? 'amarelo' : 'vermelho'}`;
        bolinhaExistente.dataset.data = presenca.data;
        bolinhaExistente.dataset.dataFormatada = presenca.dataFormatada;
        bolinhaExistente.dataset.local = presenca.local;
        bolinhaExistente.dataset.timestamp = presenca.timestamp;
        bolinhaExistente.dataset.status = presenca.status;
        bolinhaExistente.title = `${presenca.dataFormatada} - ${presenca.local}`;
    } else {
        // Criar nova bolinha
        const bolinha = document.createElement('div');
        bolinha.className = `bolinha-presenca ${presenca.status === 'presente' ? 'verde' : presenca.status === 'justificado' ? 'amarelo' : 'vermelho'}`;
        bolinha.dataset.data = presenca.data;
        bolinha.dataset.dataFormatada = presenca.dataFormatada;
        bolinha.dataset.local = presenca.local;
        bolinha.dataset.timestamp = presenca.timestamp;
        bolinha.dataset.status = presenca.status;
        bolinha.title = `${presenca.dataFormatada} - ${presenca.local}`;
        
        if(modoEdicao) {
            bolinha.onclick = function() { editarBolinhaPresenca(this); };
        }
        
        container.appendChild(bolinha);
    }
    
    // Manter apenas as 5 mais recentes
    const bolinhas = container.querySelectorAll('.bolinha-presenca');
    if(bolinhas.length > 5) {
        const bolinhasArray = Array.from(bolinhas);
        bolinhasArray.sort((a, b) => parseInt(b.dataset.timestamp) - parseInt(a.dataset.timestamp));
        
        for(let i = 5; i < bolinhasArray.length; i++) {
            bolinhasArray[i].remove();
        }
    }
}
    function encontrarMembroPorNome(nome) {
      let membroEncontrado = null;
      document.querySelectorAll('.membro-linha:not(.vazio)').forEach(membro => {
        const nomeMembro = membro.querySelector('.nome-membro')?.textContent || '';
        if(nomeMembro === nome) {
          membroEncontrado = membro;
        }
      });
      return membroEncontrado;
    }

    function adicionarBolinhaPresenca(membro, presenca) {
      const container = membro.querySelector('.presenca-container');
      
      const bolinha = document.createElement('div');
      bolinha.className = `bolinha-presenca ${presenca.status === 'presente' ? 'verde' : presenca.status === 'justificado' ? 'amarelo' : 'vermelho'}`;
      bolinha.dataset.data = presenca.data;
      bolinha.dataset.dataFormatada = presenca.dataFormatada;
      bolinha.dataset.local = presenca.local;
      bolinha.dataset.timestamp = presenca.timestamp;
      bolinha.dataset.status = presenca.status;
      bolinha.title = `${presenca.dataFormatada} - ${presenca.local}`;
      
      if(modoEdicao) {
        bolinha.onclick = function() { editarBolinhaPresenca(this); };
      }
      
      container.appendChild(bolinha);
      
      const bolinhas = container.querySelectorAll('.bolinha-presenca');
      if(bolinhas.length > 5) {
        const bolinhasArray = Array.from(bolinhas);
        bolinhasArray.sort((a, b) => parseInt(b.dataset.timestamp) - parseInt(a.dataset.timestamp));
        
        for(let i = 5; i < bolinhasArray.length; i++) {
          bolinhasArray[i].remove();
        }
      }
    }

    function abortarReuniao() {
    if(confirm('‚ùå Abortar esta reuni√£o?\n\n‚ö†Ô∏è ATEN√á√ÉO: Todos os registros de presen√ßa ser√£o perdidos!\n\nEsta a√ß√£o n√£o pode ser desfeita.')) {
        
        // Coletar estat√≠sticas antes de limpar (para o alerta final)
        const presencas = JSON.parse(localStorage.getItem('presencasReuniao') || '{}');
        const cadeirasPresentes = Object.keys(presencas).length;
        const totalCadeiras = calcularTotalCadeiras();
        
        let presencasDetalhadas = 0;
        document.querySelectorAll('#listaPresenca .bolinha-grande').forEach(bolinha => {
            if(bolinha.classList.contains('verde') || bolinha.classList.contains('amarelo') || bolinha.classList.contains('vermelho')) {
                presencasDetalhadas++;
            }
        });
        
        // 1. LIMPAR PRESEN√áAS TEMPOR√ÅRIAS DO LOCALSTORAGE
        localStorage.removeItem('presencasReuniao');
        
        // LIMPAR CONFIRMA√á√ïES
        if (reuniaoAtual && reuniaoAtual.timestamp) {
          const chaveConfirmacoes = `confirmacoes_${reuniaoAtual.timestamp}`;
          localStorage.removeItem(chaveConfirmacoes);
        }
        confirmacoesData = {};
        filtroAtualConfirmacoes = 'todos';
        
        // 2. LIMPAR VISUALMENTE TODAS AS BOLINHAS NA TELA
        document.querySelectorAll('#listaPresenca .bolinha-grande').forEach(bolinha => {
            bolinha.classList.remove('verde', 'amarelo', 'vermelho');
        });
        
        // 3. REMOVER INDICADOR DE QU√ìRUM SE EXISTIR
        const indicadorQuorum = document.getElementById('indicadorQuorum');
        if (indicadorQuorum) {
            indicadorQuorum.remove();
        }
        
        // 4. VOLTAR PARA TELA PRINCIPAL
        document.querySelectorAll('.tela').forEach(t => t.classList.remove('active'));
        document.getElementById('telaPrincipal').classList.add('active');
        
        // 5. LIMPAR VARI√ÅVEL DA REUNI√ÉO ATUAL
        reuniaoAtual = null;
        
        // 6. MOSTRAR CONFIRMA√á√ÉO COM ESTAT√çSTICAS
        let mensagemAborto = `‚úÖ REUNI√ÉO ABORTADA\n\n`;
        mensagemAborto += `üìä Dados descartados:\n`;
        mensagemAborto += `‚Ä¢ ${cadeirasPresentes} cadeiras com presen√ßa registrada\n`;
        mensagemAborto += `‚Ä¢ ${presencasDetalhadas} registros de presen√ßa individuais\n`;
        mensagemAborto += `‚Ä¢ Controle de qu√≥rum reiniciado\n\n`;
        mensagemAborto += `üí° Dica: Use "Modo Reuni√£o" no menu para iniciar uma nova reuni√£o.`;
        
        alert(mensagemAborto);
        
        // 7. ATUALIZAR CONTADORES SE NECESS√ÅRIO
        if(document.getElementById('telaAnalises').classList.contains('active')) {
            gerarAnalises();
        }
        
        // 8. FECHAR MENU SE ESTIVER ABERTO
        const menuDropdown = document.getElementById('menuDropdown');
        if (menuDropdown && menuDropdown.classList.contains('active')) {
            menuDropdown.classList.remove('active');
        }
        
        console.log('Reuni√£o abortada - todos os dados de presen√ßa foram descartados');
    } else {
        // Usu√°rio cancelou o aborto
        console.log('Aborto da reuni√£o cancelado pelo usu√°rio');
    }
}

// Fun√ß√£o auxiliar para garantir que o aborto seja completo
function abortarReuniaoForcado() {
    // Vers√£o sem confirma√ß√£o - para casos de emerg√™ncia
    console.warn('Aborto for√ßado da reuni√£o iniciado');
    
    // Limpar tudo
    localStorage.removeItem('presencasReuniao');
    
    document.querySelectorAll('#listaPresenca .bolinha-grande').forEach(bolinha => {
        bolinha.classList.remove('verde', 'amarelo', 'vermelho');
    });
    
    const indicadorQuorum = document.getElementById('indicadorQuorum');
    if (indicadorQuorum) indicadorQuorum.remove();
    
    document.querySelectorAll('.tela').forEach(t => t.classList.remove('active'));
    document.getElementById('telaPrincipal').classList.add('active');
    
    reuniaoAtual = null;
    
    alert('‚úÖ Reuni√£o abortada for√ßadamente!\n\nTodos os dados tempor√°rios foram limpos.');
}

    // ============================================
    // SISTEMA DE PRESEN√áAS CONFIRMADAS
    // ============================================

    function abrirPresencasConfirmadas() {
      if (!reuniaoAtual) {
        alert('‚ö†Ô∏è Nenhuma reuni√£o ativa!');
        return;
      }

      // Mudar para tela de confirma√ß√µes
      document.querySelectorAll('.tela').forEach(t => t.classList.remove('active'));
      document.getElementById('telaConfirmacoes').classList.add('active');

      // Atualizar informa√ß√µes da reuni√£o
      document.getElementById('dataReuniaoConfirmacoes').textContent = reuniaoAtual.dataFormatada;
      document.getElementById('localReuniaoConfirmacoes').textContent = reuniaoAtual.local;

      // Carregar lista de confirma√ß√µes
      carregarListaConfirmacoes();

      // Carregar dados salvos do localStorage
      carregarConfirmacoesLocalStorage();

      // Atualizar estat√≠sticas
      atualizarEstatisticasConfirmacoes();
    }

    function voltarParaPresenca() {
      document.querySelectorAll('.tela').forEach(t => t.classList.remove('active'));
      document.getElementById('telaPresenca').classList.add('active');
    }

    function carregarListaConfirmacoes() {
      const container = document.getElementById('listaConfirmacoes');
      container.innerHTML = '';

      const cadeiras = new Map();

      function coletarCadeiras(seletor, grupo) {
        document.querySelectorAll(seletor).forEach(cadeira => {
          const numeroCadeira = cadeira.querySelector('.numero-cadeira')?.textContent || '';
          const setorEl = cadeira.closest('.setor');
          const nomeSetor = setorEl?.querySelector('.titulo-setor .editable')?.textContent || '';

          const cadeiraId = `cadeira-${grupo}-${nomeSetor.replace(/\s+/g, '-')}-${numeroCadeira.replace(/\s+/g, '-')}`;

          const membrosCadeira = [];
          cadeira.querySelectorAll('.membro-linha:not(.vazio)').forEach(membro => {
            const nome = membro.querySelector('.nome-membro')?.textContent || '';
            const entidade = membro.querySelector('.entidade-membro')?.textContent || '';
            const municipio = membro.querySelector('.municipio-membro')?.textContent.replace('üìç ', '') || '';
            const telefone = membro.dataset.telefone || '';
            const email = membro.dataset.email || '';
            const boneco = membro.querySelector('.bonequinho')?.textContent || 'üë§';
            const tipo = membro.classList.contains('titular') ? 'Titular' : 'Suplente';

            if(nome && nome.trim() !== '' && nome !== 'VAGA' && nome !== '-') {
              membrosCadeira.push({
                nome, entidade, municipio, telefone, email, boneco, tipo,
                elemento: membro,
                setorNome: nomeSetor
              });
            }
          });

          if (membrosCadeira.length > 0) {
            cadeiras.set(cadeiraId, {
              id: cadeiraId,
              grupo: grupo,
              nomeSetor: nomeSetor,
              numeroCadeira: numeroCadeira,
              membros: membrosCadeira
            });
          }
        });
      }

      // Coletar da presid√™ncia
      const presidenciaContainer = document.getElementById('presidenciaContainer');
      if (presidenciaContainer) {
        const membrosPresidencia = [];
        presidenciaContainer.querySelectorAll('.membro-linha:not(.vazio)').forEach(membro => {
          const nome = membro.querySelector('.nome-membro')?.textContent || '';
          const entidade = membro.querySelector('.entidade-membro')?.textContent || '';
          const municipio = membro.querySelector('.municipio-membro')?.textContent.replace('üìç ', '') || '';
          const telefone = membro.dataset.telefone || '';
          const email = membro.dataset.email || '';
          const boneco = membro.querySelector('.bonequinho')?.textContent || 'üë§';
          const tipo = 'Presidente';

          if(nome && nome.trim() !== '' && nome !== 'VAGA' && nome !== '-') {
            membrosPresidencia.push({
              nome, entidade, municipio, telefone, email, boneco, tipo,
              elemento: membro
            });
          }
        });

        if (membrosPresidencia.length > 0) {
          cadeiras.set('presidencia', {
            id: 'presidencia',
            grupo: 'PRESID√äNCIA',
            nomeSetor: 'PRESID√äNCIA',
            numeroCadeira: 'PRESID√äNCIA',
            membros: membrosPresidencia
          });
        }
      }

      // Coletar cadeiras dos grupos
      coletarCadeiras('#grupoPublico .cadeira', 'Poder P√∫blico');
      coletarCadeiras('#grupoPrivado .cadeira', 'Sociedade Civil');

      // Renderizar todos os membros
      cadeiras.forEach(cadeira => {
        cadeira.membros.forEach((membro, idx) => {
          const membroId = `${cadeira.id}-${membro.tipo.toLowerCase().replace(/\s+/g, '_')}-${idx}`;
          renderizarItemConfirmacao(membro, membroId, cadeira);
        });
      });

      // Aplicar filtro atual
      aplicarFiltroAtual();
    }

    function renderizarItemConfirmacao(membro, membroId, cadeira) {
      const container = document.getElementById('listaConfirmacoes');

      const item = document.createElement('div');
      item.className = 'confirmacao-item';
      item.dataset.membroId = membroId;
      item.dataset.status = confirmacoesData[membroId]?.status || 'pendente';

      const statusAtual = confirmacoesData[membroId]?.status || 'pendente';
      const observacoesAtuais = confirmacoesData[membroId]?.observacoes || '';

      item.innerHTML = `
        <div class="confirmacao-header">
          <div class="confirmacao-status-bolinhas">
            <div class="bolinha-grande ${statusAtual === 'confirmado' ? 'verde' : ''} ${statusAtual === 'justificado' ? 'amarelo' : ''} ${statusAtual === 'nao_vai' ? 'vermelho' : ''}" 
                 onclick="alternarStatusConfirmacao('${membroId}')"></div>
          </div>
          <div class="confirmacao-info">
            <div class="confirmacao-nome">
              <span>${membro.boneco}</span>
              <span>${membro.nome}</span>
            </div>
            <div class="confirmacao-entidade">üè¢ ${membro.entidade || '-'}</div>
            <div class="confirmacao-contatos">
              ${membro.municipio ? `<div class="confirmacao-contato-item">üìç ${membro.municipio}</div>` : ''}
              ${membro.email ? `<div class="confirmacao-contato-item">üìß ${membro.email}</div>` : ''}
              ${membro.telefone ? `<div class="confirmacao-contato-item">üì± ${membro.telefone}</div>` : ''}
            </div>
          </div>
        </div>
        <div class="confirmacao-observacoes">
          <div class="confirmacao-obs-label">üìù Observa√ß√µes:</div>
          <textarea class="confirmacao-obs-textarea" 
                    placeholder="Ex: Ligou dia 03/12 confirmando presen√ßa..."
                    oninput="salvarObservacaoDebounce('${membroId}', this.value)">${observacoesAtuais}</textarea>
        </div>
      `;

      container.appendChild(item);
    }

    function alternarStatusConfirmacao(membroId) {
      const item = document.querySelector(`[data-membro-id="${membroId}"]`);
      if (!item) return;

      const statusAtual = item.dataset.status;
      let novoStatus = 'pendente';

      // Ciclo: pendente ‚Üí confirmado ‚Üí justificado ‚Üí nao_vai ‚Üí pendente
      switch (statusAtual) {
        case 'pendente':
          novoStatus = 'confirmado';
          break;
        case 'confirmado':
          novoStatus = 'justificado';
          break;
        case 'justificado':
          novoStatus = 'nao_vai';
          break;
        case 'nao_vai':
          novoStatus = 'pendente';
          break;
      }

      // Atualizar item
      item.dataset.status = novoStatus;

      // Atualizar bolinha
      const bolinha = item.querySelector('.bolinha-grande');
      bolinha.classList.remove('verde', 'amarelo', 'vermelho');
      if (novoStatus === 'confirmado') bolinha.classList.add('verde');
      else if (novoStatus === 'justificado') bolinha.classList.add('amarelo');
      else if (novoStatus === 'nao_vai') bolinha.classList.add('vermelho');

      // Salvar nos dados
      if (!confirmacoesData[membroId]) {
        confirmacoesData[membroId] = {};
      }
      confirmacoesData[membroId].status = novoStatus;
      confirmacoesData[membroId].timestamp = new Date().toISOString();

      // Salvar no localStorage
      salvarConfirmacoesLocalStorage();

      // Atualizar estat√≠sticas
      atualizarEstatisticasConfirmacoes();

      // Aplicar filtro se necess√°rio
      aplicarFiltroAtual();
    }

    function salvarObservacaoDebounce(membroId, valor) {
      // Limpar timer anterior se existir
      if (debounceTimers[membroId]) {
        clearTimeout(debounceTimers[membroId]);
      }

      // Criar novo timer
      debounceTimers[membroId] = setTimeout(() => {
        if (!confirmacoesData[membroId]) {
          confirmacoesData[membroId] = { status: 'pendente' };
        }
        confirmacoesData[membroId].observacoes = valor;
        confirmacoesData[membroId].timestamp = new Date().toISOString();

        salvarConfirmacoesLocalStorage();
      }, 500);
    }

    function atualizarEstatisticasConfirmacoes() {
      const items = document.querySelectorAll('.confirmacao-item');
      let confirmados = 0;
      let justificados = 0;
      let naoVao = 0;
      let pendentes = 0;

      items.forEach(item => {
        const status = item.dataset.status;
        switch (status) {
          case 'confirmado': confirmados++; break;
          case 'justificado': justificados++; break;
          case 'nao_vai': naoVao++; break;
          default: pendentes++; break;
        }
      });

      const total = items.length;
      const percentual = total > 0 ? Math.round((confirmados / total) * 100) : 0;

      document.getElementById('statConfirmados').textContent = confirmados;
      document.getElementById('statJustificados').textContent = justificados;
      document.getElementById('statNaoVao').textContent = naoVao;
      document.getElementById('statPendentes').textContent = pendentes;
      document.getElementById('totalConfirmacoes').textContent = `${confirmados} de ${total} confirmados (${percentual}%)`;
    }

    function filtrarConfirmacoes(filtro) {
      filtroAtualConfirmacoes = filtro;

      // Atualizar bot√µes
      document.querySelectorAll('.filtro-btn').forEach(btn => {
        btn.classList.remove('active');
        if (btn.dataset.filtro === filtro) {
          btn.classList.add('active');
        }
      });

      aplicarFiltroAtual();
    }

    function aplicarFiltroAtual() {
      const items = document.querySelectorAll('.confirmacao-item');

      items.forEach(item => {
        const status = item.dataset.status;

        if (filtroAtualConfirmacoes === 'todos') {
          item.style.display = 'block';
        } else {
          item.style.display = (status === filtroAtualConfirmacoes) ? 'block' : 'none';
        }
      });
    }

    function salvarConfirmacoesLocalStorage() {
      if (!reuniaoAtual) return;

      const chave = `confirmacoes_${reuniaoAtual.timestamp}`;
      localStorage.setItem(chave, JSON.stringify(confirmacoesData));
    }

    function carregarConfirmacoesLocalStorage() {
      if (!reuniaoAtual) return;

      const chave = `confirmacoes_${reuniaoAtual.timestamp}`;
      const dados = localStorage.getItem(chave);

      if (dados) {
        confirmacoesData = JSON.parse(dados);

        // Aplicar dados carregados
        Object.keys(confirmacoesData).forEach(membroId => {
          const item = document.querySelector(`[data-membro-id="${membroId}"]`);
          if (item) {
            const dados = confirmacoesData[membroId];
            item.dataset.status = dados.status || 'pendente';

            const bolinha = item.querySelector('.bolinha-grande');
            bolinha.classList.remove('verde', 'amarelo', 'vermelho');
            if (dados.status === 'confirmado') bolinha.classList.add('verde');
            else if (dados.status === 'justificado') bolinha.classList.add('amarelo');
            else if (dados.status === 'nao_vai') bolinha.classList.add('vermelho');

            const textarea = item.querySelector('.confirmacao-obs-textarea');
            if (textarea && dados.observacoes) {
              textarea.value = dados.observacoes;
            }
          }
        });

        atualizarEstatisticasConfirmacoes();
      }
    }

    function gerarPDFConfirmacoes() {
      if (!window.jspdf || !window.jspdf.jsPDF) {
        alert('‚ö†Ô∏è Biblioteca jsPDF n√£o carregada.\n\nPoss√≠veis causas:\n- Sem conex√£o com internet\n- Bloqueio por extens√£o do navegador\n- Bloqueio por pol√≠tica de seguran√ßa (CSP)');
        return;
      }

      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();

      // Cabe√ßalho
      doc.setFontSize(18);
      doc.setFont(undefined, 'bold');
      doc.text('Lista de Confirma√ß√µes de Presen√ßa', 105, 20, { align: 'center' });

      // Subt√≠tulo com informa√ß√µes da reuni√£o
      doc.setFontSize(12);
      doc.setFont(undefined, 'normal');
      doc.text(`Reuni√£o: ${reuniaoAtual.dataFormatada} - ${reuniaoAtual.local}`, 105, 30, { align: 'center' });

      // Estat√≠sticas
      const items = document.querySelectorAll('.confirmacao-item');
      let confirmados = 0, justificados = 0, naoVao = 0, pendentes = 0;

      items.forEach(item => {
        const status = item.dataset.status;
        switch (status) {
          case 'confirmado': confirmados++; break;
          case 'justificado': justificados++; break;
          case 'nao_vai': naoVao++; break;
          default: pendentes++; break;
        }
      });

      doc.setFontSize(10);
      doc.text(`Total: ${confirmados} Confirmados | ${justificados} Justificaram | ${naoVao} N√£o v√£o | ${pendentes} Pendentes`, 105, 38, { align: 'center' });

      // Lista de membros
      const PDF_PAGE_HEIGHT_LIMIT = 270; // Limite para quebra de p√°gina
      let y = 50;
      doc.setFontSize(9);

      items.forEach(item => {
        const nome = item.querySelector('.confirmacao-nome')?.textContent.trim() || '';
        const entidade = item.querySelector('.confirmacao-entidade')?.textContent.replace('üè¢ ', '') || '';
        const contatos = Array.from(item.querySelectorAll('.confirmacao-contato-item')).map(c => c.textContent).join(' | ');
        const observacoes = item.querySelector('.confirmacao-obs-textarea')?.value || '';
        const status = item.dataset.status;

        let statusTexto = '‚è≥ Pendente';
        if (status === 'confirmado') statusTexto = '‚úÖ Confirmado';
        else if (status === 'justificado') statusTexto = '‚ö†Ô∏è Justificou';
        else if (status === 'nao_vai') statusTexto = '‚ùå N√£o vai';

        // Verificar se precisa de nova p√°gina
        if (y > PDF_PAGE_HEIGHT_LIMIT) {
          doc.addPage();
          y = 20;
        }

        doc.setFont(undefined, 'bold');
        doc.text(nome, 10, y);
        doc.setFont(undefined, 'normal');
        y += 5;
        doc.text(`${entidade}`, 10, y);
        y += 5;
        if (contatos) {
          doc.text(contatos, 10, y);
          y += 5;
        }
        doc.text(`Status: ${statusTexto}`, 10, y);
        y += 5;

        if (observacoes) {
          const linhasObs = doc.splitTextToSize(`Obs: ${observacoes}`, 190);
          linhasObs.forEach(linha => {
            if (y > PDF_PAGE_HEIGHT_LIMIT) {
              doc.addPage();
              y = 20;
            }
            doc.text(linha, 10, y);
            y += 5;
          });
        }

        y += 3; // Espa√ßo entre membros
      });

      // Rodap√©
      const agora = new Date();
      const dataHora = `${agora.toLocaleDateString('pt-BR')} √†s ${agora.toLocaleTimeString('pt-BR')}`;
      doc.setFontSize(8);
      doc.text(`Gerado em: ${dataHora}`, 105, 290, { align: 'center' });

      // Salvar PDF
      const nomeArquivo = `confirmacoes_${reuniaoAtual.data.replace(/-/g, '_')}.pdf`;
      doc.save(nomeArquivo);

      alert(`‚úÖ PDF gerado: ${nomeArquivo}`);
    }

    // ============================================
    // EDI√á√ÉO DE BOLINHAS NO MODO EDI√á√ÉO
    // ============================================

    function editarBolinhaPresenca(bolinha) {
      if(!modoEdicao) return;
      
      bolinhaEditando = bolinha;
      
      document.getElementById('inputEditarDataReuniao').value = bolinha.dataset.data;
      document.getElementById('inputEditarLocalReuniao').value = bolinha.dataset.local;
      
      document.getElementById('btnStatusVerde').classList.remove('selecionado');
      document.getElementById('btnStatusAmarelo').classList.remove('selecionado');
      document.getElementById('btnStatusVermelho').classList.remove('selecionado');
      
      const statusAtual = bolinha.dataset.status;
      if(statusAtual === 'presente') {
        document.getElementById('btnStatusVerde').classList.add('selecionado');
      } else if(statusAtual === 'justificado') {
        document.getElementById('btnStatusAmarelo').classList.add('selecionado');
      } else if(statusAtual === 'faltou') {
        document.getElementById('btnStatusVermelho').classList.add('selecionado');
      }
      
      document.getElementById('modalEditarBolinha').classList.add('active');
    }

    function selecionarStatusBolinha(status) {
      document.getElementById('btnStatusVerde').classList.remove('selecionado');
      document.getElementById('btnStatusAmarelo').classList.remove('selecionado');
      document.getElementById('btnStatusVermelho').classList.remove('selecionado');
      
      document.getElementById(`btnStatus${status.charAt(0).toUpperCase() + status.slice(1)}`).classList.add('selecionado');
    }

    function salvarEdicaoBolinha() {
      if(!bolinhaEditando) return;
      
      const novaData = document.getElementById('inputEditarDataReuniao').value;
      const novoLocal = document.getElementById('inputEditarLocalReuniao').value;
      
      if(!novaData || !novoLocal) {
        alert('‚ö†Ô∏è Preencha data e local!');
        return;
      }
      
      let novoStatus = '';
      if(document.getElementById('btnStatusVerde').classList.contains('selecionado')) {
        novoStatus = 'presente';
      } else if(document.getElementById('btnStatusAmarelo').classList.contains('selecionado')) {
        novoStatus = 'justificado';
      } else if(document.getElementById('btnStatusVermelho').classList.contains('selecionado')) {
        novoStatus = 'faltou';
      }
      
      if(!novoStatus) {
        alert('‚ö†Ô∏è Selecione um status!');
        return;
      }
      
      // CORRE√á√ÉO DE TIMEZONE: Usar formata√ß√£o sem convers√£o UTC
      const dataFormatada = formatarDataSemTimezone(novaData);
      
      bolinhaEditando.dataset.data = novaData;
      bolinhaEditando.dataset.dataFormatada = dataFormatada;
      bolinhaEditando.dataset.local = novoLocal;
      bolinhaEditando.dataset.status = novoStatus;
      bolinhaEditando.title = `${dataFormatada} - ${novoLocal}`;
      
      bolinhaEditando.className = 'bolinha-presenca';
      bolinhaEditando.classList.add(novoStatus === 'presente' ? 'verde' : novoStatus === 'justificado' ? 'amarelo' : 'vermelho');
      
      fecharModal('modalEditarBolinha');
      bolinhaEditando = null;
      alert('‚úÖ Presen√ßa atualizada!');
    }

    function excluirBolinha() {
      if(!bolinhaEditando) return;
      
      if(confirm('üóëÔ∏è Excluir este registro de presen√ßa?')) {
        bolinhaEditando.remove();
        fecharModal('modalEditarBolinha');
        bolinhaEditando = null;
        alert('‚úÖ Presen√ßa exclu√≠da!');
      }
    }

    // ============================================
    // MODAL
    // ============================================
    function abrirModal(idModal) {
      document.getElementById(idModal).classList.add('active');
    }

    function fecharModal(idModal) {
      document.getElementById(idModal).classList.remove('active');
    }

    document.addEventListener('click', (e) => {
      if(e.target.classList.contains('modal')) {
        e.target.classList.remove('active');
      }
    });

    // ============================================
    // SETORES E CADEIRAS
    // ============================================
    function adicionarSetor(grupoId) {
      if(!modoEdicao) {
        alert('‚ö†Ô∏è Ative o modo de edi√ß√£o primeiro!');
        return;
      }

      const nomeSetor = prompt('üìù Digite o nome do novo setor:');
      if(!nomeSetor) return;

      const grupo = document.getElementById(grupoId);
      const setor = document.createElement('div');
      setor.className = 'setor';
      setor.innerHTML = `
        <div class="setor-header-wrapper" onclick="toggleSetor(this)">
          <div class="setor-seta">‚ñº</div>
          <div class="titulo-setor">
            <span class="editable" contenteditable="true">${nomeSetor}</span>
            <span class="contador-cadeiras">0 cadeiras</span>
            <button class="btn-remove" onclick="event.stopPropagation(); removerSetor(this)">üóëÔ∏è</button>
          </div>
        </div>
        <div class="setor-conteudo active">
          <button class="btn-add-cadeira" onclick="adicionarCadeira(this)">‚ûï Cadeira</button>
        </div>
      `;
      
      const btnAddSetor = grupo.querySelector('.btn-add-setor');
      const conteudoGrupo = grupo.querySelector('.grupo-conteudo');
      conteudoGrupo.insertBefore(setor, btnAddSetor);
      
      alert(`‚úÖ Setor "${nomeSetor}" criado!`);
      atualizarContadoresGrupo(grupoId);
    }

    function removerSetor(btn) {
      if(!modoEdicao) return;
      
      if(confirm('‚ùì Remover este setor e todas as suas cadeiras?')) {
        const setor = btn.closest('.setor');
        const grupoId = setor.closest('.grupo').id;
        setor.remove();
        alert('‚úÖ Setor removido!');
        atualizarContadoresGrupo(grupoId);
      }
    }

    function adicionarCadeira(btn) {
      if(!modoEdicao) {
        alert('‚ö†Ô∏è Ative o modo de edi√ß√£o primeiro!');
        return;
      }
      
      const setor = btn.closest('.setor');
      if(!setor) {
        alert('‚ùå Erro: setor n√£o encontrado!');
        return;
      }
      
      const grupo = setor.closest('.grupo');
      const grupoId = grupo ? grupo.id : '';
      const isPoderPublico = grupoId === 'poder-publico';
      
      const cadeiraExistentes = setor.querySelectorAll('.cadeira');
      
      // Se for poder p√∫blico, come√ßar da Cadeira 2 (Cadeira 1 = Presidente)
      let numCadeiraAtual;
      if (isPoderPublico) {
        numCadeiraAtual = cadeiraExistentes.length + 2;
      } else {
        numCadeiraAtual = cadeiraExistentes.length + 1;
      }
      
      const numeroCadeira = prompt(
        `üìù Digite o n√∫mero/nome da nova cadeira:\n\n` +
        `Cadeiras existentes: ${cadeiraExistentes.length}`,
        `Cadeira ${numCadeiraAtual}`
      );
      
      if(!numeroCadeira) return;
      
      const cadeira = document.createElement('div');
      cadeira.className = 'cadeira';
      cadeira.innerHTML = `
        <div class="cadeira-header">
          <span class="icone-cadeira">ü™ë</span>
          <span class="numero-cadeira">${numeroCadeira}</span>
          <button class="btn-remove" onclick="removerCadeira(this)">üóëÔ∏è</button>
        </div>
        <div class="cadeira-membros-container"></div>
        <button class="btn-add-membro" onclick="abrirModalAdicionarMembro(this)">‚ûï Adicionar Membro</button>
      `;
      
      const btnAddCadeiraSetor = setor.querySelector('.btn-add-cadeira');
      const setorConteudo = setor.querySelector('.setor-conteudo');
      setorConteudo.insertBefore(cadeira, btnAddCadeiraSetor);
      
      atualizarContadorCadeiras(setor);
      
      alert(`‚úÖ "${numeroCadeira}" criada!\n\nüë• Agora adicione membros.`);
    }

    function removerCadeira(btn) {
      if(!modoEdicao) return;
      
      if(confirm('‚ùì Remover esta cadeira?')) {
        const setor = btn.closest('.setor');
        btn.closest('.cadeira').remove();
        atualizarContadorCadeiras(setor);
        alert('‚úÖ Cadeira removida!');
      }
    }

    // ============================================
    // ADICIONAR MEMBRO
    // ============================================
    function abrirModalAdicionarMembroPresidencia() {
      if(!modoEdicao) {
        alert('‚ö†Ô∏è Ative o modo de edi√ß√£o primeiro!');
        return;
      }
      cadeiraAtualAdicionarMembro = document.getElementById('presidenciaContainer');
      membroAtualEditando = null;
      limparCamposModalMembro();
      document.getElementById('modalAdicionarMembro').classList.add('active');
    }

    function abrirModalAdicionarMembro(btn) {
      if(!modoEdicao) {
        alert('‚ö†Ô∏è Ative o modo de edi√ß√£o primeiro!');
        return;
      }
      
      const cadeira = btn.closest('.cadeira');
      cadeiraAtualAdicionarMembro = cadeira.querySelector('.cadeira-membros-container');
      membroAtualEditando = null;
      limparCamposModalMembro();
      document.getElementById('modalAdicionarMembro').classList.add('active');
    }

    function limparCamposModalMembro() {
      document.getElementById('inputNomeMembro').value = '';
      document.getElementById('inputEntidadeMembro').value = '';
      document.getElementById('inputMunicipioMembro').value = '';
      document.getElementById('inputEstadoMembro').value = '';
      document.getElementById('inputTelefoneMembro').value = '';
      document.getElementById('inputEmailMembro').value = '';
      document.getElementById('inputCurriculoMembro').value = '';
      document.getElementById('inputDataPosseMembro').value = '';
      document.getElementById('inputDataMandatoMembro').value = '';
      document.getElementById('inputTipoMembro').value = 'titular';
    }

    function confirmarAdicionarMembro() {
      const nome = document.getElementById('inputNomeMembro').value;
      const entidade = document.getElementById('inputEntidadeMembro').value;
      const municipio = document.getElementById('inputMunicipioMembro').value;
      const estado = document.getElementById('inputEstadoMembro').value;
      const telefone = document.getElementById('inputTelefoneMembro').value;
      const email = document.getElementById('inputEmailMembro').value;
      const curriculo = document.getElementById('inputCurriculoMembro').value;
      const dataPosse = document.getElementById('inputDataPosseMembro').value;
      const dataMandato = document.getElementById('inputDataMandatoMembro').value;
      const tipo = document.getElementById('inputTipoMembro').value;

      if(!nome || !estado) {
        alert('‚ö†Ô∏è Preencha pelo menos o nome e o estado!');
        return;
      }

      if(membroAtualEditando) {
        membroAtualEditando.querySelector('.nome-membro').textContent = nome;
        membroAtualEditando.querySelector('.entidade-membro').textContent = entidade || '-';
        membroAtualEditando.querySelector('.municipio-membro').textContent = `üìç ${municipio || '-'}`;
        membroAtualEditando.dataset.estado = estado;
        membroAtualEditando.dataset.telefone = telefone;
        membroAtualEditando.dataset.email = email;
        membroAtualEditando.dataset.curriculo = curriculo;
        membroAtualEditando.dataset.dataPosse = dataPosse;
        membroAtualEditando.dataset.dataMandato = dataMandato;
        
        membroAtualEditando.className = `membro-linha ${tipo}`;
        membroAtualEditando.querySelector('.etiqueta-cargo').className = `etiqueta-cargo ${tipo}`;
        membroAtualEditando.querySelector('.etiqueta-cargo').textContent = tipo === 'titular' ? 'Titular' : 'Suplente';
        
        fecharModal('modalAdicionarMembro');
        membroAtualEditando = null;
        alert(`‚úÖ Membro "${nome}" atualizado com sucesso!`);
        return;
      }

      const membro = document.createElement('div');
      membro.className = `membro-linha ${tipo}`;
      membro.draggable = true;
      membro.dataset.id = `membro-${Date.now()}`;
      membro.dataset.estado = estado;
      membro.dataset.curriculo = curriculo;
      membro.dataset.telefone = telefone;
      membro.dataset.email = email;
      membro.dataset.dataPosse = dataPosse;
      membro.dataset.dataMandato = dataMandato;

      membro.innerHTML = `
        <div class="membro-linha-top" onclick="editarMembroCompleto(this)">
          <div class="avatar-container">
            <span class="bonequinho" onclick="event.stopPropagation(); abrirEscolherEmoji(this, 'pessoa')">üë§</span>
            <span class="logo-instituicao" onclick="event.stopPropagation(); abrirEscolherEmoji(this, 'logo')">üèõÔ∏è</span>
          </div>
          <span class="etiqueta-cargo ${tipo}">${tipo === 'titular' ? 'Titular' : 'Suplente'}</span>
          <div class="info-membro">
            <div class="nome-membro">${nome}</div>
            <div class="entidade-membro">${entidade || '-'}</div>
            <div class="municipio-membro">üìç ${municipio || '-'}</div>
            <button class="btn-ver-curriculo" onclick="event.stopPropagation(); verEditarCurriculo(this)"></button>
          </div>
        </div>
        <div class="presenca-container">
          <span class="presenca-label">Presen√ßas:</span>
        </div>
        <button class="btn-remove" onclick="removerMembro(this)" style="margin-top:5px;">üóëÔ∏è Remover</button>
      `;

      if(cadeiraAtualAdicionarMembro) {
        cadeiraAtualAdicionarMembro.appendChild(membro);
      }

      configurarDragAndDrop();
      fecharModal('modalAdicionarMembro');
      alert(`‚úÖ ${tipo} "${nome}" adicionado com sucesso!`);
    }

    function removerMembro(btn) {
      if(!modoEdicao) return;
      
      if(confirm('‚ùì Remover este membro?')) {
        btn.closest('.membro-linha').remove();
        alert('‚úÖ Membro removido!');
      }
    }

    function editarMembroCompleto(elementoClicado) {
      if(!modoEdicao) return;
      
      const membroLinha = elementoClicado.closest('.membro-linha');
      
      document.getElementById('inputNomeMembro').value = membroLinha.querySelector('.nome-membro')?.textContent || '';
      document.getElementById('inputEntidadeMembro').value = membroLinha.querySelector('.entidade-membro')?.textContent.replace('-', '').trim() || '';
      document.getElementById('inputMunicipioMembro').value = membroLinha.querySelector('.municipio-membro')?.textContent.replace('üìç', '').trim() || '';
      document.getElementById('inputEstadoMembro').value = membroLinha.dataset.estado || '';
      document.getElementById('inputTelefoneMembro').value = membroLinha.dataset.telefone || '';
      document.getElementById('inputEmailMembro').value = membroLinha.dataset.email || '';
      document.getElementById('inputCurriculoMembro').value = membroLinha.dataset.curriculo || '';
      document.getElementById('inputDataPosseMembro').value = membroLinha.dataset.dataPosse || '';
      document.getElementById('inputDataMandatoMembro').value = membroLinha.dataset.dataMandato || '';
      document.getElementById('inputTipoMembro').value = membroLinha.classList.contains('titular') ? 'titular' : 'suplente';
      
      membroAtualEditando = membroLinha;
      
      document.getElementById('modalAdicionarMembro').classList.add('active');
    }

    // ============================================
    // EMOJI E FOTO
    // ============================================
    function abrirEscolherEmoji(elemento, tipo) {
      if(!modoEdicao) {
        mostrarFichaMembro(elemento);
        return;
      }
      
      elementoEmojiAtual = elemento;
      tipoEmojiAtual = tipo;
      
      document.getElementById('tipoEmojiTitulo').textContent = tipo === 'pessoa' ? 'Pessoa' : 'Logo/Institui√ß√£o';
      document.getElementById('modalEscolherEmoji').classList.add('active');
    }

    function selecionarEmoji(emoji) {
      if (emojiContext === 'camara') {
          document.getElementById('inputEmojiCamara').value = emoji;
          atualizarPreviewEmoji();
          fecharModal('modalEscolherEmoji');
          emojiContext = null;
      } else {
          if (elementoEmojiAtual) {
              elementoEmojiAtual.textContent = emoji;
              fecharModal('modalEscolherEmoji');
          }
      }
    }

    function uploadFotoEmoji() {
      const input = document.getElementById('inputFotoEmoji');
      const file = input.files[0];
      
      if(!file) {
        alert('‚ö†Ô∏è Selecione uma imagem primeiro!');
        return;
      }
      
      const reader = new FileReader();
      reader.onload = function(e) {
        if(elementoEmojiAtual) {
          elementoEmojiAtual.innerHTML = `<img src="${e.target.result}" alt="foto">`;
          fecharModal('modalEscolherEmoji');
        }
      };
      reader.readAsDataURL(file);
    }

    // ============================================
    // CURR√çCULO
    // ============================================
    function verEditarCurriculo(btn) {
      const membroLinha = btn.closest('.membro-linha');
      const curriculo = membroLinha.dataset.curriculo || '';
      const nome = membroLinha.querySelector('.nome-membro')?.textContent || 'Membro';
      
      document.getElementById('tituloModalCurriculo').textContent = `üìÑ Curr√≠culo - ${nome}`;
      document.getElementById('curriculoConteudo').value = curriculo;
      
      if(modoEdicao) {
        document.getElementById('curriculoConteudo').readOnly = false;
        document.getElementById('btnSalvarCurriculo').style.display = 'inline-block';
        document.getElementById('btnSalvarCurriculo').onclick = function() {
          salvarCurriculo(membroLinha);
        };
      } else {
        document.getElementById('curriculoConteudo').readOnly = true;
        document.getElementById('btnSalvarCurriculo').style.display = 'none';
      }
      
      document.getElementById('modalVerEditarCurriculo').classList.add('active');
    }

    function salvarCurriculo(membroLinha) {
      const novoConteudo = document.getElementById('curriculoConteudo').value;
      membroLinha.dataset.curriculo = novoConteudo;
      fecharModal('modalVerEditarCurriculo');
      alert('‚úÖ Curr√≠culo salvo com sucesso!');
    }

    // ============================================
    // FICHA DO MEMBRO
    // ============================================
    function mostrarFichaMembro(elementoBoneco) {
      const membroLinha = elementoBoneco.closest('.membro-linha');
      
      const nome = membroLinha.querySelector('.nome-membro')?.textContent || 'N√£o informado';
      const entidade = membroLinha.querySelector('.entidade-membro')?.textContent || 'N√£o informado';
      const municipio = membroLinha.querySelector('.municipio-membro')?.textContent.replace('üìç ', '') || 'N√£o informado';
      const boneco = membroLinha.querySelector('.bonequinho')?.innerHTML || 'üë§';
      const tipo = membroLinha.classList.contains('titular') ? 'Titular' : 'Suplente';
      const estado = membroLinha.dataset.estado || 'N√£o informado';
      const telefone = membroLinha.dataset.telefone || 'N√£o informado';
      const email = membroLinha.dataset.email || 'N√£o informado';
      const curriculo = membroLinha.dataset.curriculo || 'N√£o informado';
      
      const dataPosse = membroLinha.dataset.dataPosse || '';
      const dataMandato = membroLinha.dataset.dataMandato || '';
      
      // CORRE√á√ÉO DE TIMEZONE: Usar formata√ß√£o sem convers√£o UTC
      const dataPosseFormatada = dataPosse ? formatarDataSemTimezone(dataPosse) : 'N√£o informada';
      const dataMandatoFormatada = dataMandato ? formatarDataSemTimezone(dataMandato) : 'N√£o informada';
      
      let diasRestantes = 'N√£o informado';
      if (dataMandato) {
        const hoje = new Date();
        // CORRE√á√ÉO DE TIMEZONE: Criar data local ao inv√©s de UTC
        const termino = criarDataLocal(dataMandato);
        const diffTime = termino - hoje;
        const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
        diasRestantes = diffDays > 0 ? `${diffDays} dias` : 'Expirado';
      }

      const bolinhas = membroLinha.querySelectorAll('.bolinha-presenca');
      let presencas = 0, justificadas = 0, faltas = 0;
      
      bolinhas.forEach(b => {
        if(b.classList.contains('verde')) presencas++;
        else if(b.classList.contains('amarelo')) justificadas++;
        else if(b.classList.contains('vermelho')) faltas++;
      });
      
      const fichaHTML = `
        <div class="modal-content" style="max-width: 500px;">
          <div class="modal-header">üë§ Ficha do Conselheiro</div>
          
          <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 20px; padding: 15px; background: #f8f9fa; border-radius: 10px;">
            <div style="font-size: 4em;">${boneco}</div>
            <div style="flex: 1;">
              <div style="font-size: 1.4em; font-weight: bold; color: #2c3e50;">${nome}</div>
              <div style="font-size: 1em; color: #495057;">${entidade}</div>
              <div style="display: inline-block; background: ${tipo === 'Titular' ? '#1976d2' : '#f57c00'}; color: white; padding: 4px 12px; border-radius: 15px; font-size: 0.8em; margin-top: 5px;">
                ${tipo}
              </div>
            </div>
          </div>
          
          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 20px;">
            <div style="padding: 12px; background: white; border-radius: 8px; border-left: 4px solid #667eea;">
              <div style="font-size: 0.8em; color: #6c757d; margin-bottom: 4px;">üìç Localiza√ß√£o</div>
              <div style="font-weight: bold; color: #2c3e50;">${municipio}</div>
              <div style="font-size: 0.8em; color: #495057;">${estado}</div>
            </div>
            
            <div style="padding: 12px; background: white; border-radius: 8px; border-left: 4px solid #51cf66;">
              <div style="font-size: 0.8em; color: #6c757d; margin-bottom: 4px;">üìä Presen√ßas</div>
              <div style="display: flex; gap: 8px; font-size: 0.9em;">
                <span>üü¢ ${presencas}</span>
                <span>üü° ${justificadas}</span>
                <span>üî¥ ${faltas}</span>
              </div>
            </div>
          </div>
          
          <div style="margin-bottom: 20px;">
            <div style="font-weight: bold; color: #495057; margin-bottom: 8px;">üìÖ Mandato</div>
            <div style="background: white; padding: 12px; border-radius: 8px;">
              <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                <div>
                  <div style="font-size: 0.8em; color: #6c757d;">Data da Posse</div>
                  <div style="font-weight: bold; color: #2c3e50;">${dataPosseFormatada}</div>
                </div>
                <div>
                  <div style="font-size: 0.8em; color: #6c757d;">T√©rmino do Mandato</div>
                  <div style="font-weight: bold; color: #2c3e50;">${dataMandatoFormatada}</div>
                </div>
              </div>
              ${dataMandato ? `
                <div style="margin-top: 10px; padding: 8px; background: ${diasRestantes.includes('Expirado') ? '#ff6b6b' : '#51cf66'}; color: white; border-radius: 5px; text-align: center; font-size: 0.9em;">
                  ‚è≥ ${diasRestantes.includes('Expirado') ? 'Mandato Expirado' : `${diasRestantes} restantes`}
                </div>
              ` : ''}
            </div>
          </div>
          
          <div style="margin-bottom: 20px;">
            <div style="font-weight: bold; color: #495057; margin-bottom: 8px;">üìû Contato</div>
            <div style="background: white; padding: 12px; border-radius: 8px;">
              <div style="margin-bottom: 6px;"><strong>Telefone:</strong> ${telefone}</div>
              <div><strong>E-mail:</strong> ${email}</div>
            </div>
          </div>
          
          <div style="margin-bottom: 20px;">
            <div style="font-weight: bold; color: #495057; margin-bottom: 8px;">üìÑ Curr√≠culo</div>
            <div style="background: white; padding: 12px; border-radius: 8px; max-height: 150px; overflow-y: auto;">
              ${curriculo || '<em style="color: #6c757d;">Nenhum curr√≠culo cadastrado</em>'}
            </div>
          </div>
          
          <div style="display: flex; gap: 10px;">
            <button class="modal-btn modal-btn-primary" onclick="verEditarCurriculoCompleto(this)" style="flex: 1;">üìÑ Ver Curr√≠culo Completo</button>
            <button class="modal-btn modal-btn-secondary" onclick="fecharModal('modalFichaMembro')" style="flex: 1;">‚úÖ Fechar</button>
          </div>
        </div>
      `;
      
      let modalFicha = document.getElementById('modalFichaMembro');
      if (!modalFicha) {
        modalFicha = document.createElement('div');
        modalFicha.id = 'modalFichaMembro';
        modalFicha.className = 'modal';
        modalFicha.onclick = function(e) {
          if (e.target === modalFicha) fecharModal('modalFichaMembro');
        };
        document.body.appendChild(modalFicha);
      }
      
      modalFicha.innerHTML = fichaHTML;
      
      const botaoCurriculo = modalFicha.querySelector('.modal-btn-primary');
      botaoCurriculo.membroRef = membroLinha;
      
      modalFicha.classList.add('active');
    }

    function verEditarCurriculoCompleto(botao) {
      const membroLinha = botao.membroRef;
      fecharModal('modalFichaMembro');
      verEditarCurriculo(membroLinha.querySelector('.btn-ver-curriculo'));
    }

    // ============================================
    // DRAG AND DROP
    // ============================================
    function configurarDragAndDrop() {
      const membros = document.querySelectorAll('.membro-linha[draggable="true"]');
      const camaras = document.querySelectorAll('.camara');
      
      // Drag & drop para membros nas c√¢maras (funcionalidade existente)
      membros.forEach(membro => {
        membro.addEventListener('dragstart', handleDragStart);
        membro.addEventListener('dragend', handleDragEnd);
      });
      
      camaras.forEach(camara => {
        camara.addEventListener('dragover', handleDragOver);
        camara.addEventListener('drop', handleDrop);
        camara.addEventListener('dragleave', handleDragLeave);
      });
      
      // Configurar drag & drop para cadeiras (subpastas)
      configurarDragDropCadeiras();
      
      // Configurar drag & drop para membros dentro de cadeiras
      configurarDragDropMembros();
    }

    let membroArrastado = null;

    function handleDragStart(e) {
      if(!modoEdicao) {
        e.preventDefault();
        return;
      }
      membroArrastado = this;
      this.classList.add('dragging');
      e.dataTransfer.effectAllowed = 'move';
    }

    function handleDragEnd(e) {
      this.classList.remove('dragging');
    }

    function handleDragOver(e) {
      if(!modoEdicao) return;
      e.preventDefault();
      e.dataTransfer.dropEffect = 'move';
      this.classList.add('drag-over');
    }

    function handleDragLeave(e) {
      this.classList.remove('drag-over');
    }

    function handleDrop(e) {
      if(!modoEdicao) return;
      e.preventDefault();
      this.classList.remove('drag-over');
      
      if(!membroArrastado) return;
      
      const nomeMembro = membroArrastado.querySelector('.nome-membro')?.textContent || 'Membro';
      const boneco = membroArrastado.querySelector('.bonequinho')?.textContent || 'üë§';
      const nomeCamara = this.querySelector('.camara-nome')?.textContent || 'C√¢mara';
      
      if(confirm(`‚ûï Adicionar "${nomeMembro}" √† c√¢mara "${nomeCamara}"?`)) {
        const camaraMembros = this.querySelector('.camara-membros');
        
        const jaExiste = Array.from(camaraMembros.querySelectorAll('.camara-membro')).some(m => 
          m.querySelector('.nome-membro')?.textContent === nomeMembro
        );
        
        if(jaExiste) {
          alert('‚ö†Ô∏è Este membro j√° est√° nesta c√¢mara!');
          return;
        }
        
        const membroCamara = document.createElement('div');
        membroCamara.className = 'camara-membro';
        membroCamara.innerHTML = `
          <span class="bonequinho">${boneco}</span>
          <div class="nome-membro">${nomeMembro}</div>
          <button class="btn-remove" onclick="removerMembroCamara(this)">üóëÔ∏è</button>
        `;
        
        camaraMembros.appendChild(membroCamara);
        atualizarContadorCamara(this);
        
        alert(`‚úÖ "${nomeMembro}" adicionado √† c√¢mara "${nomeCamara}"!`);
      }
    }

    function removerMembroCamara(btn) {
      if(!modoEdicao) return;
      
      if(confirm('‚ùì Remover este membro da c√¢mara?')) {
        const camara = btn.closest('.camara');
        btn.closest('.camara-membro').remove();
        atualizarContadorCamara(camara);
      }
    }

    // ============================================
    // DRAG & DROP PARA CADEIRAS E MEMBROS
    // ============================================
    let cadeiraArrastada = null;
    let membroArrastadoDentro = null;
    
    function configurarDragDropCadeiras() {
      if (!modoEdicao) return;
      
      const cadeiras = document.querySelectorAll('.cadeira');
      cadeiras.forEach(cadeira => {
        cadeira.draggable = true;
        cadeira.style.cursor = 'move';
        
        cadeira.addEventListener('dragstart', handleDragStartCadeira);
        cadeira.addEventListener('dragend', handleDragEndCadeira);
        cadeira.addEventListener('dragover', handleDragOverCadeira);
        cadeira.addEventListener('drop', handleDropCadeira);
      });
    }
    
    function handleDragStartCadeira(e) {
      if (!modoEdicao) {
        e.preventDefault();
        return;
      }
      cadeiraArrastada = this;
      this.style.opacity = '0.5';
      e.dataTransfer.effectAllowed = 'move';
      e.dataTransfer.setData('text/html', this.innerHTML);
      e.stopPropagation();
    }
    
    function handleDragEndCadeira(e) {
      this.style.opacity = '1';
      
      // Remover todos os indicadores visuais
      document.querySelectorAll('.cadeira').forEach(cadeira => {
        cadeira.style.borderTop = '';
        cadeira.style.borderBottom = '';
      });
    }
    
    function handleDragOverCadeira(e) {
      if (!modoEdicao || !cadeiraArrastada) return;
      if (this === cadeiraArrastada) return;
      
      e.preventDefault();
      e.dataTransfer.dropEffect = 'move';
      
      // Adicionar indicador visual
      const rect = this.getBoundingClientRect();
      const midpoint = rect.top + rect.height / 2;
      
      if (e.clientY < midpoint) {
        this.style.borderTop = '3px solid #667eea';
        this.style.borderBottom = '';
      } else {
        this.style.borderTop = '';
        this.style.borderBottom = '3px solid #667eea';
      }
      
      e.stopPropagation();
    }
    
    function handleDropCadeira(e) {
      if (!modoEdicao || !cadeiraArrastada) return;
      if (this === cadeiraArrastada) return;
      
      e.preventDefault();
      e.stopPropagation();
      
      const setor = this.closest('.setor');
      const cadeiraArrastadaSetor = cadeiraArrastada.closest('.setor');
      
      // S√≥ permitir reordena√ß√£o dentro do mesmo setor
      if (setor !== cadeiraArrastadaSetor) {
        alert('‚ö†Ô∏è S√≥ √© poss√≠vel reordenar cadeiras dentro do mesmo setor!');
        this.style.borderTop = '';
        this.style.borderBottom = '';
        return;
      }
      
      const rect = this.getBoundingClientRect();
      const midpoint = rect.top + rect.height / 2;
      
      if (e.clientY < midpoint) {
        setor.querySelector('.setor-conteudo').insertBefore(cadeiraArrastada, this);
      } else {
        setor.querySelector('.setor-conteudo').insertBefore(cadeiraArrastada, this.nextSibling);
      }
      
      // Limpar indicadores
      this.style.borderTop = '';
      this.style.borderBottom = '';
      
      // Reconfigurar eventos ap√≥s reordena√ß√£o
      configurarDragDropCadeiras();
      configurarDragDropMembros();
    }
    
    function configurarDragDropMembros() {
      if (!modoEdicao) return;
      
      const membrosLinhas = document.querySelectorAll('.cadeira .membro-linha');
      membrosLinhas.forEach(membro => {
        if (!membro.classList.contains('vazio')) {
          membro.draggable = true;
          membro.style.cursor = 'move';
          
          membro.addEventListener('dragstart', handleDragStartMembroDentro);
          membro.addEventListener('dragend', handleDragEndMembroDentro);
          membro.addEventListener('dragover', handleDragOverMembroDentro);
          membro.addEventListener('drop', handleDropMembroDentro);
        }
      });
    }
    
    function handleDragStartMembroDentro(e) {
      if (!modoEdicao) {
        e.preventDefault();
        return;
      }
      membroArrastadoDentro = this;
      this.style.opacity = '0.5';
      e.dataTransfer.effectAllowed = 'move';
      e.dataTransfer.setData('text/html', this.innerHTML);
      e.stopPropagation();
    }
    
    function handleDragEndMembroDentro(e) {
      this.style.opacity = '1';
      
      // Remover todos os indicadores visuais
      document.querySelectorAll('.membro-linha').forEach(membro => {
        membro.style.borderTop = '';
        membro.style.borderBottom = '';
      });
    }
    
    function handleDragOverMembroDentro(e) {
      if (!modoEdicao || !membroArrastadoDentro) return;
      if (this === membroArrastadoDentro) return;
      if (this.classList.contains('vazio')) return;
      
      e.preventDefault();
      e.dataTransfer.dropEffect = 'move';
      
      // Adicionar indicador visual
      const rect = this.getBoundingClientRect();
      const midpoint = rect.top + rect.height / 2;
      
      if (e.clientY < midpoint) {
        this.style.borderTop = '3px solid #667eea';
        this.style.borderBottom = '';
      } else {
        this.style.borderTop = '';
        this.style.borderBottom = '3px solid #667eea';
      }
      
      e.stopPropagation();
    }
    
    function handleDropMembroDentro(e) {
      if (!modoEdicao || !membroArrastadoDentro) return;
      if (this === membroArrastadoDentro) return;
      
      e.preventDefault();
      e.stopPropagation();
      
      const cadeira = this.closest('.cadeira');
      const membroArrastadoCadeira = membroArrastadoDentro.closest('.cadeira');
      
      // S√≥ permitir reordena√ß√£o dentro da mesma cadeira
      if (cadeira !== membroArrastadoCadeira) {
        alert('‚ö†Ô∏è S√≥ √© poss√≠vel reordenar membros dentro da mesma cadeira!');
        this.style.borderTop = '';
        this.style.borderBottom = '';
        return;
      }
      
      const container = cadeira.querySelector('.cadeira-membros-container');
      const rect = this.getBoundingClientRect();
      const midpoint = rect.top + rect.height / 2;
      
      if (e.clientY < midpoint) {
        container.insertBefore(membroArrastadoDentro, this);
      } else {
        container.insertBefore(membroArrastadoDentro, this.nextSibling);
      }
      
      // Limpar indicadores
      this.style.borderTop = '';
      this.style.borderBottom = '';
      
      // Reconfigurar eventos ap√≥s reordena√ß√£o
      configurarDragDropMembros();
    }

    // ============================================
    // C√ÇMARAS TEM√ÅTICAS
    // ============================================
    function abrirModalCriarCamara() {
      if(!modoEdicao) {
        alert('‚ö†Ô∏è Ative o modo de edi√ß√£o primeiro!');
        return;
      }
      
      document.getElementById('inputNomeCamara').value = '';
      document.getElementById('inputEmojiCamara').value = '';
      document.getElementById('previewEmojiCamara').style.display = 'none';
      
      document.getElementById('modalCriarCamara').classList.add('active');
    }

    function confirmarCriarCamara() {
      const nome = document.getElementById('inputNomeCamara').value;
      const emoji = document.getElementById('inputEmojiCamara').value || 'üèõÔ∏è';
      
      if(!nome) {
        alert('‚ö†Ô∏è Preencha o nome da c√¢mara!');
        return;
      }
      
      const slug = gerarSlugUnico(nome);
      
      const grid = document.getElementById('camarasGrid');
      const novaCamara = document.createElement('div');
      novaCamara.className = 'camara';
      novaCamara.dataset.camara = slug;
      novaCamara.innerHTML = `
        <div class="camara-header">
          <div class="camara-nome">${emoji} ${nome}</div>
          <div class="camara-contador">0 membros</div>
          <button class="btn-editar-nome-camara" onclick="editarNomeCamara(this)">‚úèÔ∏è</button>
          <button class="btn-remover-camara" onclick="removerCamara(this)">üóëÔ∏è</button>
        </div>
        <div class="camara-membros"></div>
        <div class="camara-atividades"></div>
        <div class="camara-gts"></div>
        <button class="btn-add-atividade" onclick="abrirModalAdicionarAtividade(this, false)">‚úÖ Atividade</button>
        <button class="btn-add-gt" onclick="abrirModalCriarGT(this)">üìã GT</button>
      `;
      
      grid.appendChild(novaCamara);
      configurarDragAndDrop();
      
      fecharModal('modalCriarCamara');
      alert(`‚úÖ C√¢mara "${nome}" criada!\n\nüîó Slug gerado: ${slug}`);
      
      document.getElementById('inputNomeCamara').value = '';
      document.getElementById('inputEmojiCamara').value = '';
      document.getElementById('previewEmojiCamara').style.display = 'none';
    }
    
    function atualizarPreviewEmoji() {
      const nome = document.getElementById('inputNomeCamara')?.value || '';
      const emoji = document.getElementById('inputEmojiCamara')?.value || '';
      const preview = document.getElementById('previewEmojiCamara');
      
      if (nome || emoji) {
        const nomeDisplay = nome || 'Nome da C√¢mara';
        const emojiDisplay = emoji || 'üèõÔ∏è';
        preview.textContent = `${emojiDisplay} ${nomeDisplay}`;
        preview.style.display = 'block';
      } else {
        preview.style.display = 'none';
      }
    }

    function editarNomeCamara(btn) {
      if(!modoEdicao) return;
      
      const camara = btn.closest('.camara');
      const nomeAtual = camara.querySelector('.camara-nome').textContent;
      
      camaraEdicaoNomeAtual = camara;
      document.getElementById('inputNovoNomeCamara').value = nomeAtual;
      document.getElementById('modalEditarNomeCamara').classList.add('active');
    }

    function confirmarEditarNomeCamara() {
      const novoNome = document.getElementById('inputNovoNomeCamara').value;
      
      if(!novoNome) {
        alert('‚ö†Ô∏è Digite um nome!');
        return;
      }
      
      if(camaraEdicaoNomeAtual) {
        camaraEdicaoNomeAtual.querySelector('.camara-nome').textContent = novoNome;
        fecharModal('modalEditarNomeCamara');
        alert('‚úÖ Nome da c√¢mara atualizado!');
      }
    }

    function removerCamara(btn) {
      if(!modoEdicao) return;
      
      if(confirm('‚ùì Remover esta c√¢mara?\n\nTodos os membros, atividades e GTs ser√£o perdidos!')) {
        btn.closest('.camara').remove();
        alert('‚úÖ C√¢mara removida!');
      }
    }

    // ============================================
    // ATIVIDADES
    // ============================================
    function abrirModalAdicionarAtividade(btn, isGT) {
      if(!modoEdicao) {
        alert('‚ö†Ô∏è Ative o modo de edi√ß√£o primeiro!');
        return;
      }
      
      elementoAtividadeAtual = btn;
      isAtividadeGT = isGT;
      atividadeEmEdicao = null;
      
      document.getElementById('headerAtividade').textContent = isGT ? '‚úÖ Adicionar Atividade ao GT' : '‚úÖ Adicionar Atividade';
      document.getElementById('inputObjetivoAtiv').value = '';
      document.getElementById('inputResponsavelAtiv').value = '';
      document.getElementById('inputPrazoAtiv').value = '';
      document.getElementById('inputResultadoAtiv').value = '';
      
      document.getElementById('modalAdicionarAtividade').classList.add('active');
    }

    function editarAtividade(btn) {
      if(!modoEdicao) return;
      
      const atividade = btn.closest('.atividade-card');
      atividadeEmEdicao = atividade;
      
      const objetivo = atividade.querySelector('.atividade-titulo')?.textContent || '';
      const responsavel = atividade.querySelector('.atividade-info')?.textContent.replace('üë§ ', '').split(' | ')[0] || '';
      const prazo = atividade.dataset.prazo || '';
      const resultado = atividade.querySelector('.atividade-resultado')?.textContent.replace('üìå ', '') || '';
      
      document.getElementById('headerAtividade').textContent = '‚úèÔ∏è Editar Atividade';
      document.getElementById('inputObjetivoAtiv').value = objetivo;
      document.getElementById('inputResponsavelAtiv').value = responsavel;
      document.getElementById('inputPrazoAtiv').value = prazo;
      document.getElementById('inputResultadoAtiv').value = resultado;
      
      elementoAtividadeAtual = btn;
      isAtividadeGT = atividade.closest('.gt-atividades-internas') !== null;
      
      document.getElementById('modalAdicionarAtividade').classList.add('active');
    }

    function confirmarAdicionarAtividade() {
      const objetivo = document.getElementById('inputObjetivoAtiv').value;
      const responsavel = document.getElementById('inputResponsavelAtiv').value;
      const prazo = document.getElementById('inputPrazoAtiv').value;
      const resultado = document.getElementById('inputResultadoAtiv').value;
      
      if(!objetivo || !responsavel || !prazo) {
        alert('‚ö†Ô∏è Preencha objetivo, respons√°vel e prazo!');
        return;
      }
      
      fecharModal('modalAdicionarAtividade');
      
      if(resultado) {
        document.getElementById('modalStatusAtividade').classList.add('active');
      } else {
        finalizarAdicionarAtividade(false);
      }
    }

    function marcarStatusAtividade(concluida) {
      fecharModal('modalStatusAtividade');
      finalizarAdicionarAtividade(concluida);
    }

    function finalizarAdicionarAtividade(concluida) {
      const objetivo = document.getElementById('inputObjetivoAtiv').value;
      const responsavel = document.getElementById('inputResponsavelAtiv').value;
      const prazo = document.getElementById('inputPrazoAtiv').value;
      const resultado = document.getElementById('inputResultadoAtiv').value;
      
      // CORRE√á√ÉO DE TIMEZONE: Usar formata√ß√£o sem convers√£o UTC
      const dataFormatada = formatarDataSemTimezone(prazo);
      
      if(atividadeEmEdicao) {
        atividadeEmEdicao.querySelector('.atividade-titulo').textContent = objetivo;
        atividadeEmEdicao.querySelector('.atividade-info').textContent = `üë§ ${responsavel} | üìÖ ${dataFormatada}`;
        atividadeEmEdicao.dataset.prazo = prazo;
        atividadeEmEdicao.dataset.concluida = resultado ? concluida : 'false';
        
        const resultadoEl = atividadeEmEdicao.querySelector('.atividade-resultado');
        if(resultado) {
          if(resultadoEl) {
            resultadoEl.textContent = `üìå ${resultado}`;
          } else {
            const novoResultado = document.createElement('div');
            novoResultado.className = 'atividade-resultado';
            novoResultado.textContent = `üìå ${resultado}`;
            atividadeEmEdicao.querySelector('.atividade-info').after(novoResultado);
          }
          
          const statusEl = atividadeEmEdicao.querySelector('.atividade-status');
          if(statusEl) {
            statusEl.className = `atividade-status ${concluida ? 'concluida' : 'nao-concluida'}`;
            statusEl.textContent = concluida ? '‚úÖ CONCLU√çDA' : '‚è≥ N√ÉO CONCLU√çDA';
          }
        }
        
        alert('‚úÖ Atividade atualizada!');
      } else {
        const atividade = document.createElement('div');
        atividade.className = 'atividade-card';
        atividade.dataset.prazo = prazo;
        atividade.dataset.concluida = resultado ? concluida : 'false';
        
        atividade.innerHTML = `
          <div class="atividade-titulo">${objetivo}</div>
          <div class="atividade-info">üë§ ${responsavel} | üìÖ ${dataFormatada}</div>
          ${resultado ? `<div class="atividade-resultado">üìå ${resultado}</div>` : ''}
          ${resultado ? `<div class="atividade-status ${concluida ? 'concluida' : 'nao-concluida'}">${concluida ? '‚úÖ CONCLU√çDA' : '‚è≥ N√ÉO CONCLU√çDA'}</div>` : ''}
          <button class="btn-edit-atividade" onclick="editarAtividade(this)">‚úèÔ∏è</button>
          <button class="btn-remove" onclick="removerAtividade(this)">üóëÔ∏è</button>
        `;
        
        if(isAtividadeGT) {
          const gt = elementoAtividadeAtual.closest('.gt-card');
          let container = gt.querySelector('.gt-atividades-internas');
          if(!container) {
            container = document.createElement('div');
            container.className = 'gt-atividades-internas';
            gt.querySelector('.gt-objetivo').after(container);
          }
          container.appendChild(atividade);
        } else {
          const camara = elementoAtividadeAtual.closest('.camara');
          const container = camara.querySelector('.camara-atividades');
          container.appendChild(atividade);
        }
        
        alert('‚úÖ Atividade criada!');
      }
    }

    function removerAtividade(btn) {
      if(!modoEdicao) return;
      
      if(confirm('‚ùì Remover esta atividade?')) {
        btn.closest('.atividade-card').remove();
        alert('‚úÖ Atividade removida!');
      }
    }

    // ============================================
    // GRUPOS DE TRABALHO (GT)
    // ============================================
    let componentesGTAtual = [];
    
    function adicionarComponenteGT() {
      const container = document.getElementById('componentesGTContainer');
      const index = container.children.length;
      
      const componenteDiv = document.createElement('div');
      componenteDiv.className = 'componente-gt-item';
      componenteDiv.style.cssText = 'display: flex; gap: 10px; margin: 8px 0; padding: 10px; background: white; border-radius: 6px; border: 1px solid #dee2e6;';
      componenteDiv.innerHTML = `
        <input type="text" class="modal-input" placeholder="Nome do componente" style="flex: 1; margin: 0;" data-comp-index="${index}" data-comp-field="nome">
        <input type="text" class="modal-input" placeholder="Institui√ß√£o" style="flex: 1; margin: 0;" data-comp-index="${index}" data-comp-field="instituicao">
        <button type="button" onclick="removerComponenteGT(this)" style="background: #ff6b6b; color: white; border: none; border-radius: 5px; padding: 5px 10px; cursor: pointer;">üóëÔ∏è</button>
      `;
      container.appendChild(componenteDiv);
    }
    
    function removerComponenteGT(btn) {
      btn.closest('.componente-gt-item').remove();
    }
    
    function coletarComponentesGT() {
      const componentes = [];
      const container = document.getElementById('componentesGTContainer');
      container.querySelectorAll('.componente-gt-item').forEach(item => {
        const nome = item.querySelector('[data-comp-field="nome"]').value.trim();
        const instituicao = item.querySelector('[data-comp-field="instituicao"]').value.trim();
        if (nome && instituicao) {
          componentes.push({ nome, instituicao });
        }
      });
      return componentes;
    }
    
    function carregarComponentesGT(componentes) {
      const container = document.getElementById('componentesGTContainer');
      container.innerHTML = '';
      if (componentes && componentes.length > 0) {
        componentes.forEach(comp => {
          const componenteDiv = document.createElement('div');
          componenteDiv.className = 'componente-gt-item';
          componenteDiv.style.cssText = 'display: flex; gap: 10px; margin: 8px 0; padding: 10px; background: white; border-radius: 6px; border: 1px solid #dee2e6;';
          componenteDiv.innerHTML = `
            <input type="text" class="modal-input" placeholder="Nome do componente" style="flex: 1; margin: 0;" value="${comp.nome}" data-comp-field="nome">
            <input type="text" class="modal-input" placeholder="Institui√ß√£o" style="flex: 1; margin: 0;" value="${comp.instituicao}" data-comp-field="instituicao">
            <button type="button" onclick="removerComponenteGT(this)" style="background: #ff6b6b; color: white; border: none; border-radius: 5px; padding: 5px 10px; cursor: pointer;">üóëÔ∏è</button>
          `;
          container.appendChild(componenteDiv);
        });
      }
    }
    
    function fecharModalGT() {
      // Clear without saving
      document.getElementById('componentesGTContainer').innerHTML = '';
      componentesGTAtual = [];
      fecharModal('modalCriarGT');
    }
    
    function abrirModalCriarGT(btn) {
      if(!modoEdicao) {
        alert('‚ö†Ô∏è Ative o modo de edi√ß√£o primeiro!');
        return;
      }
      
      elementoGTAtual = btn;
      
      document.getElementById('inputTituloGT').value = '';
      document.getElementById('inputObjetivoGT').value = '';
      document.getElementById('inputResponsavelGT').value = '';
      document.getElementById('inputComponentesGTContainer').innerHTML = '';
      componentesGTAtual = [];
      document.getElementById('inputResultadoGT').value = '';
      
      document.getElementById('modalCriarGT').classList.add('active');
    }

    function editarGT(btn) {
      if(!modoEdicao) return;
      
      const gt = btn.closest('.gt-card');
      elementoGTAtual = gt;
      
      const titulo = gt.querySelector('.gt-titulo')?.textContent || '';
      const responsavel = gt.querySelector('.gt-responsavel')?.textContent.replace('üë§ ', '') || '';
      const objetivo = gt.querySelector('.gt-objetivo')?.textContent.replace('üéØ ', '') || '';
      const resultado = gt.querySelector('.gt-resultado')?.textContent.replace('üìå ', '') || '';
      
      // Load components from data attribute
      const componentesData = gt.dataset.componentes ? JSON.parse(gt.dataset.componentes) : [];
      
      document.getElementById('inputTituloGT').value = titulo;
      document.getElementById('inputObjetivoGT').value = objetivo;
      document.getElementById('inputResponsavelGT').value = responsavel;
      document.getElementById('inputResultadoGT').value = resultado;
      
      carregarComponentesGT(componentesData);
      
      document.getElementById('modalCriarGT').classList.add('active');
    }

    function confirmarCriarGT() {
      const titulo = document.getElementById('inputTituloGT').value;
      const objetivo = document.getElementById('inputObjetivoGT').value;
      const responsavel = document.getElementById('inputResponsavelGT').value;
      const resultado = document.getElementById('inputResultadoGT').value;
      const componentes = coletarComponentesGT();
      
      if(!titulo || !objetivo || !responsavel) {
        alert('‚ö†Ô∏è Preencha t√≠tulo, objetivo e respons√°vel!');
        return;
      }
      
      // Generate components display HTML
      let componentesHTML = '';
      if (componentes.length > 0) {
        componentesHTML = componentes.map(c => 
          `<div style="display: flex; align-items: center; gap: 8px; margin: 4px 0;">
            <span style="font-size: 1.5em;">üë§</span>
            <div style="flex: 1;">
              <div style="font-weight: bold; font-size: 0.85em;">${c.nome}</div>
              <div style="font-size: 0.75em; color: #6c757d; font-style: italic;">${c.instituicao}</div>
            </div>
          </div>`
        ).join('');
      }
      
      if(elementoGTAtual && elementoGTAtual.classList && elementoGTAtual.classList.contains('gt-card')) {
        // Updating existing GT
        elementoGTAtual.querySelector('.gt-titulo').textContent = titulo;
        elementoGTAtual.querySelector('.gt-responsavel').textContent = `üë§ ${responsavel}`;
        elementoGTAtual.querySelector('.gt-objetivo').textContent = `üéØ ${objetivo}`;
        
        // Store components in data attribute
        elementoGTAtual.dataset.componentes = JSON.stringify(componentes);
        
        // Update or create components display
        let compEl = elementoGTAtual.querySelector('.gt-componentes');
        if (componentes.length > 0) {
          if (!compEl) {
            compEl = document.createElement('div');
            compEl.className = 'gt-componentes show';
            elementoGTAtual.querySelector('.gt-objetivo').after(compEl);
          }
          compEl.innerHTML = componentesHTML;
          compEl.classList.add('show');
          
          // Ensure toggle button exists
          let btnVer = elementoGTAtual.querySelector('.btn-ver-componentes');
          if (!btnVer) {
            btnVer = document.createElement('button');
            btnVer.className = 'btn-ver-componentes';
            btnVer.onclick = function() { toggleComponentes(this); };
            btnVer.textContent = 'üë• Ver Componentes';
            compEl.before(btnVer);
          }
        } else {
          // Remove components if empty
          if (compEl) compEl.remove();
          const btnVer = elementoGTAtual.querySelector('.btn-ver-componentes');
          if (btnVer) btnVer.remove();
        }
        
        // Update result
        const resEl = elementoGTAtual.querySelector('.gt-resultado');
        if(resultado) {
          if(resEl) {
            resEl.textContent = `üìå ${resultado}`;
          } else {
            const novoRes = document.createElement('div');
            novoRes.className = 'gt-resultado';
            novoRes.textContent = `üìå ${resultado}`;
            const compSection = elementoGTAtual.querySelector('.gt-componentes') || elementoGTAtual.querySelector('.gt-objetivo');
            compSection.after(novoRes);
          }
        }
        
        alert('‚úÖ GT atualizado!');
      } else {
        // Creating new GT
        const camara = elementoGTAtual.closest('.camara');
        const container = camara.querySelector('.camara-gts');
        
        const gt = document.createElement('div');
        gt.className = 'gt-card';
        gt.dataset.componentes = JSON.stringify(componentes);
        gt.innerHTML = `
          <div class="gt-titulo editable" contenteditable="false">${titulo}</div>
          <div class="gt-responsavel editable" contenteditable="false">üë§ ${responsavel}</div>
          <div class="gt-objetivo editable" contenteditable="false">üéØ ${objetivo}</div>
          ${componentes.length > 0 ? `
            <button class="btn-ver-componentes" onclick="toggleComponentes(this)">üë• Ver Componentes</button>
            <div class="gt-componentes show">${componentesHTML}</div>
          ` : ''}
          ${resultado ? `<div class="gt-resultado">üìå ${resultado}</div>` : ''}
          <div class="gt-atividades-internas"></div>
          <button class="btn-edit-gt" onclick="editarGT(this)">‚úèÔ∏è Editar</button>
          <button class="btn-add-atividade" onclick="abrirModalAdicionarAtividade(this, true)">‚úÖ Atividade GT</button>
          <button class="btn-remove" onclick="removerGT(this)">üóëÔ∏è</button>
        `;
        
        container.appendChild(gt);
        alert('‚úÖ GT criado!');
      }
      
      // Clear form and close
      document.getElementById('componentesGTContainer').innerHTML = '';
      componentesGTAtual = [];
      fecharModal('modalCriarGT');
    }

    function removerGT(btn) {
      if(!modoEdicao) return;
      
      if(confirm('‚ùì Remover este GT?')) {
        btn.closest('.gt-card').remove();
        alert('‚úÖ GT removido!');
      }
    }
// ============================================
// FUN√á√ÉO PARA ABRIR MODAL DE CRIA√á√ÉO DE C√ÇMARA
// ============================================
function abrirModalCriarCamara() {
    if(!modoEdicao) {
        alert('‚ö†Ô∏è Ative o modo de edi√ß√£o primeiro!');
        return;
    }
    
    // Resetar o modal
    document.getElementById('inputNomeCamara').value = '';
    document.getElementById('inputEmojiCamara').value = 'üî¨';
    document.getElementById('emojiSelecionadoPreview').textContent = 'üî¨';
    
    // Resetar sele√ß√£o de emojis
    document.querySelectorAll('.emoji-option-simples').forEach(el => {
        el.classList.remove('selecionado');
    });
    
    // Selecionar o primeiro emoji por padr√£o
    const primeiroEmoji = document.querySelector('.emoji-option-simples');
    if (primeiroEmoji) {
        primeiroEmoji.classList.add('selecionado');
    }
    
    document.getElementById('modalCriarCamara').classList.add('active');
}
    function toggleComponentes(btn) {
      const gt = btn.closest('.gt-card');
      const comp = gt.querySelector('.gt-componentes');
      if(comp) {
        comp.classList.toggle('show');
        btn.textContent = comp.classList.contains('show') ? 'üîº Ocultar Componentes' : 'üë• Ver Componentes';
      }
    }
    
    // ============================================
    // AN√ÅLISES
    // ============================================
    function mostrarAnalise(tipo) {
      document.querySelectorAll('.analise-content').forEach(c => c.classList.remove('active'));
      document.querySelectorAll('.analise-btn').forEach(b => b.classList.remove('active'));
      
      if(tipo === 'presenca') {
        document.getElementById('analisePresenca').classList.add('active');
        event.target.classList.add('active');
        gerarRankingPresenca();
      } else if(tipo === 'composicao') {
        document.getElementById('analiseComposicao').classList.add('active');
        event.target.classList.add('active');
        gerarComposicao();
      } else if(tipo === 'estados') {
        document.getElementById('analiseEstados').classList.add('active');
        event.target.classList.add('active');
        gerarPorEstado();
      } else if(tipo === 'atividades') {
        document.getElementById('analiseAtividades').classList.add('active');
        event.target.classList.add('active');
        gerarAnaliseAtividades();
      }
    }

    function gerarAnalises() {
      gerarRankingPresenca();
      gerarComposicao();
      gerarPorEstado();
      gerarAnaliseAtividades();
    }

    function gerarRankingPresenca() {
      const membros = [];
      
      document.querySelectorAll('.membro-linha:not(.vazio)').forEach(membro => {
        const nome = membro.querySelector('.nome-membro')?.textContent || '';
        const entidade = membro.querySelector('.entidade-membro')?.textContent || '';
        const boneco = membro.querySelector('.bonequinho')?.textContent || 'üë§';
        const estado = membro.dataset.estado || '';
        const bolinhas = membro.querySelectorAll('.bolinha-presenca');
        
        let presencas = 0;
        let justificadas = 0;
        let faltas = 0;
        
        bolinhas.forEach(b => {
          if(b.classList.contains('verde')) presencas++;
          else if(b.classList.contains('amarelo')) justificadas++;
          else if(b.classList.contains('vermelho')) faltas++;
        });
        
        const score = (presencas * 10) + (justificadas * 5);
        
        if(nome && nome !== 'VAGA' && nome.trim() !== '' && nome !== '-') {
          membros.push({ nome, entidade, boneco, estado, presencas, justificadas, faltas, score });
        }
      });
      
      membros.sort((a, b) => b.score - a.score);
      
      const container = document.getElementById('rankingContainer');
      container.innerHTML = '';
      
      if(membros.length === 0) {
        container.innerHTML = '<div class="mensagem-vazio">Nenhum registro de presen√ßa encontrado</div>';
        return;
      }
      
      membros.forEach((m, index) => {
        const item = document.createElement('div');
        item.className = 'ranking-item';
        if(m.estado) {
          item.dataset.estado = m.estado;
        }
        item.style.cssText = `
          display: flex; align-items: center; gap: 15px; padding: 12px; 
          margin-bottom: 8px; background: #f8f9fa; border-radius: 8px; 
          border-left: 4px solid #51cf66;
        `;
        item.innerHTML = `
          <div style="font-size: 1.5em; font-weight: bold; color: #667eea; min-width: 40px; text-align: center;">${index + 1}¬∫</div>
          <div style="font-size: 2em;">${m.boneco}</div>
          <div style="flex: 1;">
            <div style="font-weight: bold; font-size: 1em; color: #2c3e50;">${m.nome}</div>
            <div style="font-size: 0.85em; color: #6c757d; font-style: italic;">${m.entidade}</div>
            <div style="font-size: 0.75em; color: #868e96;">
              üü¢ ${m.presencas} | üü° ${m.justificadas} | üî¥ ${m.faltas}
            </div>
          </div>
          <div style="font-size: 1.2em; font-weight: bold; color: #51cf66; min-width: 80px; text-align: center;">${m.score} pts</div>
        `;
        container.appendChild(item);
      });
    }

    function gerarComposicao() {
      const container = document.getElementById('composicaoContainer');
      container.innerHTML = '';
      
      const grupos = [
        { id: 'poder-publico', titulo: '‚öñÔ∏è PODER P√öBLICO' },
        { id: 'sociedade-civil', titulo: 'ü§ù SOCIEDADE CIVIL' }
      ];
      
      grupos.forEach(grupoInfo => {
        const grupo = document.getElementById(grupoInfo.id);
        if(!grupo) return;
        
        const grupoDiv = document.createElement('div');
        grupoDiv.className = 'composicao-grupo';
        
        const titulo = document.createElement('div');
        titulo.className = 'composicao-grupo-titulo';
        titulo.textContent = grupoInfo.titulo;
        grupoDiv.appendChild(titulo);
        
        const setores = grupo.querySelectorAll('.setor');
        const numSetores = setores.length;
        const numCadeiras = grupo.querySelectorAll('.cadeira').length;
        
        const contadorDiv = document.createElement('div');
        contadorDiv.className = 'grupo-contador';
        contadorDiv.innerHTML = `
          <span>üìÇ Setores: <strong class="contador-setores">${numSetores}</strong></span>
          <span>ü™ë Cadeiras: <strong class="contador-cadeiras-total">${numCadeiras}</strong></span>
        `;
        grupoDiv.appendChild(contadorDiv);
        
        setores.forEach(setor => {
          const setorDiv = document.createElement('div');
          setorDiv.className = 'composicao-setor';
          
          const tituloSetor = setor.querySelector('.titulo-setor .editable')?.textContent || 'Setor';
          const numCadeirasSetor = setor.querySelectorAll('.cadeira').length;
          
          const tituloSetorDiv = document.createElement('div');
          tituloSetorDiv.className = 'composicao-setor-titulo';
          tituloSetorDiv.innerHTML = `
            ${tituloSetor}
            <span class="composicao-cadeiras-info">${numCadeirasSetor} cadeira${numCadeirasSetor !== 1 ? 's' : ''}</span>
          `;
          setorDiv.appendChild(tituloSetorDiv);
          
          const cadeirasContainer = document.createElement('div');
          cadeirasContainer.className = 'composicao-cadeiras-container';
          
          setor.querySelectorAll('.cadeira').forEach(cadeira => {
            const cadeiraBloco = document.createElement('div');
            cadeiraBloco.className = 'composicao-cadeira-bloco';
            
            const icone = cadeira.querySelector('.icone-cadeira')?.textContent || 'ü™ë';
            const iconeDiv = document.createElement('div');
            iconeDiv.className = 'composicao-icone-cadeira';
            iconeDiv.textContent = icone;
            cadeiraBloco.appendChild(iconeDiv);
            
            const membrosDiv = document.createElement('div');
            membrosDiv.className = 'composicao-membros-cadeira';
            
            cadeira.querySelectorAll('.membro-linha').forEach(membro => {
              const nome = membro.querySelector('.nome-membro')?.textContent || '';
              const entidade = membro.querySelector('.entidade-membro')?.textContent || '';
              const boneco = membro.querySelector('.bonequinho')?.textContent || 'üë§';
              const logo = membro.querySelector('.logo-instituicao')?.textContent || 'üèõÔ∏è';
              const tipo = membro.classList.contains('titular') ? 'titular' : 'suplente';
              const estado = membro.dataset.estado || '';
              
              const card = document.createElement('div');
              card.className = 'composicao-card';
              card.dataset.estado = estado;
              card.innerHTML = `
                <div class="composicao-boneco">${boneco}</div>
                <div class="composicao-entidade">${nome}</div>
                <div style="font-size: 0.7em; color: #6c757d; margin-bottom: 3px;">${entidade}</div>
                <div class="composicao-cargo ${tipo}">${tipo === 'titular' ? 'Titular' : 'Suplente'}</div>
              `;
              membrosDiv.appendChild(card);
            });
            
            cadeiraBloco.appendChild(membrosDiv);
            cadeirasContainer.appendChild(cadeiraBloco);
          });
          
          setorDiv.appendChild(cadeirasContainer);
          grupoDiv.appendChild(setorDiv);
        });
        
        container.appendChild(grupoDiv);
      });
    }

    function gerarPorEstado() {
      const container = document.getElementById('estadosContainer');
      container.innerHTML = '';
      
      const estados = {
        'AC': { nome: 'ACRE', emoji: 'üå≥', membros: [] },
        'AL': { nome: 'ALAGOAS', emoji: 'üèñÔ∏è', membros: [] },
        'AP': { nome: 'AMAP√Å', emoji: 'üåä', membros: [] },
        'AM': { nome: 'AMAZONAS', emoji: 'üå¥', membros: [] },
        'BA': { nome: 'BAHIA', emoji: '‚òÄÔ∏è', membros: [] },
        'CE': { nome: 'CEAR√Å', emoji: 'üåµ', membros: [] },
        'DF': { nome: 'DISTRITO FEDERAL', emoji: 'üèõÔ∏è', membros: [] },
        'ES': { nome: 'ESP√çRITO SANTO', emoji: '‚õ∞Ô∏è', membros: [] },
        'GO': { nome: 'GOI√ÅS', emoji: 'üåæ', membros: [] },
        'MA': { nome: 'MARANH√ÉO', emoji: 'üèñÔ∏è', membros: [] },
        'MT': { nome: 'MATO GROSSO', emoji: 'üêÑ', membros: [] },
        'MS': { nome: 'MATO GROSSO DO SUL', emoji: 'üå≥', membros: [] },
        'MG': { nome: 'MINAS GERAIS', emoji: '‚õ∞Ô∏è', membros: [] },
        'PA': { nome: 'PAR√Å', emoji: 'üå¥', membros: [] },
        'PB': { nome: 'PARA√çBA', emoji: 'üåµ', membros: [] },
        'PR': { nome: 'PARAN√Å', emoji: 'üå≤', membros: [] },
        'PE': { nome: 'PERNAMBUCO', emoji: 'üèñÔ∏è', membros: [] },
        'PI': { nome: 'PIAU√ç', emoji: 'üåµ', membros: [] },
        'RJ': { nome: 'RIO DE JANEIRO', emoji: 'üèñÔ∏è', membros: [] },
        'RN': { nome: 'RIO GRANDE DO NORTE', emoji: 'üåµ', membros: [] },
        'RS': { nome: 'RIO GRANDE DO SUL', emoji: 'üêÑ', membros: [] },
        'RO': { nome: 'ROND√îNIA', emoji: 'üå≥', membros: [] },
        'RR': { nome: 'RORAIMA', emoji: 'üå¥', membros: [] },
        'SC': { nome: 'SANTA CATARINA', emoji: 'üèñÔ∏è', membros: [] },
        'SP': { nome: 'S√ÉO PAULO', emoji: 'üèôÔ∏è', membros: [] },
        'SE': { nome: 'SERGIPE', emoji: 'üåµ', membros: [] },
        'TO': { nome: 'TOCANTINS', emoji: 'üå¥', membros: [] }
      };
      
      document.querySelectorAll('.membro-linha:not(.vazio)').forEach(membro => {
        const nome = membro.querySelector('.nome-membro')?.textContent || '';
        const entidade = membro.querySelector('.entidade-membro')?.textContent || '';
        const municipio = membro.querySelector('.municipio-membro')?.textContent.replace('üìç ', '') || '';
        const boneco = membro.querySelector('.bonequinho')?.textContent || 'üë§';
        const estado = membro.dataset.estado || '';
        
        if(nome && nome !== 'VAGA' && nome.trim() !== '' && estado && estados[estado]) {
          estados[estado].membros.push({ nome, entidade, municipio, boneco });
        }
      });
      
      Object.keys(estados).forEach(sigla => {
        const estado = estados[sigla];
        
        if (estado.membros.length === 0) return;
        
        const estadoDiv = document.createElement('div');
        estadoDiv.style.cssText = `
          margin-bottom: 25px; padding: 15px; border-radius: 10px;
        `;
        
        if(sigla === 'AC') estadoDiv.style.cssText += 'background: linear-gradient(135deg, #FFE0E0 0%, #FFCDD2 100%);';
        if(sigla === 'AL') estadoDiv.style.cssText += 'background: linear-gradient(135deg, #FFF9C4 0%, #FFF59D 100%);';
        if(sigla === 'AP') estadoDiv.style.cssText += 'background: linear-gradient(135deg, #E3F2FD 0%, #BBDEFB 100%);';
        if(sigla === 'AM') estadoDiv.style.cssText += 'background: linear-gradient(135deg, #E8F5E8 0%, #C8E6C9 100%);';
        if(sigla === 'BA') estadoDiv.style.cssText += 'background: linear-gradient(135deg, #F3E5F5 0%, #E1BEE7 100%);';
        if(sigla === 'CE') estadoDiv.style.cssText += 'background: linear-gradient(135deg, #FFEBEE 0%, #FFCDD2 100%);';
        if(sigla === 'DF') estadoDiv.style.cssText += 'background: linear-gradient(135deg, #FFF3E0 0%, #FFE0B2 100%);';
        if(sigla === 'ES') estadoDiv.style.cssText += 'background: linear-gradient(135deg, #E8EAF6 0%, #C5CAE9 100%);';
        if(sigla === 'GO') estadoDiv.style.cssText += 'background: linear-gradient(135deg, #FCE4EC 0%, #F8BBD0 100%);';
        if(sigla === 'MA') estadoDiv.style.cssText += 'background: linear-gradient(135deg, #FFFDE7 0%, #FFF9C4 100%);';
        if(sigla === 'MT') estadoDiv.style.cssText += 'background: linear-gradient(135deg, #FFF8E1 0%, #FFECB3 100%);';
        if(sigla === 'MS') estadoDiv.style.cssText += 'background: linear-gradient(135deg, #E8F5E9 0%, #C8E6C9 100%);';
        if(sigla === 'MG') estadoDiv.style.cssText += 'background: linear-gradient(135deg, #F1F8E9 0%, #DCEDC8 100%);';
        if(sigla === 'PA') estadoDiv.style.cssText += 'background: linear-gradient(135deg, #FFFDE7 0%, #FFF9C4 100%);';
        if(sigla === 'PB') estadoDiv.style.cssText += 'background: linear-gradient(135deg, #E1F5FE 0%, #B3E5FC 100%);';
        if(sigla === 'PR') estadoDiv.style.cssText += 'background: linear-gradient(135deg, #F9FBE7 0%, #F0F4C3 100%);';
        if(sigla === 'PE') estadoDiv.style.cssText += 'background: linear-gradient(135deg, #EDE7F6 0%, #D1C4E9 100%);';
        if(sigla === 'PI') estadoDiv.style.cssText += 'background: linear-gradient(135deg, #E0F2F1 0%, #B2DFDB 100%);';
        if(sigla === 'RJ') estadoDiv.style.cssText += 'background: linear-gradient(135deg, #FFEBEE 0%, #FFCDD2 100%);';
        if(sigla === 'RN') estadoDiv.style.cssText += 'background: linear-gradient(135deg, #E3F2FD 0%, #BBDEFB 100%);';
        if(sigla === 'RS') estadoDiv.style.cssText += 'background: linear-gradient(135deg, #F3E5F5 0%, #E1BEE7 100%);';
        if(sigla === 'RO') estadoDiv.style.cssText += 'background: linear-gradient(135deg, #FFF3E0 0%, #FFE0B2 100%);';
        if(sigla === 'RR') estadoDiv.style.cssText += 'background: linear-gradient(135deg, #E8F5E8 0%, #C8E6C9 100%);';
        if(sigla === 'SC') estadoDiv.style.cssText += 'background: linear-gradient(135deg, #FFF9C4 0%, #FFF59D 100%);';
        if(sigla === 'SP') estadoDiv.style.cssText += 'background: linear-gradient(135deg, #E3F2FD 0%, #BBDEFB 100%);';
        if(sigla === 'SE') estadoDiv.style.cssText += 'background: linear-gradient(135deg, #FCE4EC 0%, #F8BBD0 100%);';
        if(sigla === 'TO') estadoDiv.style.cssText += 'background: linear-gradient(135deg, #E8EAF6 0%, #C5CAE9 100%);';
        
        const titulo = document.createElement('div');
        titulo.style.cssText = `
          font-size: 1.4em; font-weight: bold; color: #2c3e50; 
          margin-bottom: 12px; padding-bottom: 8px; 
          border-bottom: 2px solid #667eea; display: flex; 
          align-items: center; gap: 8px;
        `;
        titulo.innerHTML = `
          ${estado.emoji} ${estado.nome}
          <span style="background: #667eea; color: white; padding: 4px 12px; border-radius: 15px; font-size: 0.7em;">
            ${estado.membros.length} membro${estado.membros.length !== 1 ? 's' : ''}
          </span>
        `;
        estadoDiv.appendChild(titulo);
        
        const grid = document.createElement('div');
        grid.style.cssText = 'display: grid; grid-template-columns: repeat(auto-fill, minmax(130px, 1fr)); gap: 10px;';
        
        if(estado.membros.length === 0) {
          grid.innerHTML = '<div style="text-align: center; padding: 20px; color: #6c757d; font-style: italic;">Nenhum membro deste estado</div>';
        } else {
          estado.membros.forEach(m => {
            const card = document.createElement('div');
            card.style.cssText = `
              background: white; border: 2px solid #dee2e6; 
              border-radius: 8px; padding: 10px; text-align: center;
            `;
            card.innerHTML = `
              <div style="font-size: 2em; margin-bottom: 5px;">${m.boneco}</div>
              <div style="font-weight: bold; font-size: 0.8em; color: #2c3e50; margin-bottom: 3px;">${m.nome}</div>
              <div style="font-size: 0.7em; color: #6c757d; font-style: italic; margin-bottom: 3px;">${m.entidade}</div>
              <div style="font-size: 0.65em; color: #868e96;">${m.municipio}</div>
            `;
            grid.appendChild(card);
          });
        }
        
        estadoDiv.appendChild(grid);
        container.appendChild(estadoDiv);
      });
    }

    function gerarAnaliseAtividades() {
      const container = document.getElementById('atividadesContainer');
      container.innerHTML = '';
      
      const atividades = [];
      
      document.querySelectorAll('.atividade-card').forEach(ativ => {
        const titulo = ativ.querySelector('.atividade-titulo')?.textContent || '';
        const info = ativ.querySelector('.atividade-info')?.textContent || '';
        const resultado = ativ.querySelector('.atividade-resultado')?.textContent.replace('üìå ', '') || '';
        const concluida = ativ.dataset.concluida === 'true';
        const prazo = ativ.dataset.prazo || '';
        
        const camara = ativ.closest('.camara');
        const nomeCamara = camara ? camara.querySelector('.camara-nome')?.textContent : 'Geral';
        
        atividades.push({ titulo, info, resultado, concluida, prazo, nomeCamara });
      });
      
      if(atividades.length === 0) {
        container.innerHTML = '<div class="mensagem-vazio">Nenhuma atividade cadastrada</div>';
        return;
      }
      
      atividades.forEach(a => {
        const card = document.createElement('div');
        card.style.cssText = `
          background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%); 
          border-radius: 8px; padding: 10px; margin-bottom: 8px; 
          border-left: 3px solid #2196f3;
        `;
        card.innerHTML = `
          <div style="font-weight: bold; color: #2c3e50; margin-bottom: 4px; font-size: 0.85em;">${a.titulo}</div>
          <div style="font-size: 0.75em; color: #495057; margin-bottom: 4px;">${a.info} | üèõÔ∏è ${a.nomeCamara}</div>
          ${a.resultado ? `<div style="background: white; padding: 6px; border-radius: 4px; font-size: 0.75em; color: #2c3e50; margin-top: 6px; border-left: 3px solid #667eea;">üìå ${a.resultado}</div>` : ''}
          ${a.resultado ? `<div style="margin-top: 6px; padding: 4px 8px; border-radius: 5px; font-size: 0.7em; font-weight: bold; display: inline-block; background: ${a.concluida ? '#2ecc71' : '#ffd43b'}; color: ${a.concluida ? 'white' : '#333'};">${a.concluida ? '‚úÖ CONCLU√çDA' : '‚è≥ N√ÉO CONCLU√çDA'}</div>` : '<div style="margin-top: 6px; padding: 4px 8px; border-radius: 5px; font-size: 0.7em; font-weight: bold; display: inline-block; background: #ffd43b; color: #333;">üîì ABERTA</div>'}
        `;
        container.appendChild(card);
      });
    }
    
    // ============================================
    // IMPRIMIR LISTA DE PRESEN√áA
    // ============================================
   function imprimirListaPresenca() {
  const membros = [];
  
  // Coletar membros na ordem das cadeiras (Poder P√∫blico -> Sociedade Civil)
  
  // 1. Presid√™ncia
  document.querySelectorAll('#presidenciaContainer .membro-linha:not(.vazio)').forEach(membro => {
    const nome = membro.querySelector('.nome-membro')?.textContent || '';
    const entidade = membro.querySelector('.entidade-membro')?.textContent || '';
    const telefone = membro.dataset.telefone || '';
    const tipo = membro.classList.contains('titular') ? 'Titular' : 'Suplente';
    
    if(nome && nome.trim() !== '' && nome !== 'VAGA' && nome !== '-') {
      membros.push({ 
        nome, 
        entidade, 
        telefone, 
        tipo,
        ordem: '0-presidencia',
        cadeira: 'PRESID√äNCIA'
      });
    }
  });
  
  // 2. Poder P√∫blico
  document.querySelectorAll('#poder-publico .membro-linha:not(.vazio)').forEach(membro => {
    const nome = membro.querySelector('.nome-membro')?.textContent || '';
    const entidade = membro.querySelector('.entidade-membro')?.textContent || '';
    const telefone = membro.dataset.telefone || '';
    const tipo = membro.classList.contains('titular') ? 'Titular' : 'Suplente';
    const cadeira = membro.closest('.cadeira')?.querySelector('.numero-cadeira')?.textContent || '';
    const setor = membro.closest('.setor')?.querySelector('.titulo-setor .editable')?.textContent || '';
    
    if(nome && nome.trim() !== '' && nome !== 'VAGA' && nome !== '-') {
      membros.push({ 
        nome, 
        entidade, 
        telefone, 
        tipo,
        ordem: `1-poder-publico-${setor}-${cadeira}`,
        cadeira: `${setor} - ${cadeira}`
      });
    }
  });
  
  // 3. Sociedade Civil
  document.querySelectorAll('#sociedade-civil .membro-linha:not(.vazio)').forEach(membro => {
    const nome = membro.querySelector('.nome-membro')?.textContent || '';
    const entidade = membro.querySelector('.entidade-membro')?.textContent || '';
    const telefone = membro.dataset.telefone || '';
    const tipo = membro.classList.contains('titular') ? 'Titular' : 'Suplente';
    const cadeira = membro.closest('.cadeira')?.querySelector('.numero-cadeira')?.textContent || '';
    const setor = membro.closest('.setor')?.querySelector('.titulo-setor .editable')?.textContent || '';
    
    if(nome && nome.trim() !== '' && nome !== 'VAGA' && nome !== '-') {
      membros.push({ 
        nome, 
        entidade, 
        telefone, 
        tipo,
        ordem: `2-sociedade-civil-${setor}-${cadeira}`,
        cadeira: `${setor} - ${cadeira}`
      });
    }
  });
  
  // Ordenar pela ordem definida
  membros.sort((a, b) => a.ordem.localeCompare(b.ordem));
  
  const dataReuniao = document.getElementById('dataReuniaoAtual').textContent;
  const localReuniao = document.getElementById('localReuniaoAtual').textContent;
  
  // Calcular totais para o qu√≥rum
  const totalCadeiras = calcularTotalCadeiras();
  const totalMembros = membros.length;
  
  const conteudoHTML = `
    <!DOCTYPE html>
    <html>
    <head>
      <meta charset="UTF-8">
      <title>Lista de Presen√ßa</title>
      <style>
        body { 
          font-family: Arial, sans-serif; 
          margin: 0; 
          padding: 20px; 
          line-height: 1.4;
        }
        .container { max-width: 100%; }
        .header { 
          text-align: center; 
          margin-bottom: 20px; 
          border-bottom: 2px solid #333;
          padding-bottom: 15px;
        }
        .header h1 { 
          margin-bottom: 5px; 
          color: #2c3e50;
          font-size: 24px;
        }
        .quorum-info {
          background: #f8f9fa;
          padding: 10px;
          border-radius: 5px;
          margin-bottom: 15px;
          text-align: center;
          border-left: 4px solid #667eea;
        }
        .header .info { 
          margin-bottom: 10px; 
          font-size: 16px;
          color: #555;
        }
        table { 
          width: 100%; 
          border-collapse: collapse; 
          margin-bottom: 20px; 
          font-size: 14px;
          border: 1px solid #000;
        }
        th, td { 
          border: 1px solid #000; 
          padding: 10px 8px; 
          text-align: left; 
          vertical-align: top;
        }
        th { 
          background-color: #f2f2f2 !important; 
          font-weight: bold;
          text-align: center;
        }
        .numero-col { width: 5%; text-align: center; }
        .cadeira-col { width: 20%; }
        .nome-col { width: 25%; }
        .tipo-col { width: 10%; text-align: center; }
        .instituicao-col { width: 20%; }
        .assinatura-col { width: 20%; }
        .linha-assinatura {
          height: 25px;
          border-bottom: 2px solid #000 !important;
          margin-top: 10px;
          display: block;
        }
        .nome-assinatura {
          text-align: center;
          font-size: 11px;
          color: #000 !important;
          margin-top: 3px;
          font-weight: bold;
        }
        .data-local {
          margin-top: 30px;
          text-align: center;
          font-size: 12px;
          color: #000;
        }
        .grupo-header {
          background: #e9ecef !important;
          font-weight: bold;
          font-size: 1.1em;
        }
        
        /* ESTILOS ESPEC√çFICOS PARA IMPRESS√ÉO */
        @media print {
          body { 
            margin: 0; 
            padding: 10px; 
            font-size: 11px;
            -webkit-print-color-adjust: exact !important;
            color-adjust: exact !important;
          }
          .header { 
            margin-bottom: 8px; 
            padding-bottom: 8px;
            border-bottom: 2px solid #000 !important;
          }
          .header h1 {
            margin: 0 0 5px 0;
            font-size: 18px;
          }
          .header .info {
            margin: 3px 0;
          }
          .quorum-info {
            background: #f8f9fa !important;
            -webkit-print-color-adjust: exact !important;
            padding: 5px;
            margin: 5px 0;
          }
          table { 
            border: 1px solid #000 !important;
            font-size: 10px;
            margin-top: 5px;
          }
          th, td { 
            border: 1px solid #000 !important; 
            padding: 6px 4px;
          }
          th { 
            background-color: #f2f2f2 !important; 
            -webkit-print-color-adjust: exact !important;
          }
          .grupo-header {
            background: #e9ecef !important;
            -webkit-print-color-adjust: exact !important;
          }
          .linha-assinatura {
            border-bottom: 2px solid #000 !important;
            height: 18px;
            margin-top: 2px;
            -webkit-print-color-adjust: exact !important;
          }
          .nome-assinatura {
            color: #000 !important;
            font-size: 9px;
            margin-top: 2px;
            -webkit-print-color-adjust: exact !important;
          }
          .data-local {
            margin-top: 10px;
            page-break-inside: avoid;
          }
        }
      </style>
    </head>
    <body>
      <div class="container">
        <div class="header">
          <h1>LISTA DE PRESEN√áA</h1>
          <div class="info">
            <strong>Conselho Consultivo do Delta do Parna√≠ba</strong><br>
            <strong>Data:</strong> ${dataReuniao} | <strong>Local:</strong> ${localReuniao}
          </div>
          <div class="quorum-info">
            <strong>CONTROLE DE QU√ìRUM:</strong> ${totalMembros} presentes de ${totalCadeiras} cadeiras | 
            <strong>QU√ìRUM:</strong> <span id="statusQuorum">CALCULANDO...</span>
          </div>
        </div>
        
        <table>
          <thead>
            <tr>
              <th class="numero-col">#</th>
              <th class="cadeira-col">Cadeira/Setor</th>
              <th class="nome-col">Nome do Conselheiro</th>
              <th class="tipo-col">Tipo</th>
              <th class="instituicao-col">Institui√ß√£o/Entidade</th>
              <th class="assinatura-col">Assinatura</th>
            </tr>
          </thead>
          <tbody>
            ${membros.map((membro, index) => {
              let grupoHeader = '';
              // Adicionar cabe√ßalho de grupo quando mudar
              if (index === 0) {
                grupoHeader = `<tr class="grupo-header"><td colspan="6">PRESID√äNCIA</td></tr>`;
              } else if (membro.ordem.startsWith('1-poder-publico') && !membros[index-1].ordem.startsWith('1-poder-publico')) {
                grupoHeader = `<tr class="grupo-header"><td colspan="6">PODER P√öBLICO</td></tr>`;
              } else if (membro.ordem.startsWith('2-sociedade-civil') && !membros[index-1].ordem.startsWith('2-sociedade-civil')) {
                grupoHeader = `<tr class="grupo-header"><td colspan="6">SOCIEDADE CIVIL</td></tr>`;
              }
              
              return `
                ${grupoHeader}
                <tr>
                  <td class="numero-col">${index + 1}</td>
                  <td class="cadeira-col">${membro.cadeira}</td>
                  <td class="nome-col"><strong>${membro.nome}</strong></td>
                  <td class="tipo-col">${membro.tipo}</td>
                  <td class="instituicao-col">${membro.entidade}</td>
                  <td class="assinatura-col">
                    <div class="linha-assinatura"></div>
                    <div class="nome-assinatura">${membro.nome.split(' ')[0]} ${membro.nome.split(' ').pop()}</div>
                  </td>
                </tr>
              `;
            }).join('')}
          </tbody>
        </table>
        
        <div class="data-local">
          Parna√≠ba, ${dataReuniao}
        </div>
      </div>
    
  

</body>
    </html>
  `;
  
  const janelaImpressao = window.open('', '_blank');
  janelaImpressao.document.write(conteudoHTML);
  janelaImpressao.document.close();
  
  setTimeout(() => {
    janelaImpressao.print();
    setTimeout(() => {
      janelaImpressao.close();
    }, 500);
  }, 1000);
}

// Fun√ß√£o para calcular total de cadeiras
function calcularTotalCadeiras() {
    let total = 0;
    
    // Presid√™ncia conta como 1 cadeira (se tiver membro)
    if (document.querySelectorAll('#presidenciaContainer .membro-linha:not(.vazio)').length > 0) {
        total += 1;
    }
    
    // Poder P√∫blico - cada .cadeira √© uma cadeira
    total += document.querySelectorAll('#poder-publico .cadeira').length;
    
    // Sociedade Civil - cada .cadeira √© uma cadeira
    total += document.querySelectorAll('#sociedade-civil .cadeira').length;
    
    return total;
}
    // ============================================
    // GERAR RELAT√ìRIO DE AN√ÅLISES
    // ============================================
    function gerarRelatorioAnalises() {
  const opcoes = [
    { id: 'presenca', nome: 'üìà Ranking de Presen√ßa' },
    { id: 'composicao', nome: 'üë• Composi√ß√£o do Conselho' },
    { id: 'estados', nome: 'üó∫Ô∏è Distribui√ß√£o por Estados' },
    { id: 'atividades', nome: '‚úÖ Atividades Realizadas' },
    { id: 'todos', nome: '‚úÖ Selecionar Todos' }
  ];
  
  let modalHTML = `
    <div class="modal active" id="modalRelatorioAnalises">
      <div class="modal-content">
        <div class="modal-header">üìÑ Gerar Relat√≥rio de An√°lises</div>
        <p style="margin-bottom: 15px;">Selecione quais an√°lises deseja incluir no relat√≥rio:</p>
        <div style="max-height: 300px; overflow-y: auto; margin-bottom: 20px;">
  `;
  
  opcoes.forEach(opcao => {
    const isTodos = opcao.id === 'todos';
    modalHTML += `
      <div style="margin-bottom: 10px; padding: 8px; background: #f8f9fa; border-radius: 5px;">
        <input type="checkbox" id="relatorio-${opcao.id}" value="${opcao.id}" ${isTodos ? 'onchange="selecionarTodosAnalises(this)"' : ''}>
        <label for="relatorio-${opcao.id}" style="margin-left: 8px; cursor: pointer;">${opcao.nome}</label>
      </div>
    `;
  });
  
  modalHTML += `
        </div>
        <div style="display: flex; gap: 10px; margin-top: 20px;">
          <button class="modal-btn modal-btn-primary" onclick="confirmarGerarRelatorio()" style="flex: 1;">üìÑ Gerar Relat√≥rio</button>
          <button class="modal-btn modal-btn-secondary" onclick="fecharModalRelatorioAnalises()" style="flex: 1;">‚ùå Cancelar</button>
        </div>
      </div>
    </div>
  `;
  
  // Remover modal existente se houver
  const modalExistente = document.getElementById('modalRelatorioAnalises');
  if (modalExistente) {
    modalExistente.remove();
  }
  
  // Adicionar o novo modal ao body
  document.body.insertAdjacentHTML('beforeend', modalHTML);
}

// Fun√ß√£o para selecionar/deselecionar todas as an√°lises
function selecionarTodosAnalises(checkbox) {
  const selecionarTodos = checkbox.checked;
  const checkboxes = document.querySelectorAll('#modalRelatorioAnalises input[type="checkbox"]');
  
  checkboxes.forEach(cb => {
    if (cb.id !== 'relatorio-todos') {
      cb.checked = selecionarTodos;
    }
  });
}

// Fun√ß√£o para fechar o modal de relat√≥rio
function fecharModalRelatorioAnalises() {
  const modal = document.getElementById('modalRelatorioAnalises');
  if (modal) {
    modal.remove();
  }
}

// Fun√ß√£o confirmar gera√ß√£o do relat√≥rio (j√° existe, mas vou garantir que est√° correta)
function confirmarGerarRelatorio() {
  const opcoesSelecionadas = [];
  const checkboxes = document.querySelectorAll('#modalRelatorioAnalises input[type="checkbox"]:checked');
  
  checkboxes.forEach(checkbox => {
    if (checkbox.value !== 'todos') {
      opcoesSelecionadas.push(checkbox.value);
    }
  });
  
  if (opcoesSelecionadas.length === 0) {
    alert('‚ö†Ô∏è Selecione pelo menos uma an√°lise para gerar o relat√≥rio!');
    return;
  }
  
  fecharModalRelatorioAnalises();
  gerarPDFRelatorio(opcoesSelecionadas);
}

function gerarPDFRelatorio(opcoesSelecionadas) {
      const dataAtual = new Date().toLocaleDateString('pt-BR');
      const tituloConselho = document.querySelector('.header h1')?.textContent || 'Conselho Consultivo';
      
      let conteudoHTML = `
        <!DOCTYPE html>
        <html>
        <head>
          <meta charset="UTF-8">
          <title>Relat√≥rio de An√°lises</title>
          <style>
            body { font-family: Arial, sans-serif; margin: 0; padding: 20px; }
            .container { max-width: 100%; }
            .header { text-align: center; margin-bottom: 30px; border-bottom: 2px solid #333; padding-bottom: 20px; }
            .header h1 { margin-bottom: 5px; color: #2c3e50; }
            .header .info { color: #666; }
            .secao { margin-bottom: 30px; break-inside: avoid; }
            .secao h2 { background: #f8f9fa; padding: 10px; border-left: 4px solid #667eea; color: #2c3e50; }
            table { width: 100%; border-collapse: collapse; margin-bottom: 15px; }
            th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
            th { background-color: #f2f2f2; }
            .card { border: 1px solid #ddd; padding: 15px; margin-bottom: 10px; border-radius: 5px; }
            .ranking-item { display: flex; align-items: center; padding: 10px; margin-bottom: 5px; background: #f8f9fa; border-radius: 5px; }
            .footer { text-align: center; margin-top: 30px; color: #666; font-size: 0.9em; border-top: 1px solid #ddd; padding-top: 20px; }
          
    /* DOCUMENT MANAGEMENT STYLES */
    .documentos-container {
      background: white;
      border-radius: 10px;
      padding: 20px;
      max-width: 1200px;
      margin: 70px auto 20px;
      box-shadow: 0 6px 20px rgba(0,0,0,0.2);
    }

    .documentos-header {
      text-align: center;
      margin-bottom: 25px;
      padding-bottom: 15px;
      border-bottom: 3px solid #667eea;
    }

    .documentos-titulo {
      font-size: 2em;
      font-weight: bold;
      color: #2c3e50;
      margin-bottom: 10px;
    }

    .documentos-lista {
      margin-top: 20px;
    }

    /* Item de pasta */
    .pasta-item {
      border-left: 3px solid #667eea;
      padding-left: 15px;
      margin-bottom: 15px;
    }

    .pasta-header {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 12px;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s;
      background: rgba(102, 126, 234, 0.05);
    }

    .pasta-header:hover {
      background: rgba(102, 126, 234, 0.15);
    }

    .pasta-seta {
      font-size: 1.2em;
      transition: transform 0.3s;
      color: #667eea;
      min-width: 20px;
    }

    .pasta-header.active .pasta-seta {
      transform: rotate(90deg);
    }

    .pasta-nome {
      font-size: 1.1em;
      font-weight: bold;
      color: #2c3e50;
      flex: 1;
    }

    .pasta-acoes {
      display: none;
      gap: 5px;
    }

    .edit-mode .pasta-acoes {
      display: flex;
    }

    .btn-doc-action {
      padding: 5px 10px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      font-size: 0.8em;
      transition: all 0.2s;
    }

    .btn-add-item {
      background: #51cf66;
      color: white;
    }

    .btn-add-item:hover {
      background: #40c057;
    }

    .btn-editar-doc {
      background: #ffa726;
      color: white;
    }

    .btn-editar-doc:hover {
      background: #ff9800;
    }

    .btn-remover-doc {
      background: #ff6b6b;
      color: white;
    }

    .btn-remover-doc:hover {
      background: #fa5252;
    }

    .pasta-conteudo {
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.4s ease-out;
      padding-left: 20px;
    }

    .pasta-conteudo.active {
      max-height: 10000px;
      padding-top: 10px;
    }

    /* Item de documento */
    .documento-item {
      padding: 10px 12px;
      border-radius: 6px;
      cursor: pointer;
      transition: all 0.2s;
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 8px;
      background: white;
      border: 1px solid #e0e0e0;
    }

    .documento-item:hover {
      background: #f0f0f0;
      transform: translateX(5px);
      border-color: #667eea;
    }

    .documento-icone {
      font-size: 1.5em;
    }

    .documento-nome {
      flex: 1;
      font-size: 0.95em;
      color: #2c3e50;
    }

    .documento-acoes {
      display: none;
      gap: 5px;
    }

    .edit-mode .documento-acoes {
      display: flex;
    }

    /* Drag & Drop */
    .dragging {
      opacity: 0.5;
    }

  </style>
        </head>
        <body>
          <div class="container">
            <div class="header">
              <h1>${tituloConselho}</h1>
              <div class="info">Relat√≥rio de An√°lises - ${dataAtual}</div>
            </div>
      `;
      
      if (opcoesSelecionadas.includes('presenca')) {
        conteudoHTML += gerarConteudoPresencaRelatorio();
      }
      
      if (opcoesSelecionadas.includes('composicao')) {
        conteudoHTML += gerarConteudoComposicaoRelatorio();
      }
      
      if (opcoesSelecionadas.includes('estados')) {
        conteudoHTML += gerarConteudoEstadosRelatorio();
      }
      
      if (opcoesSelecionadas.includes('atividades')) {
        conteudoHTML += gerarConteudoAtividadesRelatorio();
      }
      
      conteudoHTML += `
            <div class="footer">
              Relat√≥rio gerado automaticamente pelo Sistema de Gest√£o de Conselho Consultivo
            </div>
          </div>
        </body>
        </html>
      `;
      
      const janelaImpressao = window.open('', '_blank');
      janelaImpressao.document.write(conteudoHTML);
      janelaImpressao.document.close();
      janelaImpressao.print();
    }

    function gerarConteudoPresencaRelatorio() {
      const membros = [];
      
      document.querySelectorAll('.membro-linha:not(.vazio)').forEach(membro => {
        const nome = membro.querySelector('.nome-membro')?.textContent || '';
        const entidade = membro.querySelector('.entidade-membro')?.textContent || '';
        const bolinhas = membro.querySelectorAll('.bolinha-presenca');
        
        let presencas = 0;
        let justificadas = 0;
        let faltas = 0;
        
        bolinhas.forEach(b => {
          if(b.classList.contains('verde')) presencas++;
          else if(b.classList.contains('amarelo')) justificadas++;
          else if(b.classList.contains('vermelho')) faltas++;
        });
        
        const score = (presencas * 10) + (justificadas * 5);
        
        if(nome && nome !== 'VAGA' && nome.trim() !== '' && nome !== '-') {
          membros.push({ nome, entidade, presencas, justificadas, faltas, score });
        }
      });
      
      membros.sort((a, b) => b.score - a.score);
      
      let conteudo = `
        <div class="secao">
          <h2>üìà Ranking de Assiduidade</h2>
      `;
      
      if (membros.length === 0) {
        conteudo += '<p>Nenhum registro de presen√ßa encontrado</p>';
      } else {
        conteudo += `
          <table>
            <thead>
              <tr>
                <th width="10%">Posi√ß√£o</th>
                <th width="40%">Nome</th>
                <th width="30%">Institui√ß√£o</th>
                <th width="10%">Presen√ßas</th>
                <th width="10%">Pontua√ß√£o</th>
              </tr>
            </thead>
            <tbody>
              ${membros.map((m, index) => `
                <tr>
                  <td>${index + 1}¬∫</td>
                  <td>${m.nome}</td>
                  <td>${m.entidade}</td>
                  <td>üü¢ ${m.presencas} | üü° ${m.justificadas} | üî¥ ${m.faltas}</td>
                  <td><strong>${m.score} pts</strong></td>
                </tr>
              `).join('')}
            </tbody>
          </table>
        `;
      }
      
      conteudo += '</div>';
      return conteudo;
    }

    function gerarConteudoComposicaoRelatorio() {
  let conteudo = `
    <div class="secao">
      <h2>üë• Composi√ß√£o do Conselho</h2>
  `;
  
  const grupos = [
    { id: 'poder-publico', titulo: '‚öñÔ∏è PODER P√öBLICO' },
    { id: 'sociedade-civil', titulo: 'ü§ù SOCIEDADE CIVIL' }
  ];
  
  let totalMembros = 0;
  
  grupos.forEach(grupoInfo => {
    const grupo = document.getElementById(grupoInfo.id);
    if(!grupo) return;
    
    const setores = grupo.querySelectorAll('.setor');
    
    setores.forEach(setor => {
      const tituloSetor = setor.querySelector('.titulo-setor .editable')?.textContent || 'Setor';
      
      conteudo += `
        <div style="margin-bottom: 25px;">
          <h3 style="color: #495057; margin-bottom: 15px; padding-bottom: 8px; border-bottom: 2px solid #dee2e6;">
            ${grupoInfo.titulo} - ${tituloSetor}
          </h3>
          <div class="card-grid">
      `;
      
      setor.querySelectorAll('.cadeira').forEach(cadeira => {
        const numeroCadeira = cadeira.querySelector('.numero-cadeira')?.textContent || '';
        
        cadeira.querySelectorAll('.membro-linha:not(.vazio)').forEach(membro => {
          totalMembros++;
          const nome = membro.querySelector('.nome-membro')?.textContent || '';
          const entidade = membro.querySelector('.entidade-membro')?.textContent || '';
          const telefone = membro.dataset.telefone || 'N√£o informado';
          const boneco = membro.querySelector('.bonequinho')?.textContent || 'üë§';
          const tipo = membro.classList.contains('titular') ? 'Titular' : 'Suplente';
          
          conteudo += `
            <div class="card">
              <div class="card-header">
                <div class="card-emoji">${boneco}</div>
                <div class="card-nome">${nome}</div>
              </div>
              <div class="card-instituicao">${entidade}</div>
              <div class="card-telefone">üìû ${telefone}</div>
              <div style="margin-top: 8px;">
                <span class="card-tipo">${tipo}</span>
              </div>
              <div style="font-size: 0.7em; color: #868e96; margin-top: 5px;">
                Cadeira: ${numeroCadeira}
              </div>
            </div>
          `;
        });
      });
      
      conteudo += `
          </div>
        </div>
      `;
    });
  });
  
  // Adicionar Presid√™ncia
  const presidenciaContainer = document.getElementById('presidenciaContainer');
  if (presidenciaContainer) {
    const membrosPresidencia = presidenciaContainer.querySelectorAll('.membro-linha:not(.vazio)');
    if (membrosPresidencia.length > 0) {
      conteudo += `
        <div style="margin-bottom: 25px;">
          <h3 style="color: #495057; margin-bottom: 15px; padding-bottom: 8px; border-bottom: 2px solid #dee2e6;">
            üèõÔ∏è PRESID√äNCIA
          </h3>
          <div class="card-grid">
      `;
      
      membrosPresidencia.forEach(membro => {
        totalMembros++;
        const nome = membro.querySelector('.nome-membro')?.textContent || '';
        const entidade = membro.querySelector('.entidade-membro')?.textContent || '';
        const telefone = membro.dataset.telefone || 'N√£o informado';
        const boneco = membro.querySelector('.bonequinho')?.textContent || 'üë§';
        const tipo = 'Presidente';
        
        conteudo += `
          <div class="card">
            <div class="card-header">
              <div class="card-emoji">${boneco}</div>
              <div class="card-nome">${nome}</div>
            </div>
            <div class="card-instituicao">${entidade}</div>
            <div class="card-telefone">üìû ${telefone}</div>
            <div style="margin-top: 8px;">
              <span class="card-tipo" style="background: #ff6b6b;">${tipo}</span>
            </div>
          </div>
        `;
      });
      
      conteudo += `
          </div>
        </div>
      `;
    }
  }
  
  if (totalMembros === 0) {
    conteudo += '<p style="text-align: center; color: #6c757d; font-style: italic;">Nenhum conselheiro cadastrado</p>';
  } else {
    conteudo += `
      <div style="text-align: center; margin-top: 20px; padding: 15px; background: #e3f2fd; border-radius: 8px;">
        <strong>Total de Conselheiros: ${totalMembros}</strong>
      </div>
    `;
  }
  
  conteudo += '</div>';
  return conteudo;
}
    function gerarConteudoEstadosRelatorio() {
      const estados = {};
      
      document.querySelectorAll('.membro-linha:not(.vazio)').forEach(membro => {
        const nome = membro.querySelector('.nome-membro')?.textContent || '';
        const entidade = membro.querySelector('.entidade-membro')?.textContent || '';
        const estado = membro.dataset.estado || '';
        
        if(nome && nome !== 'VAGA' && nome.trim() !== '' && estado) {
          if (!estados[estado]) {
            estados[estado] = [];
          }
          estados[estado].push({ nome, entidade });
        }
      });
      
      let conteudo = `
        <div class="secao">
          <h2>üó∫Ô∏è Distribui√ß√£o por Estados</h2>
      `;
      
      if (Object.keys(estados).length === 0) {
        conteudo += '<p>Nenhum conselheiro com estado definido</p>';
      } else {
        Object.keys(estados).forEach(sigla => {
          const estado = estados[sigla];
          const nomeEstado = obterNomeEstado(sigla);
          
          conteudo += `
            <div style="margin-bottom: 20px;">
              <h3 style="color: #495057; margin-bottom: 10px;">${nomeEstado} (${sigla}) - ${estado.length} membro${estado.length !== 1 ? 's' : ''}</h3>
              <table>
                <thead>
                  <tr>
                    <th width="50%">Nome</th>
                    <th width="50%">Institui√ß√£o</th>
                  </tr>
                </thead>
                <tbody>
                  ${estado.map(m => `
                    <tr>
                      <td>${m.nome}</td>
                      <td>${m.entidade}</td>
                    </tr>
                  `).join('')}
                </tbody>
              </table>
            </div>
          `;
        });
      }
      
      conteudo += '</div>';
      return conteudo;
    }

    function obterNomeEstado(sigla) {
      const estados = {
        'AC': 'Acre', 'AL': 'Alagoas', 'AP': 'Amap√°', 'AM': 'Amazonas',
        'BA': 'Bahia', 'CE': 'Cear√°', 'DF': 'Distrito Federal', 'ES': 'Esp√≠rito Santo',
        'GO': 'Goi√°s', 'MA': 'Maranh√£o', 'MT': 'Mato Grosso', 'MS': 'Mato Grosso do Sul',
        'MG': 'Minas Gerais', 'PA': 'Par√°', 'PB': 'Para√≠ba', 'PR': 'Paran√°',
        'PE': 'Pernambuco', 'PI': 'Piau√≠', 'RJ': 'Rio de Janeiro', 'RN': 'Rio Grande do Norte',
        'RS': 'Rio Grande do Sul', 'RO': 'Rond√¥nia', 'RR': 'Roraima', 'SC': 'Santa Catarina',
        'SP': 'S√£o Paulo', 'SE': 'Sergipe', 'TO': 'Tocantins'
      };
      
      return estados[sigla] || sigla;
    }

    function gerarConteudoAtividadesRelatorio() {
      const atividades = [];
      
      document.querySelectorAll('.atividade-card').forEach(ativ => {
        const titulo = ativ.querySelector('.atividade-titulo')?.textContent || '';
        const info = ativ.querySelector('.atividade-info')?.textContent || '';
        const resultado = ativ.querySelector('.atividade-resultado')?.textContent.replace('üìå ', '') || '';
        const concluida = ativ.dataset.concluida === 'true';
        const prazo = ativ.dataset.prazo || '';
        
        const camara = ativ.closest('.camara');
        const nomeCamara = camara ? camara.querySelector('.camara-nome')?.textContent : 'Geral';
        
        atividades.push({ titulo, info, resultado, concluida, prazo, nomeCamara });
      });
      
      let conteudo = `
        <div class="secao">
          <h2>‚úÖ Atividades Realizadas</h2>
      `;
      
      if (atividades.length === 0) {
        conteudo += '<p>Nenhuma atividade cadastrada</p>';
      } else {
        atividades.forEach(a => {
          // CORRE√á√ÉO DE TIMEZONE: Usar formata√ß√£o sem convers√£o UTC
          const dataFormatada = a.prazo ? formatarDataSemTimezone(a.prazo) : '';
          
          conteudo += `
            <div class="card">
              <strong>${a.titulo}</strong><br>
              <strong>C√¢mara:</strong> ${a.nomeCamara}<br>
              <strong>Prazo:</strong> ${dataFormatada}<br>
              <strong>Status:</strong> ${a.resultado ? (a.concluida ? '‚úÖ CONCLU√çDA' : '‚è≥ N√ÉO CONCLU√çDA') : 'üîì ABERTA'}<br>
              ${a.resultado ? `<strong>Resultado:</strong> ${a.resultado}<br>` : ''}
              ${a.info ? `<strong>Informa√ß√µes:</strong> ${a.info}` : ''}
            </div>
          `;
        });
      }
      
      conteudo += '</div>';
      return conteudo;
    }

    // ============================================
    // SALVAR / CARREGAR JSON
    // ============================================
    function salvarJSON() {
      const dados = {
        versao: '2.2',
        dataExportacao: new Date().toISOString(),
        conselho: {
          titulo: document.querySelector('.header h1')?.textContent || '',
          subtitulo: document.querySelector('.header p')?.textContent || '',
          proximaReuniao: {
            data: document.getElementById('dataProximaReuniao')?.textContent || '',
            local: document.getElementById('localProximaReuniao')?.textContent || ''
          }
        },
        presidencia: extrairPresidencia(),
        grupos: extrairGrupos(),
        camaras: extrairCamaras(),
        documentos: salvarEstruturaDocumentos(),
        confirmacoes: reuniaoAtual ? {
          reuniaoAtual: reuniaoAtual,
          dados: confirmacoesData
        } : null
      };
      
      // Gerar nome din√¢mico do arquivo
      const nomeArquivo = gerarNomeArquivoJSON();
      
      const json = JSON.stringify(dados, null, 2);
      const blob = new Blob([json], { type: 'application/json' });
      const link = document.createElement('a');
      link.href = URL.createObjectURL(blob);
      link.download = nomeArquivo;
      link.click();
      
      alert(`‚úÖ Arquivo salvo: ${nomeArquivo}`);
    }
    
    function gerarNomeArquivoJSON() {
      // Pegar o t√≠tulo da tela principal
      const titulo = document.querySelector('.header h1')?.textContent || 'conselho';
      
      // Extrair a √∫ltima palavra do t√≠tulo
      const palavras = titulo.trim().split(/\s+/);
      let ultimaPalavra = palavras.length > 0 ? palavras[palavras.length - 1] : 'conselho';
      
      // Remover acentos e caracteres especiais
      ultimaPalavra = ultimaPalavra
        .normalize('NFD')
        .replace(/[\u0300-\u036f]/g, '') // Remove acentos
        .replace(/[^a-zA-Z0-9]/g, '') // Remove caracteres especiais
        .toLowerCase();
      
      // Se ficou vazio ap√≥s limpeza, usar 'conselho'
      if (!ultimaPalavra) {
        ultimaPalavra = 'conselho';
      }
      
      // Obter data atual no formato DD_MM_AAAA
      const hoje = new Date();
      const dia = String(hoje.getDate()).padStart(2, '0');
      const mes = String(hoje.getMonth() + 1).padStart(2, '0');
      const ano = hoje.getFullYear();
      const dataFormatada = `${dia}_${mes}_${ano}`;
      
      // Retornar nome no formato: ultimapalavra_DD_MM_AAAA.json
      return `${ultimaPalavra}_${dataFormatada}.json`;
    }

    function extrairPresidencia() {
      const container = document.getElementById('presidenciaContainer');
      const membros = [];
      
      container.querySelectorAll('.membro-linha').forEach(m => {
        membros.push(extrairDadosMembro(m));
      });
      
      return membros;
    }

    function extrairGrupos() {
      const grupos = [];
      
      document.querySelectorAll('.grupo').forEach(grupo => {
        const id = grupo.id;
        const titulo = grupo.querySelector('.titulo-grupo')?.textContent || '';
        const setores = [];
        
        grupo.querySelectorAll('.setor').forEach(setor => {
          const nomeSetor = setor.querySelector('.titulo-setor .editable')?.textContent || '';
          const cadeiras = [];
          
          setor.querySelectorAll('.cadeira').forEach(cadeira => {
            const numero = cadeira.querySelector('.numero-cadeira')?.textContent || '';
            const membros = [];
            
            cadeira.querySelectorAll('.membro-linha').forEach(m => {
              membros.push(extrairDadosMembro(m));
            });
            
            cadeiras.push({ numero, membros });
          });
          
          setores.push({ nome: nomeSetor, cadeiras });
        });
        
        grupos.push({ id, titulo, setores });
      });
      
      return grupos;
    }

    function extrairDadosMembro(membro) {
      const nome = membro.querySelector('.nome-membro')?.textContent || '';
      const entidade = membro.querySelector('.entidade-membro')?.textContent || '';
      const municipio = membro.querySelector('.municipio-membro')?.textContent.replace('üìç ', '') || '';
      const boneco = membro.querySelector('.bonequinho')?.textContent || 'üë§';
      const logo = membro.querySelector('.logo-instituicao')?.textContent || 'üèõÔ∏è';
      const tipo = membro.classList.contains('titular') ? 'titular' : 'suplente';
      const estado = membro.dataset.estado || '';
      const curriculo = membro.dataset.curriculo || '';
      const telefone = membro.dataset.telefone || '';
      const email = membro.dataset.email || '';
      const dataPosse = membro.dataset.dataPosse || '';
      const dataMandato = membro.dataset.dataMandato || '';
      
      const bonecoPossuiImg = membro.querySelector('.bonequinho img');
      const logoPossuiImg = membro.querySelector('.logo-instituicao img');
      
      const presencas = [];
      membro.querySelectorAll('.bolinha-presenca').forEach(b => {
        presencas.push({
          data: b.dataset.data || '',
          dataFormatada: b.dataset.dataFormatada || '',
          local: b.dataset.local || '',
          status: b.dataset.status || 'nao-marcado',
          timestamp: b.dataset.timestamp || ''
        });
      });
      
      return {
        nome, entidade, municipio,
        boneco: bonecoPossuiImg ? bonecoPossuiImg.src : boneco,
        logo: logoPossuiImg ? logoPossuiImg.src : logo,
        tipo, estado, curriculo, telefone, email, dataPosse, dataMandato, presencas
      };
    }

    function extrairCamaras() {
      const camaras = [];
      
      document.querySelectorAll('.camara').forEach(camara => {
        const slug = camara.dataset.camara || '';
        const nome = camara.querySelector('.camara-nome')?.textContent || '';
        const membros = [];
        
        camara.querySelectorAll('.camara-membro').forEach(m => {
          const nomeMembro = m.querySelector('.nome-membro')?.textContent || '';
          const boneco = m.querySelector('.bonequinho')?.textContent || 'üë§';
          membros.push({ nome: nomeMembro, boneco });
        });
        
        const atividades = [];
        camara.querySelectorAll('.camara-atividades .atividade-card').forEach(a => {
          const titulo = a.querySelector('.atividade-titulo')?.textContent || '';
          const info = a.querySelector('.atividade-info')?.textContent || '';
          const resultado = a.querySelector('.atividade-resultado')?.textContent.replace('üìå ', '') || '';
          const prazo = a.dataset.prazo || '';
          const concluida = a.dataset.concluida || 'false';
          atividades.push({ titulo, info, resultado, prazo, concluida });
        });
        
        const gts = [];
        camara.querySelectorAll('.gt-card').forEach(gt => {
          const titulo = gt.querySelector('.gt-titulo')?.textContent || '';
          const responsavel = gt.querySelector('.gt-responsavel')?.textContent.replace('üë§ ', '') || '';
          const objetivo = gt.querySelector('.gt-objetivo')?.textContent.replace('üéØ ', '') || '';
          const resultado = gt.querySelector('.gt-resultado')?.textContent.replace('üìå ', '') || '';
          
          // Extract components from data attribute
          const componentesData = gt.dataset.componentes ? JSON.parse(gt.dataset.componentes) : [];
          
          const atividadesGT = [];
          gt.querySelectorAll('.gt-atividades-internas .atividade-card').forEach(a => {
            const tituloAtiv = a.querySelector('.atividade-titulo')?.textContent || '';
            const infoAtiv = a.querySelector('.atividade-info')?.textContent || '';
            const resultadoAtiv = a.querySelector('.atividade-resultado')?.textContent.replace('üìå ', '') || '';
            const prazoAtiv = a.dataset.prazo || '';
            const concluidaAtiv = a.dataset.concluida || 'false';
            atividadesGT.push({ titulo: tituloAtiv, info: infoAtiv, resultado: resultadoAtiv, prazo: prazoAtiv, concluida: concluidaAtiv });
          });
          
          gts.push({ titulo, responsavel, objetivo, componentes: componentesData, resultado, atividades: atividadesGT });
        });
        
        camaras.push({ slug, nome, membros, atividades, gts });
      });
      
      return camaras;
    }

    function carregarJSON(input) {
      const file = input.files[0];
      if(!file) return;
      
      const reader = new FileReader();
      reader.onload = function(e) {
        try {
          const dados = JSON.parse(e.target.result);
          aplicarDadosJSON(dados);
          alert('‚úÖ JSON carregado com sucesso!');
        } catch(err) {
          alert('‚ùå Erro ao carregar JSON: ' + err.message);
        }
      };
      reader.readAsText(file);
    }

    function aplicarDadosJSON(dados) {
      if(dados.conselho) {
        if(dados.conselho.titulo) document.querySelector('.header h1').textContent = dados.conselho.titulo;
        if(dados.conselho.subtitulo) document.querySelector('.header p').textContent = dados.conselho.subtitulo;
        if(dados.conselho.proximaReuniao) {
          document.getElementById('dataProximaReuniao').textContent = dados.conselho.proximaReuniao.data || '--/--/----';
          document.getElementById('localProximaReuniao').textContent = dados.conselho.proximaReuniao.local || '---';
        }
      }
      
      if(dados.documentos) {
        carregarEstruturaDocumentos(dados);
      }
      
      if(dados.presidencia) {
        const container = document.getElementById('presidenciaContainer');
        container.innerHTML = '';
        dados.presidencia.forEach(m => {
          container.appendChild(criarMembroHTML(m));
        });
      }
      
      if(dados.grupos) {
        dados.grupos.forEach(grupo => {
          const grupoEl = document.getElementById(grupo.id);
          if(!grupoEl) return;
          
          const conteudoGrupo = grupoEl.querySelector('.grupo-conteudo');
          conteudoGrupo.querySelectorAll('.setor').forEach(s => s.remove());
          
          grupo.setores.forEach(setor => {
            const setorEl = document.createElement('div');
            setorEl.className = 'setor';
            setorEl.innerHTML = `
              <div class="setor-header-wrapper" onclick="toggleSetor(this)">
                <div class="setor-seta">‚ñº</div>
                <div class="titulo-setor">
                  <span class="editable" contenteditable="false">${setor.nome}</span>
                  <span class="contador-cadeiras">0 cadeiras</span>
                  <button class="btn-remove" onclick="event.stopPropagation(); removerSetor(this)">üóëÔ∏è</button>
                </div>
              </div>
              <div class="setor-conteudo">
                <button class="btn-add-cadeira" onclick="adicionarCadeira(this)">‚ûï Cadeira</button>
              </div>
            `;
            
            const btnAddSetor = conteudoGrupo.querySelector('.btn-add-setor');
            conteudoGrupo.insertBefore(setorEl, btnAddSetor);
            
            setor.cadeiras.forEach(cadeira => {
              const cadeiraEl = document.createElement('div');
              cadeiraEl.className = 'cadeira';
              cadeiraEl.innerHTML = `
                <div class="cadeira-header">
                  <span class="icone-cadeira">ü™ë</span>
                  <span class="numero-cadeira">${cadeira.numero}</span>
                  <button class="btn-remove" onclick="removerCadeira(this)">üóëÔ∏è</button>
                </div>
                <div class="cadeira-membros-container"></div>
                <button class="btn-add-membro" onclick="abrirModalAdicionarMembro(this)">‚ûï Adicionar Membro</button>
              `;
              
              const setorConteudo = setorEl.querySelector('.setor-conteudo');
              const btnAddCadeira = setorConteudo.querySelector('.btn-add-cadeira');
              setorConteudo.insertBefore(cadeiraEl, btnAddCadeira);
              
              const membroContainer = cadeiraEl.querySelector('.cadeira-membros-container');
              cadeira.membros.forEach(m => {
                membroContainer.appendChild(criarMembroHTML(m));
              });
            });
            
            atualizarContadorCadeiras(setorEl);
          });
          
          atualizarContadoresGrupo(grupo.id);
        });
      }
      
      if(dados.camaras) {
        const grid = document.getElementById('camarasGrid');
        grid.innerHTML = '';
        
        dados.camaras.forEach(camara => {
          const camaraEl = document.createElement('div');
          camaraEl.className = 'camara';
          camaraEl.dataset.camara = camara.slug;
          camaraEl.innerHTML = `
            <div class="camara-header">
              <div class="camara-nome">${camara.nome}</div>
              <div class="camara-contador">0 membros</div>
              <button class="btn-editar-nome-camara" onclick="editarNomeCamara(this)">‚úèÔ∏è</button>
              <button class="btn-remover-camara" onclick="removerCamara(this)">üóëÔ∏è</button>
            </div>
            <div class="camara-membros"></div>
            <div class="camara-atividades"></div>
            <div class="camara-gts"></div>
            <button class="btn-add-atividade" onclick="abrirModalAdicionarAtividade(this, false)">‚úÖ Atividade</button>
            <button class="btn-add-gt" onclick="abrirModalCriarGT(this)">üìã GT</button>
          `;
          
          grid.appendChild(camaraEl);
          
          const membrosContainer = camaraEl.querySelector('.camara-membros');
          camara.membros.forEach(m => {
            const membroEl = document.createElement('div');
            membroEl.className = 'camara-membro';
            membroEl.innerHTML = `
              <span class="bonequinho">${m.boneco}</span>
              <div class="nome-membro">${m.nome}</div>
              <button class="btn-remove" onclick="removerMembroCamara(this)">üóëÔ∏è</button>
            `;
            membrosContainer.appendChild(membroEl);
          });
          
          const atividadesContainer = camaraEl.querySelector('.camara-atividades');
          camara.atividades.forEach(a => {
            const ativEl = document.createElement('div');
            ativEl.className = 'atividade-card';
            ativEl.dataset.prazo = a.prazo;
            ativEl.dataset.concluida = a.concluida;
            ativEl.innerHTML = `
              <div class="atividade-titulo">${a.titulo}</div>
              <div class="atividade-info">${a.info}</div>
              ${a.resultado ? `<div class="atividade-resultado">üìå ${a.resultado}</div>` : ''}
              ${a.resultado ? `<div class="atividade-status ${a.concluida === 'true' ? 'concluida' : 'nao-concluida'}">${a.concluida === 'true' ? '‚úÖ CONCLU√çDA' : '‚è≥ N√ÉO CONCLU√çDA'}</div>` : ''}
              <button class="btn-edit-atividade" onclick="editarAtividade(this)">‚úèÔ∏è</button>
              <button class="btn-remove" onclick="removerAtividade(this)">üóëÔ∏è</button>
            `;
            atividadesContainer.appendChild(ativEl);
          });
          
          const gtsContainer = camaraEl.querySelector('.camara-gts');
          camara.gts.forEach(gt => {
            const gtEl = document.createElement('div');
            gtEl.className = 'gt-card';
            
            // Store components in data attribute
            if (gt.componentes && Array.isArray(gt.componentes)) {
              gtEl.dataset.componentes = JSON.stringify(gt.componentes);
            }
            
            // Generate components HTML
            let componentesHTML = '';
            if (gt.componentes && Array.isArray(gt.componentes) && gt.componentes.length > 0) {
              componentesHTML = gt.componentes.map(c => 
                `<div style="display: flex; align-items: center; gap: 8px; margin: 4px 0;">
                  <span style="font-size: 1.5em;">üë§</span>
                  <div style="flex: 1;">
                    <div style="font-weight: bold; font-size: 0.85em;">${c.nome}</div>
                    <div style="font-size: 0.75em; color: #6c757d; font-style: italic;">${c.instituicao}</div>
                  </div>
                </div>`
              ).join('');
            }
            
            gtEl.innerHTML = `
              <div class="gt-titulo editable" contenteditable="false">${gt.titulo}</div>
              <div class="gt-responsavel editable" contenteditable="false">üë§ ${gt.responsavel}</div>
              <div class="gt-objetivo editable" contenteditable="false">üéØ ${gt.objetivo}</div>
              ${componentesHTML ? `
                <button class="btn-ver-componentes" onclick="toggleComponentes(this)">üë• Ver Componentes</button>
                <div class="gt-componentes show">${componentesHTML}</div>
              ` : ''}
              ${gt.resultado ? `<div class="gt-resultado">üìå ${gt.resultado}</div>` : ''}
              <div class="gt-atividades-internas"></div>
              <button class="btn-edit-gt" onclick="editarGT(this)">‚úèÔ∏è Editar</button>
              <button class="btn-add-atividade" onclick="abrirModalAdicionarAtividade(this, true)">‚úÖ Atividade GT</button>
              <button class="btn-remove" onclick="removerGT(this)">üóëÔ∏è</button>
            `;
            
            gtsContainer.appendChild(gtEl);
            
            const atividadesGT = gtEl.querySelector('.gt-atividades-internas');
            if(gt.atividades) {
              gt.atividades.forEach(a => {
                const ativEl = document.createElement('div');
                ativEl.className = 'atividade-card';
                ativEl.dataset.prazo = a.prazo;
                ativEl.dataset.concluida = a.concluida;
                ativEl.innerHTML = `
                  <div class="atividade-titulo">${a.titulo}</div>
                  <div class="atividade-info">${a.info}</div>
                  ${a.resultado ? `<div class="atividade-resultado">üìå ${a.resultado}</div>` : ''}
                  ${a.resultado ? `<div class="atividade-status ${a.concluida === 'true' ? 'concluida' : 'nao-concluida'}">${a.concluida === 'true' ? '‚úÖ CONCLU√çDA' : '‚è≥ N√ÉO CONCLU√çDA'}</div>` : ''}
                  <button class="btn-edit-atividade" onclick="editarAtividade(this)">‚úèÔ∏è</button>
                  <button class="btn-remove" onclick="removerAtividade(this)">üóëÔ∏è</button>
                `;
                atividadesGT.appendChild(ativEl);
              });
            }
          });
          
          atualizarContadorCamara(camaraEl);
        });
      }
      
      // Carregar confirma√ß√µes se existir
      if (dados.confirmacoes) {
        if (dados.confirmacoes.reuniaoAtual) {
          reuniaoAtual = dados.confirmacoes.reuniaoAtual;
        }
        if (dados.confirmacoes.dados) {
          confirmacoesData = dados.confirmacoes.dados;
        }
      }
      
      configurarDragAndDrop();
    }

    function criarMembroHTML(m) {
      const membro = document.createElement('div');
      membro.className = `membro-linha ${m.tipo}`;
      membro.draggable = true;
      membro.dataset.id = `membro-${Date.now()}-${Math.random()}`;
      membro.dataset.estado = m.estado || '';
      membro.dataset.curriculo = m.curriculo || '';
      membro.dataset.telefone = m.telefone || '';
      membro.dataset.email = m.email || '';
      membro.dataset.dataPosse = m.dataPosse || '';
      membro.dataset.dataMandato = m.dataMandato || '';
      
      const boneco = m.boneco && m.boneco.startsWith('data:') ? `<img src="${m.boneco}" alt="foto">` : m.boneco;
      const logo = m.logo && m.logo.startsWith('data:') ? `<img src="${m.logo}" alt="logo">` : m.logo;
      
      membro.innerHTML = `
        <div class="membro-linha-top" onclick="editarMembroCompleto(this)">
          <div class="avatar-container">
            <span class="bonequinho" onclick="event.stopPropagation(); abrirEscolherEmoji(this, 'pessoa')">${boneco}</span>
            <span class="logo-instituicao" onclick="event.stopPropagation(); abrirEscolherEmoji(this, 'logo')">${logo}</span>
          </div>
          <span class="etiqueta-cargo ${m.tipo}">${m.tipo === 'titular' ? 'Titular' : 'Suplente'}</span>
          <div class="info-membro">
            <div class="nome-membro">${m.nome}</div>
            <div class="entidade-membro">${m.entidade || '-'}</div>
            <div class="municipio-membro">üìç ${m.municipio || '-'}</div>
            <button class="btn-ver-curriculo" onclick="event.stopPropagation(); verEditarCurriculo(this)"></button>
          </div>
        </div>
        <div class="presenca-container">
          <span class="presenca-label">Presen√ßas:</span>
        </div>
        <button class="btn-remove" onclick="removerMembro(this)" style="margin-top:5px;">üóëÔ∏è Remover</button>
      `;
      
      const presencaContainer = membro.querySelector('.presenca-container');
      if(m.presencas) {
        const presencasOrdenadas = m.presencas.sort((a, b) => (b.timestamp || 0) - (a.timestamp || 0));
        const presencasRecentes = presencasOrdenadas.slice(0, 5);
        
        presencasRecentes.forEach(p => {
          const bolinha = document.createElement('div');
          bolinha.className = 'bolinha-presenca';
          bolinha.dataset.data = p.data;
          bolinha.dataset.dataFormatada = p.dataFormatada;
          bolinha.dataset.local = p.local;
          bolinha.dataset.timestamp = p.timestamp;
          bolinha.dataset.status = p.status;
          bolinha.title = `${p.dataFormatada} - ${p.local}`;
          
          if(p.status === 'presente') bolinha.classList.add('verde');
          else if(p.status === 'justificado') bolinha.classList.add('amarelo');
          else if(p.status === 'faltou') bolinha.classList.add('vermelho');
          
          if(modoEdicao) {
            bolinha.onclick = function() { editarBolinhaPresenca(this); };
          }
          
          presencaContainer.appendChild(bolinha);
        });
      }
      
      return membro;
    }

    function limparConselho() {
      if(!confirm('‚ö†Ô∏è ATEN√á√ÉO!\n\nIsso ir√° APAGAR TODOS OS DADOS do conselho!\n\nDeseja continuar?')) {
        return;
      }
      
      if(!confirm('üö® √öLTIMA CONFIRMA√á√ÉO!\n\nTodos os membros, setores, cadeiras e c√¢maras ser√£o PERMANENTEMENTE APAGADOS!\n\nTem certeza absoluta?')) {
        return;
      }
      
      document.getElementById('presidenciaContainer').innerHTML = '';
      
      document.querySelectorAll('.grupo').forEach(grupo => {
        const conteudoGrupo = grupo.querySelector('.grupo-conteudo');
        conteudoGrupo.querySelectorAll('.setor').forEach(s => s.remove());
        atualizarContadoresGrupo(grupo.id);
      });
      
      document.getElementById('camarasGrid').innerHTML = '';
      
      document.getElementById('dataProximaReuniao').textContent = '--/--/----';
      document.getElementById('localProximaReuniao').textContent = '---';
      
      toggleMenu();
      alert('‚úÖ Conselho limpo com sucesso!\n\nAgora voc√™ tem um sistema vazio pronto para cadastrar novos dados.');
    }

    // ============================================
    // SALVAR HTML
    // ============================================
    function salvarHTML() {
        // Primeiro, embute os dados dos documentos no HTML
        let scriptEmbarcado = document.getElementById('dados-documentos-embarcados');
        if (!scriptEmbarcado) {
            scriptEmbarcado = document.createElement('script');
            scriptEmbarcado.type = 'application/json';
            scriptEmbarcado.id = 'dados-documentos-embarcados';
            document.body.appendChild(scriptEmbarcado);
        }
        
        // Serializa os dados dos documentos
        const dadosParaEmbarcar = {
            documentos: salvarEstruturaDocumentos()
        };
        
        scriptEmbarcado.textContent = JSON.stringify(dadosParaEmbarcar, null, 2);
        
        // Agora salva o HTML completo com os dados embarcados
        const htmlContent = document.documentElement.outerHTML;
        
        const blob = new Blob([htmlContent], { type: 'text/html' });
        const link = document.createElement('a');
        link.href = URL.createObjectURL(blob);
        
        const dataAtual = new Date().toISOString().slice(0, 10);
        link.download = `conselho_completo_${dataAtual}.html`;
        
        link.click();
        
        alert('‚úÖ HTML completo exportado com sucesso!\n\nüìÅ Arquivo: ' + link.download + 
              '\n\nüí° Voc√™ pode:' +
              '\n‚Ä¢ Publicar este arquivo na web' +
              '\n‚Ä¢ Continuar editando normalmente' +
              '\n‚Ä¢ Carregar JSON posteriormente para atualizar os dados' +
              '\n‚Ä¢ Todas as fun√ß√µes de edi√ß√£o permanecem dispon√≠veis' +
              '\n‚Ä¢ Os documentos foram salvos e ser√£o restaurados automaticamente');
    }

    function carregarJSONExemplo() {
      const dadosExemplo = {
        versao: '2.2',
        dataExportacao: new Date().toISOString(),
        conselho: {
          titulo: 'Conselho Consultivo do Delta do Parna√≠ba',
          subtitulo: 'Gest√£o Participativa para o Desenvolvimento Sustent√°vel',
          proximaReuniao: {
            data: '15/03/2024',
            local: 'Parna√≠ba/PI'
          }
        },
        presidencia: [
          {
            nome: 'Dr. Carlos Silva',
            entidade: 'Universidade Federal do Delta',
            municipio: 'Parna√≠ba/PI',
            boneco: 'üë®‚Äçüè´',
            logo: 'üèõÔ∏è',
            tipo: 'titular',
            estado: 'PI',
            curriculo: 'Doutor em Gest√£o Ambiental, professor universit√°rio com 15 anos de experi√™ncia.',
            telefone: '(86) 99999-9999',
            email: 'carlos.silva@ufd.edu.br',
            dataPosse: '2023-01-15',
            dataMandato: '2025-01-15',
            presencas: []
          }
        ],
        grupos: [
          {
            id: 'poder-publico',
            titulo: '‚öñÔ∏è PODER P√öBLICO',
            setores: [
              {
                nome: 'Governo Federal',
                cadeiras: [
                  {
                    numero: 'Cadeira 1',
                    membros: [
                      {
                        nome: 'Maria Santos',
                        entidade: 'MMA - Minist√©rio do Meio Ambiente',
                        municipio: 'Bras√≠lia/DF',
                        boneco: 'üë©‚Äçüíº',
                        logo: 'üèõÔ∏è',
                        tipo: 'titular',
                        estado: 'DF',
                        curriculo: 'Engenheira ambiental, servidora p√∫blica federal h√° 8 anos.',
                        telefone: '(61) 88888-8888',
                        email: 'maria.santos@mma.gov.br',
                        dataPosse: '2023-02-01',
                        dataMandato: '2025-02-01',
                        presencas: []
                      }
                    ]
                  }
                ]
              }
            ]
          }
        ],
        camaras: [
          {
            slug: 'educacao-ambiental',
            nome: 'üìö Educa√ß√£o Ambiental',
            membros: [],
            atividades: [],
            gts: []
          }
        ]
      };
      
      aplicarDadosJSON(dadosExemplo);
      toggleMenu();
      alert('‚úÖ Dados de exemplo carregados com sucesso!');
    }

    // ============================================
    // PALETA DE CORES
    // ============================================
    function abrirPaletaCores() {
      toggleMenu();
      document.getElementById('modalPaletaCores').classList.add('active');
    }

    function mudarCorFundo(gradiente) {
      document.body.style.background = gradiente;
      fecharModal('modalPaletaCores');
    }

    // ============================================
    // EASTER EGG - RESET SISTEMA
    // ============================================
    function resetarSistemaCompleto() {
      if (!modoEdicao) return;
      document.getElementById('modalResetSistema').classList.add('active');
    }

    function confirmarResetSistema() {
      localStorage.clear();
      fecharModal('modalResetSistema');
      alert('‚úÖ Sistema resetado com sucesso!\n\nRecarregando p√°gina...');
      setTimeout(() => {
        location.reload();
      }, 500);
    }

    // ============================================
    // INICIALIZA√á√ÉO
    // ============================================
    document.addEventListener('DOMContentLoaded', function() {
      // For√ßa o menu a sempre iniciar fechado
      const menuDropdown = document.getElementById('menuDropdown');
      if (menuDropdown) {
        menuDropdown.classList.remove('active');
      }
      
      configurarDragAndDrop();
      colapsarTudo();
      
      const style = document.createElement('style');
      style.textContent = `
        .bolinha-grande.selecionado {
          transform: scale(1.3);
          box-shadow: 0 0 10px rgba(0,0,0,0.5);
        }
      `;
      document.head.appendChild(style);
      
      const inputNomeCamara = document.getElementById('inputNomeCamara');
      const inputEmojiCamara = document.getElementById('inputEmojiCamara');
      
      if (inputNomeCamara) {
        inputNomeCamara.addEventListener('input', atualizarPreviewEmoji);
      }
      
      if (inputEmojiCamara) {
        inputEmojiCamara.addEventListener('input', atualizarPreviewEmoji);
      }
      
      document.getElementById('inputSenha').addEventListener('keypress', function(e) {
        if(e.key === 'Enter') verificarSenha();
      });
      
      // Easter Egg - palavra secreta
      const palavraSecreta = document.getElementById('palavraSecreta');
      if (palavraSecreta) {
        palavraSecreta.addEventListener('click', resetarSistemaCompleto);
      }
      
      // Carregar documentos embarcados (se houver)
      carregarDocumentosEmbarcados();
      
      console.log('‚úÖ Sistema de Gest√£o de Conselho Consultivo v2.3 - COMPLETO - Carregado com sucesso!');
    });
  
    // ==========================================
    // DOCUMENT MANAGEMENT FUNCTIONS
    // ==========================================

    function carregarDocumentosIniciais() {
      documentosData.estrutura = [
        {
          id: 'pasta-1',
          tipo: 'pasta',
          nome: 'Legisla√ß√£o',
          ordem: 1,
          filhos: [
            {
              id: 'doc-1',
              tipo: 'documento',
              nome: 'Decreto de Cria√ß√£o da APA',
              link: 'https://example.com/decreto.pdf',
              ordem: 1
            }
          ]
        }
      ];
    }

    function renderizarDocumentos() {
      const container = document.getElementById('documentosLista');
      
      if(!documentosData.estrutura || documentosData.estrutura.length === 0) {
        container.innerHTML = '<div class="mensagem-vazio-docs">üì≠ Nenhum documento cadastrado</div>';
        return;
      }
      
      container.innerHTML = '';
      
      // Ordenar estrutura por ordem antes de renderizar
      const estruturaOrdenada = [...documentosData.estrutura].sort((a, b) => (a.ordem || 999) - (b.ordem || 999));
      
      estruturaOrdenada.forEach(item => {
        container.appendChild(criarElementoItem(item, null));
      });
      
      // Configurar drag and drop ap√≥s renderizar
      setTimeout(() => {
        configurarDragDropDocumentos();
      }, 100);
    }

    function criarElementoItem(item, pastaParenteId) {
      if(!item) return null; // Safety check
      
      if(item.tipo === 'pasta') {
        return criarElementoPasta(item, pastaParenteId);
      } else {
        return criarElementoDocumento(item, pastaParenteId);
      }
    }

    function criarElementoPasta(pasta, pastaParenteId) {
      const pastaDiv = document.createElement('div');
      pastaDiv.className = 'pasta-item';
      pastaDiv.dataset.id = pasta.id;
      pastaDiv.dataset.tipo = 'pasta';
      
      // Header da pasta
      const headerDiv = document.createElement('div');
      headerDiv.className = 'pasta-header';
      headerDiv.onclick = () => togglePasta(pasta.id);
      
      const seta = document.createElement('span');
      seta.className = 'pasta-seta';
      seta.textContent = '‚ñ∂';
      
      const icone = document.createElement('span');
      icone.className = 'pasta-nome';
      icone.textContent = 'üìÇ';
      
      const nome = document.createElement('span');
      nome.textContent = pasta.nome;
      
      const acoes = document.createElement('div');
      acoes.className = 'pasta-acoes';
      acoes.innerHTML = `
        <button class="btn-doc-action btn-add-item" onclick="event.stopPropagation(); abrirModalAdicionarItem('${pasta.id}')">‚ûï Adicionar</button>
        <button class="btn-doc-action btn-editar-doc" onclick="event.stopPropagation(); editarPasta('${pasta.id}')">‚úèÔ∏è</button>
        <button class="btn-doc-action btn-remover-doc" onclick="event.stopPropagation(); removerItem('${pasta.id}')">üóëÔ∏è</button>
      `;
      
      headerDiv.appendChild(seta);
      headerDiv.appendChild(icone);
      headerDiv.appendChild(nome);
      headerDiv.appendChild(acoes);
      
      // Conte√∫do da pasta
      const conteudoDiv = document.createElement('div');
      conteudoDiv.className = 'pasta-conteudo';
      conteudoDiv.dataset.id = pasta.id;
      
      if(pasta.filhos && pasta.filhos.length > 0) {
        // Ordenar filhos por ordem antes de renderizar
        const filhosOrdenados = [...pasta.filhos].sort((a, b) => (a.ordem || 999) - (b.ordem || 999));
        filhosOrdenados.forEach(filho => {
          conteudoDiv.appendChild(criarElementoItem(filho, pasta.id));
        });
      }
      
      pastaDiv.appendChild(headerDiv);
      pastaDiv.appendChild(conteudoDiv);
      
      return pastaDiv;
    }

    function criarElementoDocumento(doc, pastaParenteId) {
      const docDiv = document.createElement('div');
      docDiv.className = 'documento-item';
      docDiv.dataset.id = doc.id;
      docDiv.dataset.tipo = 'documento';
      docDiv.onclick = () => abrirDocumento(doc.link);
      
      const icone = document.createElement('span');
      icone.className = 'documento-icone';
      icone.textContent = 'üìÑ';
      
      const nome = document.createElement('span');
      nome.className = 'documento-nome';
      nome.textContent = doc.nome;
      
      const acoes = document.createElement('div');
      acoes.className = 'documento-acoes';
      acoes.innerHTML = `
        <button class="btn-doc-action btn-editar-doc" onclick="event.stopPropagation(); editarDocumento('${doc.id}', '${pastaParenteId || ''}')">‚úèÔ∏è</button>
        <button class="btn-doc-action btn-remover-doc" onclick="event.stopPropagation(); removerItem('${doc.id}', '${pastaParenteId || ''}')">üóëÔ∏è</button>
      `;
      
      docDiv.appendChild(icone);
      docDiv.appendChild(nome);
      docDiv.appendChild(acoes);
      
      return docDiv;
    }

    function togglePasta(pastaId) {
      const pasta = document.querySelector(`.pasta-item[data-id="${pastaId}"]`);
      if(!pasta) return;
      
      const header = pasta.querySelector('.pasta-header');
      const conteudo = pasta.querySelector('.pasta-conteudo');
      
      header.classList.toggle('active');
      conteudo.classList.toggle('active');
    }

    function abrirDocumento(link) {
      if(!link) return;
      window.open(link, '_blank', 'noopener,noreferrer');
    }

    function abrirModalCriarPasta(pastaParenteId = null) {
      if(!modoEdicao) {
        alert('‚ö†Ô∏è Ative o modo de edi√ß√£o primeiro!');
        return;
      }
      
      pastaAtualEdicao = null;
      pastaParenteAtual = pastaParenteId;
      document.getElementById('tituloCriarPasta').textContent = 'Criar Nova Pasta';
      document.getElementById('inputNomePasta').value = '';
      document.getElementById('modalCriarPasta').classList.add('active');
    }

    function abrirModalAdicionarItem(pastaId) {
      if(!modoEdicao) return;
      
      pastaParenteAtual = pastaId;
      document.getElementById('modalEscolherTipoItem').classList.add('active');
    }

    function abrirModalAdicionarDocumento(pastaId) {
      if(!modoEdicao) {
        alert('‚ö†Ô∏è Ative o modo de edi√ß√£o primeiro!');
        return;
      }
      
      itemAtualEdicao = null;
      pastaParenteAtual = pastaId;
      document.getElementById('tituloAdicionarDoc').textContent = 'Adicionar Documento';
      document.getElementById('inputNomeDocumento').value = '';
      document.getElementById('inputLinkDocumento').value = '';
      document.getElementById('modalAdicionarDocumento').classList.add('active');
    }

    function escolherTipoItem(tipo) {
      fecharModal('modalEscolherTipoItem');
      
      if(tipo === 'pasta') {
        abrirModalCriarPasta(pastaParenteAtual);
      } else if(tipo === 'documento') {
        abrirModalAdicionarDocumento(pastaParenteAtual);
      }
    }

    function editarPasta(pastaId) {
      if(!modoEdicao) return;
      
      const pasta = encontrarItemPorId(documentosData.estrutura, pastaId);
      if(!pasta) return;
      
      pastaAtualEdicao = pasta;
      document.getElementById('tituloCriarPasta').textContent = 'Editar Pasta';
      document.getElementById('inputNomePasta').value = pasta.nome;
      document.getElementById('modalCriarPasta').classList.add('active');
    }

    function editarDocumento(docId, pastaParenteId) {
      if(!modoEdicao) return;
      
      const doc = encontrarItemPorId(documentosData.estrutura, docId);
      if(!doc) return;
      
      itemAtualEdicao = doc;
      pastaParenteAtual = pastaParenteId;
      document.getElementById('tituloAdicionarDoc').textContent = 'Editar Documento';
      document.getElementById('inputNomeDocumento').value = doc.nome;
      document.getElementById('inputLinkDocumento').value = doc.link;
      document.getElementById('modalAdicionarDocumento').classList.add('active');
    }

    function confirmarCriarPasta() {
      const nome = document.getElementById('inputNomePasta').value.trim();
      
      if(!nome) {
        alert('‚ö†Ô∏è Digite um nome para a pasta!');
        return;
      }
      
      if(pastaAtualEdicao) {
        // Editando pasta existente
        pastaAtualEdicao.nome = nome;
        alert('‚úÖ Pasta atualizada!');
      } else {
        // Criando nova pasta
        const novaPasta = {
          id: 'pasta-' + Date.now(),
          tipo: 'pasta',
          nome: nome,
          ordem: 999,
          filhos: []
        };
        
        if(pastaParenteAtual) {
          // Adicionar como subpasta
          const pastaParente = encontrarItemPorId(documentosData.estrutura, pastaParenteAtual);
          if(pastaParente) {
            pastaParente.filhos.push(novaPasta);
          }
        } else {
          // Adicionar na raiz
          documentosData.estrutura.push(novaPasta);
        }
        
        alert('‚úÖ Pasta criada!');
      }
      
      fecharModal('modalCriarPasta');
      renderizarDocumentos();
    }

    function confirmarAdicionarDocumento() {
      const nome = document.getElementById('inputNomeDocumento').value.trim();
      const link = document.getElementById('inputLinkDocumento').value.trim();
      
      if(!nome) {
        alert('‚ö†Ô∏è Digite um nome para o documento!');
        return;
      }
      
      if(!link) {
        alert('‚ö†Ô∏è Digite a URL do documento!');
        return;
      }
      
      // Validar URL b√°sica
      if(!link.startsWith('http://') && !link.startsWith('https://')) {
        alert('‚ö†Ô∏è URL inv√°lida! Deve come√ßar com http:// ou https://');
        return;
      }
      
      if(itemAtualEdicao) {
        // Editando documento existente
        itemAtualEdicao.nome = nome;
        itemAtualEdicao.link = link;
        alert('‚úÖ Documento atualizado!');
      } else {
        // Criando novo documento
        const novoDoc = {
          id: 'doc-' + Date.now(),
          tipo: 'documento',
          nome: nome,
          link: link,
          ordem: 999
        };
        
        if(pastaParenteAtual) {
          // Adicionar em pasta espec√≠fica
          const pastaParente = encontrarItemPorId(documentosData.estrutura, pastaParenteAtual);
          if(pastaParente) {
            pastaParente.filhos.push(novoDoc);
          }
        } else {
          // Adicionar na raiz
          documentosData.estrutura.push(novoDoc);
        }
        
        alert('‚úÖ Documento criado!');
      }
      
      fecharModal('modalAdicionarDocumento');
      renderizarDocumentos();
    }

    function encontrarItemPorId(estrutura, id) {
      for(let item of estrutura) {
        if(item.id === id) return item;
        
        if(item.filhos && item.filhos.length > 0) {
          const encontrado = encontrarItemPorId(item.filhos, id);
          if(encontrado) return encontrado;
        }
      }
      return null;
    }

    function removerItem(itemId, pastaParenteId) {
      if(!modoEdicao) return;
      
      const item = encontrarItemPorId(documentosData.estrutura, itemId);
      if(!item) return;
      
      let mensagem = '‚ùì Remover este ';
      mensagem += item.tipo === 'pasta' ? 'pasta' : 'documento';
      mensagem += '?';
      
      if(item.tipo === 'pasta' && item.filhos && item.filhos.length > 0) {
        mensagem = '‚ö†Ô∏è Esta pasta cont√©m ' + item.filhos.length + ' item(ns).\n\nDeseja realmente remover?';
      }
      
      if(!confirm(mensagem)) return;
      
      if(pastaParenteId) {
        // Remover de pasta espec√≠fica
        const pastaParente = encontrarItemPorId(documentosData.estrutura, pastaParenteId);
        if(pastaParente) {
          pastaParente.filhos = pastaParente.filhos.filter(f => f.id !== itemId);
        }
      } else {
        // Remover da raiz
        documentosData.estrutura = documentosData.estrutura.filter(f => f.id !== itemId);
      }
      
      alert('‚úÖ Item removido!');
      renderizarDocumentos();
    }

    function salvarEstruturaDocumentos() {
      return documentosData;
    }

    function carregarEstruturaDocumentos(dados) {
      if(dados && dados.documentos) {
        documentosData = dados.documentos;
        renderizarDocumentos();
      }
    }

    function carregarDocumentosEmbarcados() {
      // Tenta carregar dados embarcados do script no HTML
      const scriptEmbarcado = document.getElementById('dados-documentos-embarcados');
      if (scriptEmbarcado && scriptEmbarcado.textContent) {
        try {
          const dados = JSON.parse(scriptEmbarcado.textContent);
          if (dados && dados.documentos && dados.documentos.estrutura && dados.documentos.estrutura.length > 0) {
            console.log('üìÑ Carregando documentos embarcados...', dados.documentos);
            documentosData = dados.documentos;
            // N√£o renderizar aqui, ser√° feito quando o usu√°rio abrir a tela de documentos
          }
        } catch (e) {
          console.log('‚ÑπÔ∏è Nenhum dado de documento embarcado encontrado ou formato inv√°lido');
        }
      }
    }

    // ==========================================
    // DRAG & DROP PARA DOCUMENTOS
    // ==========================================
    
    let itemArrastadoDoc = null;
    let indexArrastadoDoc = null;
    let pastaParenteArrastado = null;
    
    function configurarDragDropDocumentos() {
      if (!modoEdicao) return;
      
      // Configurar drag para todos os itens (pastas e documentos)
      const pastasItens = document.querySelectorAll('.pasta-item');
      const docItens = document.querySelectorAll('.documento-item');
      
      pastasItens.forEach((pasta, index) => {
        pasta.draggable = true;
        pasta.dataset.index = index;
        pasta.addEventListener('dragstart', handleDragStartDoc);
        pasta.addEventListener('dragend', handleDragEndDoc);
        pasta.addEventListener('dragover', handleDragOverDoc);
        pasta.addEventListener('drop', handleDropDoc);
        pasta.addEventListener('dragenter', handleDragEnterDoc);
        pasta.addEventListener('dragleave', handleDragLeaveDoc);
      });
      
      docItens.forEach((doc, index) => {
        doc.draggable = true;
        doc.dataset.index = index;
        doc.addEventListener('dragstart', handleDragStartDoc);
        doc.addEventListener('dragend', handleDragEndDoc);
        doc.addEventListener('dragover', handleDragOverDoc);
        doc.addEventListener('drop', handleDropDoc);
      });
      
      // Configurar drop zones para conte√∫do de pastas
      const pastasConteudo = document.querySelectorAll('.pasta-conteudo');
      pastasConteudo.forEach(conteudo => {
        conteudo.addEventListener('dragover', handleDragOverPastaConteudo);
        conteudo.addEventListener('drop', handleDropPastaConteudo);
      });
    }
    
    function handleDragStartDoc(e) {
      if (!modoEdicao) {
        e.preventDefault();
        return;
      }
      itemArrastadoDoc = this;
      this.classList.add('dragging');
      e.dataTransfer.effectAllowed = 'move';
      e.dataTransfer.setData('text/plain', this.dataset.id || 'item');
    }
    
    function handleDragEndDoc(e) {
      this.classList.remove('dragging');
      document.querySelectorAll('.drop-indicator').forEach(ind => ind.remove());
      document.querySelectorAll('.drag-over-pasta').forEach(el => el.classList.remove('drag-over-pasta'));
    }
    
    function handleDragEnterDoc(e) {
      if (!modoEdicao || !itemArrastadoDoc) return;
      if (this === itemArrastadoDoc) return;
      
      // Se for uma pasta e o item arrastado n√£o for a pr√≥pria pasta
      if (this.classList.contains('pasta-item')) {
        const pastaHeader = this.querySelector('.pasta-header');
        if (pastaHeader) {
          pastaHeader.classList.add('drag-over-pasta');
        }
      }
    }
    
    function handleDragLeaveDoc(e) {
      if (!modoEdicao || !itemArrastadoDoc) return;
      
      // Remover highlight da pasta
      const pastaHeader = this.querySelector('.pasta-header');
      if (pastaHeader && e.relatedTarget && !this.contains(e.relatedTarget)) {
        pastaHeader.classList.remove('drag-over-pasta');
      }
    }
    
    function handleDragOverDoc(e) {
      if (!modoEdicao || !itemArrastadoDoc) return;
      e.preventDefault();
      e.dataTransfer.dropEffect = 'move';
      
      // Evitar drop sobre si mesmo
      if (this === itemArrastadoDoc) return;
      
      // Mostrar indicador de onde vai soltar
      const afterElement = getDragAfterElement(this.parentElement, e.clientY);
      const indicator = document.querySelector('.drop-indicator') || createDropIndicator();
      
      if (afterElement == null) {
        this.parentElement.appendChild(indicator);
      } else {
        this.parentElement.insertBefore(indicator, afterElement);
      }
    }
    
    function handleDragOverPastaConteudo(e) {
      if (!modoEdicao || !itemArrastadoDoc) return;
      e.preventDefault();
      e.stopPropagation();
      e.dataTransfer.dropEffect = 'move';
      
      // Mostrar indicador dentro do conte√∫do da pasta
      const afterElement = getDragAfterElement(this, e.clientY);
      const indicator = document.querySelector('.drop-indicator') || createDropIndicator();
      
      if (afterElement == null) {
        this.appendChild(indicator);
      } else {
        this.insertBefore(indicator, afterElement);
      }
    }
    
    function handleDropDoc(e) {
      if (!modoEdicao || !itemArrastadoDoc) return;
      e.preventDefault();
      e.stopPropagation();
      
      // Remover highlights
      document.querySelectorAll('.drag-over-pasta').forEach(el => el.classList.remove('drag-over-pasta'));
      
      // Reordenar elementos
      const afterElement = getDragAfterElement(this.parentElement, e.clientY);
      if (afterElement == null) {
        this.parentElement.appendChild(itemArrastadoDoc);
      } else {
        this.parentElement.insertBefore(itemArrastadoDoc, afterElement);
      }
      
      // Atualizar ordem no modelo de dados
      atualizarOrdemDocumentos();
      
      document.querySelectorAll('.drop-indicator').forEach(ind => ind.remove());
    }
    
    function handleDropPastaConteudo(e) {
      if (!modoEdicao || !itemArrastadoDoc) return;
      e.preventDefault();
      e.stopPropagation();
      
      // Verificar se est√° tentando soltar uma pasta dentro dela mesma
      const pastaAtual = this.closest('.pasta-item');
      if (pastaAtual === itemArrastadoDoc) {
        document.querySelectorAll('.drop-indicator').forEach(ind => ind.remove());
        return;
      }
      
      // Reordenar elementos dentro do conte√∫do da pasta
      const afterElement = getDragAfterElement(this, e.clientY);
      if (afterElement == null) {
        this.appendChild(itemArrastadoDoc);
      } else {
        this.insertBefore(itemArrastadoDoc, afterElement);
      }
      
      // Atualizar ordem no modelo de dados
      atualizarOrdemDocumentos();
      
      document.querySelectorAll('.drop-indicator').forEach(ind => ind.remove());
    }
    
    function getDragAfterElement(container, y) {
      const draggableElements = [...container.querySelectorAll('.pasta-item:not(.dragging), .documento-item:not(.dragging)')];
      
      return draggableElements.reduce((closest, child) => {
        const box = child.getBoundingClientRect();
        const offset = y - box.top - box.height / 2;
        
        if (offset < 0 && offset > closest.offset) {
          return { offset: offset, element: child };
        } else {
          return closest;
        }
      }, { offset: Number.NEGATIVE_INFINITY }).element;
    }
    
    function createDropIndicator() {
      const indicator = document.createElement('div');
      indicator.className = 'drop-indicator';
      return indicator;
    }
    
    function atualizarOrdemDocumentos() {
      // Atualizar a ordem dos documentos na raiz
      const lista = document.getElementById('documentosLista');
      const itensRaiz = lista.querySelectorAll(':scope > .pasta-item, :scope > .documento-item');
      
      itensRaiz.forEach((item, index) => {
        const id = item.dataset.id;
        const itemData = encontrarItemPorId(documentosData.estrutura, id);
        if (itemData) {
          itemData.ordem = index;
        }
      });
      
      // Atualizar a ordem dentro de cada pasta
      const pastas = lista.querySelectorAll('.pasta-conteudo');
      pastas.forEach(pastaConteudo => {
        const pastaItem = pastaConteudo.closest('.pasta-item');
        const pastaId = pastaItem?.dataset.id;
        const pastaData = pastaId ? encontrarItemPorId(documentosData.estrutura, pastaId) : null;
        
        if (pastaData && pastaData.filhos) {
          const itens = pastaConteudo.querySelectorAll(':scope > .pasta-item, :scope > .documento-item');
          itens.forEach((item, index) => {
            const id = item.dataset.id;
            const itemData = pastaData.filhos.find(f => f.id === id);
            if (itemData) {
              itemData.ordem = index;
            }
          });
        }
      });
    }

  
  </script>

<!-- Script para dados embarcados de documentos (ser√° preenchido ao salvar HTML) -->
<script type="application/json" id="dados-documentos-embarcados">
{
  "documentos": {
    "estrutura": []
  }
}
</script>

</body>
</html>